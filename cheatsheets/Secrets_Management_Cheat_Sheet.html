
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html">
      
      
        <link rel="prev" href="SQL_Injection_Prevention_Cheat_Sheet.html">
      
      
        <link rel="next" href="Secure_Cloud_Architecture_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Secrets Management - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#secrets-management-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Secrets Management
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Alphabetical
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index ASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index MASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Proactive Controls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Top 10
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Browser_Extension_Vulnerabilities_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Extension Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C-Based Toolchain Hardening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-Site Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DotNet Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Legacy_Application_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legacy Application Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodejs Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Secrets Management
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Secrets Management
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      1 Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-general-secrets-management" class="md-nav__link">
    <span class="md-ellipsis">
      2 General Secrets Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 General Secrets Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 High Availability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-centralize-and-standardize" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Centralize and Standardize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Access Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-automate-secrets-management" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Automate Secrets Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-handling-secrets-in-memory" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Handling Secrets in Memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-auditing" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 Auditing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-secret-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 Secret Lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.7 Secret Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#271-creation" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.1 Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#272-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.2 Rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#273-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.3 Revocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#274-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.4 Expiration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-transport-layer-security-tls-everywhere" class="md-nav__link">
    <span class="md-ellipsis">
      2.8 Transport Layer Security (TLS) Everywhere
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#29-downtime-break-glass-backup-and-restore" class="md-nav__link">
    <span class="md-ellipsis">
      2.9 Downtime, Break-glass, Backup and Restore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#210-policies" class="md-nav__link">
    <span class="md-ellipsis">
      2.10 Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#211-metadata-prepare-to-move-the-secret" class="md-nav__link">
    <span class="md-ellipsis">
      2.11 Metadata: prepare to move the secret
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-continuous-integration-ci-and-continuous-deployment-cd" class="md-nav__link">
    <span class="md-ellipsis">
      3 Continuous Integration (CI) and Continuous Deployment (CD)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 Continuous Integration (CI) and Continuous Deployment (CD)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-hardening-your-cicd-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Hardening your CI/CD pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-where-should-a-secret-be" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Where should a secret be?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Where should a secret be?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-as-part-of-your-cicd-tooling" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.1 As part of your CI/CD tooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-storing-it-in-a-secrets-management-system" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.2 Storing it in a secrets management system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-not-touched-by-cicd-at-all" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.3 Not touched by CI/CD at all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-authentication-and-authorization-of-cicd-tooling" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Authentication and Authorization of CI/CD tooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-logging-and-accounting" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Logging and Accounting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-rotation-vs-dynamic-creation" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Rotation vs Dynamic Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-pipeline-created-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Pipeline Created Secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-cloud-providers" class="md-nav__link">
    <span class="md-ellipsis">
      4 Cloud Providers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Cloud Providers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-services-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Services to Use
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Services to Use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-aws" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1 AWS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1.1 AWS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4111-aws-nitro-enclaves" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1.1 AWS Nitro Enclaves
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4112-aws-cloudhsm" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1.2 AWS CloudHSM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-gcp" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2 GCP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1.2 GCP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4121-google-cloud-confidential-computing" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2.1 Google Cloud Confidential Computing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-azure" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.3 Azure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1.3 Azure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4131-azure-confidential-computing" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.3.1 Azure Confidential Computing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4132-azure-dedicated-hsm" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.3.2 Azure Dedicated HSM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-other-clouds-multi-cloud-and-cloud-agnostic" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.4 Other clouds, Multi-cloud, and Cloud agnostic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-envelope-client-side-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Envelope &amp; client-side encryption
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Envelope & client-side encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-client-side-encryption-versus-server-side-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1 Client-side encryption versus server-side encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-bring-your-own-key-versus-cloud-provider-key" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2 Bring Your Own Key versus Cloud Provider Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-identity-and-access-management-iam" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Identity and Access Management (IAM)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-api-limits" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 API limits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-containers-orchestrators" class="md-nav__link">
    <span class="md-ellipsis">
      5 Containers &amp; Orchestrators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5 Containers & Orchestrators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-injection-of-secrets-file-in-memory" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Injection of Secrets (file, in-memory)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-short-lived-side-car-containers" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Short Lived Side-car Containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-internal-vs-external-access" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Internal vs External Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-implementation-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      6 Implementation Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 Implementation Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-key-material-management-policies" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 Key Material Management Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-dynamic-vs-static-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Dynamic vs Static Use Cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-ensure-limitations-are-in-place" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 Ensure limitations are in place
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-security-event-monitoring-is-key" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 Security Event Monitoring is Key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-usability" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 Usability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      7 Encryption
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7 Encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-encryption-types-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 Encryption Types to Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-convergent-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Convergent Encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-where-to-store-the-encryption-keys" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 Where to store the Encryption Keys?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-encryption-as-a-service-eaas" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 Encryption as a Service (EaaS)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-detection" class="md-nav__link">
    <span class="md-ellipsis">
      8 Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8 Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-general-detection-approaches" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 General detection approaches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-types-of-secrets-to-be-detected" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 Types of secrets to be detected
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-detection-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 Detection lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-documentation-for-how-to-detect-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      8.4 Documentation for how to detect secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-incident-response" class="md-nav__link">
    <span class="md-ellipsis">
      9 Incident Response
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9 Incident Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 Remediation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-logging" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 Logging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-secrets-management-in-a-multi-cloud-environment" class="md-nav__link">
    <span class="md-ellipsis">
      10 Secrets Management in a Multi-Cloud Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10 Secrets Management in a Multi-Cloud Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 Challenges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-references" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-related-cheat-sheets-further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      11 Related Cheat Sheets &amp; further reading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      1 Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-general-secrets-management" class="md-nav__link">
    <span class="md-ellipsis">
      2 General Secrets Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 General Secrets Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 High Availability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-centralize-and-standardize" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Centralize and Standardize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Access Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-automate-secrets-management" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Automate Secrets Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-handling-secrets-in-memory" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Handling Secrets in Memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-auditing" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 Auditing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-secret-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 Secret Lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.7 Secret Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#271-creation" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.1 Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#272-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.2 Rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#273-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.3 Revocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#274-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      2.7.4 Expiration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-transport-layer-security-tls-everywhere" class="md-nav__link">
    <span class="md-ellipsis">
      2.8 Transport Layer Security (TLS) Everywhere
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#29-downtime-break-glass-backup-and-restore" class="md-nav__link">
    <span class="md-ellipsis">
      2.9 Downtime, Break-glass, Backup and Restore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#210-policies" class="md-nav__link">
    <span class="md-ellipsis">
      2.10 Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#211-metadata-prepare-to-move-the-secret" class="md-nav__link">
    <span class="md-ellipsis">
      2.11 Metadata: prepare to move the secret
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-continuous-integration-ci-and-continuous-deployment-cd" class="md-nav__link">
    <span class="md-ellipsis">
      3 Continuous Integration (CI) and Continuous Deployment (CD)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 Continuous Integration (CI) and Continuous Deployment (CD)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-hardening-your-cicd-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Hardening your CI/CD pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-where-should-a-secret-be" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Where should a secret be?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Where should a secret be?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-as-part-of-your-cicd-tooling" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.1 As part of your CI/CD tooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-storing-it-in-a-secrets-management-system" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.2 Storing it in a secrets management system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-not-touched-by-cicd-at-all" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.3 Not touched by CI/CD at all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-authentication-and-authorization-of-cicd-tooling" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Authentication and Authorization of CI/CD tooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-logging-and-accounting" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Logging and Accounting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-rotation-vs-dynamic-creation" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Rotation vs Dynamic Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-pipeline-created-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Pipeline Created Secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-cloud-providers" class="md-nav__link">
    <span class="md-ellipsis">
      4 Cloud Providers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Cloud Providers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-services-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Services to Use
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Services to Use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-aws" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1 AWS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1.1 AWS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4111-aws-nitro-enclaves" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1.1 AWS Nitro Enclaves
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4112-aws-cloudhsm" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1.2 AWS CloudHSM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-gcp" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2 GCP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1.2 GCP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4121-google-cloud-confidential-computing" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2.1 Google Cloud Confidential Computing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-azure" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.3 Azure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1.3 Azure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4131-azure-confidential-computing" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.3.1 Azure Confidential Computing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4132-azure-dedicated-hsm" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.3.2 Azure Dedicated HSM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-other-clouds-multi-cloud-and-cloud-agnostic" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.4 Other clouds, Multi-cloud, and Cloud agnostic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-envelope-client-side-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Envelope &amp; client-side encryption
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Envelope & client-side encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-client-side-encryption-versus-server-side-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1 Client-side encryption versus server-side encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-bring-your-own-key-versus-cloud-provider-key" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2 Bring Your Own Key versus Cloud Provider Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-identity-and-access-management-iam" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Identity and Access Management (IAM)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-api-limits" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 API limits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-containers-orchestrators" class="md-nav__link">
    <span class="md-ellipsis">
      5 Containers &amp; Orchestrators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5 Containers & Orchestrators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-injection-of-secrets-file-in-memory" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Injection of Secrets (file, in-memory)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-short-lived-side-car-containers" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Short Lived Side-car Containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-internal-vs-external-access" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Internal vs External Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-implementation-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      6 Implementation Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 Implementation Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-key-material-management-policies" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 Key Material Management Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-dynamic-vs-static-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Dynamic vs Static Use Cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-ensure-limitations-are-in-place" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 Ensure limitations are in place
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-security-event-monitoring-is-key" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 Security Event Monitoring is Key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-usability" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 Usability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      7 Encryption
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7 Encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-encryption-types-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 Encryption Types to Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-convergent-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Convergent Encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-where-to-store-the-encryption-keys" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 Where to store the Encryption Keys?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-encryption-as-a-service-eaas" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 Encryption as a Service (EaaS)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-detection" class="md-nav__link">
    <span class="md-ellipsis">
      8 Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8 Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-general-detection-approaches" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 General detection approaches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-types-of-secrets-to-be-detected" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 Types of secrets to be detected
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-detection-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 Detection lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-documentation-for-how-to-detect-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      8.4 Documentation for how to detect secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-incident-response" class="md-nav__link">
    <span class="md-ellipsis">
      9 Incident Response
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9 Incident Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 Remediation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-logging" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 Logging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-secrets-management-in-a-multi-cloud-environment" class="md-nav__link">
    <span class="md-ellipsis">
      10 Secrets Management in a Multi-Cloud Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10 Secrets Management in a Multi-Cloud Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 Challenges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-references" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-related-cheat-sheets-further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      11 Related Cheat Sheets &amp; further reading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="secrets-management-cheat-sheet">Secrets Management Cheat Sheet<a class="headerlink" href="#secrets-management-cheat-sheet" title="Permanent link">&para;</a></h1>
<h2 id="1-introduction">1 Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<p>Secrets are being used everywhere nowadays, especially with the popularity of the DevOps movement. Application Programming Interface (API) keys, database credentials, Identity and Access Management (IAM) permissions, Secure Shell (SSH) keys, certificates, etc. Many organizations have them hardcoded within the source code in plaintext, littered throughout configuration files and configuration management tools.</p>
<p>There is a growing need for organizations to centralize the storage, provisioning, auditing, rotation and management of secrets to control access to secrets and prevent them from leaking and compromising the organization. Often, services share the same secrets, which makes identifying the source of compromise or leak challenging.</p>
<p>This cheat sheet offers best practices and guidelines to help properly implement secrets management.</p>
<h2 id="2-general-secrets-management">2 General Secrets Management<a class="headerlink" href="#2-general-secrets-management" title="Permanent link">&para;</a></h2>
<p>The following sections address the main concepts relating to secrets management.</p>
<h3 id="21-high-availability">2.1 High Availability<a class="headerlink" href="#21-high-availability" title="Permanent link">&para;</a></h3>
<p>It is vital to select a technology that is robust enough to service traffic reliably:</p>
<ul>
<li>Users (e.g. SSH keys, root account passwords). In an incident response scenario, users expect to be provisioned with credentials rapidly, so they can recover services that have gone offline. Having to wait for credentials could impact the responsiveness of the operations team.</li>
<li>Applications (e.g. database credentials and API keys). If the service is not performant, it could degrade the availability of dependent applications or increase application startup times.</li>
</ul>
<p>Such a service could receive a considerable volume of requests within a large organization.</p>
<h3 id="22-centralize-and-standardize">2.2 Centralize and Standardize<a class="headerlink" href="#22-centralize-and-standardize" title="Permanent link">&para;</a></h3>
<p>Secrets used by your DevOps teams for your applications might be consumed differently than secrets stored by your marketeers or your SRE team. You often find poorly maintained secrets where the needs of secret consumers or producers mismatch. Therefore, you must standardize and centralize the secrets management solution with care. Standardizing and centralizing can mean that you use multiple secret management solutions. For instance: your cloud-native development teams choose to use the solution provided by the cloud provider, while your private cloud uses a third-party solution, and everybody has an account for a selected password manager.
By making sure that the teams standardize the interaction with these different solutions, they remain maintainable and usable in the event of an incident.
Even when a company centralizes its secrets management to just one solution, you will often have to secure the primary secret of that secrets management solution in a secondary secrets management solution. For instance, you can use a cloud provider's facilities to store secrets, but that cloud provider's root/management credentials need to be stored somewhere else.</p>
<p>Standardization should include Secrets life cycle management, Authentication, Authorization, and Accounting of the secrets management solution, and life cycle management. Note that it should be immediately apparent to an organization what a secret is used for and where to find it. The more Secrets management solutions you use, the more documentation you need.</p>
<h3 id="23-access-control">2.3 Access Control<a class="headerlink" href="#23-access-control" title="Permanent link">&para;</a></h3>
<p>When users can read the secret in a secret management system and/or update it, it means that the secret can now leak through that user and the system he used to touch the secret.
Therefore, engineers should not have access to all secrets in the secrets management system, and the Least Privilege principle should be applied. The secret management system needs to provide the ability to configure fine granular access controls on each object and component to accomplish the Least Privilege principle.</p>
<h3 id="24-automate-secrets-management">2.4 Automate Secrets Management<a class="headerlink" href="#24-automate-secrets-management" title="Permanent link">&para;</a></h3>
<p>Manual maintenance does not only increase the risk of leakage; it introduces the risk of human errors while maintaining the secret. Furthermore, it can become wasteful.
Therefore, it is better to limit or remove the human interaction with the actual secrets. You can restrict human interaction in multiple ways:</p>
<ul>
<li><strong>Secrets pipeline:</strong> Having a secrets pipeline which does large parts of the secret management (E.g. creation, rotation, etc.)</li>
<li><strong>Using dynamic secrets:</strong> When an application starts it could request it's database credentials, which when dynamically generated will be provided with new credentials for that session. Dynamic secrets should be used where possible to reduce the surface area of credential re-use. Should the application's database credentials be stolen, upon reboot they would be expired.</li>
<li><strong>Automated rotation of static secrets:</strong> Key rotation is a challenging process when implemented manually, and can lead to mistakes. It is therefore better to automate the rotation of keys or at least ensure that the process is sufficiently supported by IT.</li>
</ul>
<p>Rotating certain keys, such as encryption keys, might trigger full or partial data re-encryption. Different strategies for rotating keys exist:</p>
<ul>
<li>Gradual rotation</li>
<li>Introducing new keys for Write operations</li>
<li>Leaving old keys for Read operations</li>
<li>Rapid rotation</li>
<li>Scheduled rotation</li>
<li>and more...</li>
</ul>
<h3 id="25-handling-secrets-in-memory">2.5 Handling Secrets in Memory<a class="headerlink" href="#25-handling-secrets-in-memory" title="Permanent link">&para;</a></h3>
<p>An additional level of security can be achieved by minimizing the time window
where a secret is in memory and limiting the access to its memory space.</p>
<p>Depending on your application's particular circumstances, this can be difficult
to implement in a manner that ensures memory security. Because of this potential
implementation complexity, you are first encouraged to develop a threat model in order to clearly
surface your implicit assumptions about both your application's deployment environment as well
as understanding the capabilities of your adversaries.</p>
<p>Often attempting to protect secrets in memory will be considered overkill
because as you evaluate a threat model, the potential threat
actors that you consider either do not have the capabilities to carry out such attacks
or the cost of defense far exceeds the likely impact of a compromise arising from
exposing secrets in memory. Also, it should be kept in mind while developing an
appropriate threat model, that if an attacker already has access to the memory of
the process handling the secret, by that time a security breach may have already
occurred. Furthermore, it should be recognized that with the advent of attacks like
<a href="https://arxiv.org/pdf/2211.07613.pdf">Rowhammer</a>, or
<a href="https://meltdownattack.com/">Meltdown and Spectre</a>, it is important
to understand that the operating system alone is not sufficient to protect your process
memory from these types of attacks. This becomes especially important when your
application is deployed to the cloud. The only foolproof approach to protecting memory
against these and similar attacks to fully physically isolate your process memory from all other
untrusted processes.</p>
<p>Despite the implementation difficulties, in highly sensitive
environments, protecting secrets in memory can
be a valuable additional layer of security. For example, in scenarios where an
advanced attacker can cause a system to crash and gain access to a memory dump,
they may be able to extract secrets from it. Therefore, carefully safeguarding
secrets in memory is recommended for untrusted environments or situations where
tight security is of utmost importance.</p>
<p>Furthermore, in lower level languages like C/C++, it is relatively easy to protect
secrets in memory. Thus, it may be worthwhile to implement this practice even if
the risk of an attacker gaining access to the memory is low. On the other hand, for
programming languages that rely on garbage collection, securing secrets in memory
generally is much more difficult.</p>
<ul>
<li>
<p><strong>Structures and Classes:</strong> In .NET and Java, do not use immutable structures
    such as Strings to store secrets, since it is impossible to force them to
    be garbage collected. Instead use primitive types such as byte arrays or
    char arrays, where the memory can be directly overwritten. You can also
    use Java's
    <a href="https://docs.oracle.com/html/E28160_01/org/identityconnectors/common/security/GuardedString.html">GuardedString</a>
    or .NET's
    <a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.securestring#string-versus-securestring">SecureString</a>
    which are designed to solve precisely this problem.</p>
</li>
<li>
<p><strong>Zeroing Memory:</strong> After a secret has been used, the memory it occupied
  should be zeroed out to prevent it from lingering in memory where it could
  potentially be accessed.</p>
<ul>
<li>If using Java's GuardedString, call the <code>dispose()</code> method.</li>
<li>If using .NET's SecureString, call the <code>Dispose()</code> method.</li>
</ul>
</li>
<li>
<p><strong>Memory Encryption:</strong> In some cases, it may be possible to use hardware or
  operating system features to encrypt the entire memory space of the process
  handling the secret. This can provide an additional layer of security. For
  example, GuardedString in Java encrypts the values in memory, and SecureString
  in .NET does so on Windows.</p>
</li>
</ul>
<p>Remember, the goal is to minimize the time window where the secret is in
plaintext in memory as much as possible.</p>
<p>For more detailed information, see
<a href="https://mas.owasp.org/MASTG/tests/android/MASVS-STORAGE/MASTG-TEST-0011">Testing Memory for Sensitive Data</a>
from the OWASP MAS project.</p>
<h3 id="26-auditing">2.6 Auditing<a class="headerlink" href="#26-auditing" title="Permanent link">&para;</a></h3>
<p>Auditing is an essential part of secrets management due to the nature of the application. You must implement auditing securely to be resilient against attempts to tamper with or delete the audit logs. At a minimum, you should audit the following:</p>
<ul>
<li>Who requested a secret and for what system and role.</li>
<li>Whether the secret request was approved or rejected.</li>
<li>When the secret was used and by whom/what.</li>
<li>When the secret has expired.</li>
<li>Whether there were any attempts to re-use expired secrets.</li>
<li>If there have been any authentication or authorization errors.</li>
<li>When the secret was updated and by whom/what.</li>
<li>Any administrative actions and possible user activity on the underlying supporting infrastructure stack.</li>
</ul>
<p>It is essential that all auditing has correct timestamps. Therefore, the secret management solution should have proper time sync protocols set up at its supporting infrastructure. You should monitor the stack on which the solution runs for possible clock-skew and manual time adjustments.</p>
<h3 id="27-secret-lifecycle">2.7 Secret Lifecycle<a class="headerlink" href="#27-secret-lifecycle" title="Permanent link">&para;</a></h3>
<p>Secrets follow a lifecycle. The stages of the lifecycle are as follows:</p>
<ul>
<li>Creation</li>
<li>Rotation</li>
<li>Revocation</li>
<li>Expiration</li>
</ul>
<h4 id="271-creation">2.7.1 Creation<a class="headerlink" href="#271-creation" title="Permanent link">&para;</a></h4>
<p>New secrets must be securely generated and cryptographically robust enough for their purpose. Secrets must have the minimum privileges assigned to them to enable their required use/role.</p>
<p>You should transmit credentials securely, such that ideally, you don't send the password along with the username when requesting user accounts. Instead, you should send the password via a secure channel (e.g. mutually authenticated connection) or a side-channel such as push notification, SMS, email. Refer to the <a href="https://cheatsheetseries.owasp.org/cheatsheets/Multifactor_Authentication_Cheat_Sheet">Multi-Factor Authentication Cheat Sheet</a> to learn about the pros and cons of each channel.</p>
<p>Applications may not benefit from having multiple communication channels, so you must provision credentials securely.</p>
<p>See <a href="https://www.opencre.org/cre/223-780">the Open CRE project on secrets lookup</a> for more technical recommendations on secret creation.</p>
<h4 id="272-rotation">2.7.2 Rotation<a class="headerlink" href="#272-rotation" title="Permanent link">&para;</a></h4>
<p>You should regularly rotate secrets so that any stolen credentials will only work for a short time. Regular rotation will also reduce the tendency for users to fall back to bad habits such as re-using credentials.</p>
<p>Depending on a secret's function and what it protects, the lifetime could be from minutes (think end-to-end encrypted chats with perfect forward secrecy) to years (consider hardware secrets).</p>
<p>User credentials are excluded from regular rotating. These should only be rotated if there is suspicion or evidence that they have been compromised, according to <a href="https://pages.nist.gov/800-63-FAQ/#q-b05">NIST recommendations</a>.</p>
<h4 id="273-revocation">2.7.3 Revocation<a class="headerlink" href="#273-revocation" title="Permanent link">&para;</a></h4>
<p>When secrets are no longer required or potentially compromised, you must securely revoke them to restrict access. With (TLS) certificates, this also involves certificate revocation.</p>
<h4 id="274-expiration">2.7.4 Expiration<a class="headerlink" href="#274-expiration" title="Permanent link">&para;</a></h4>
<p>You should create secrets to expire after a defined time where possible. This expiration can either be active expiration by the secret consuming system, or an expiration date set at the secrets management system forcing supporting processes to be triggered, resulting in a secret rotation.
You should apply policies through the secrets management solution to ensure credentials are only made available for a limited time appropriate for the type of credentials. Applications should verify that the secret is still active before trusting it.</p>
<h3 id="28-transport-layer-security-tls-everywhere">2.8 Transport Layer Security (TLS) Everywhere<a class="headerlink" href="#28-transport-layer-security-tls-everywhere" title="Permanent link">&para;</a></h3>
<p>Never transmit secrets via plaintext. In this day and age, there is no excuse given the ubiquitous adoption of TLS.</p>
<p>Furthermore, you can effectively use secrets management solutions to provision TLS certificates.</p>
<h3 id="29-downtime-break-glass-backup-and-restore">2.9 Downtime, Break-glass, Backup and Restore<a class="headerlink" href="#29-downtime-break-glass-backup-and-restore" title="Permanent link">&para;</a></h3>
<p>Consider the possibility that a secrets management service becomes unavailable for various reasons, such as scheduled downtime for maintenance. It could be impossible to retrieve the credentials required to restore the service if you did not previously acquire them. Thus, choose maintenance windows carefully based on earlier metrics and audit logs.</p>
<p>Next, the backup and restore procedures of the system should be regularly tested and audited for their security. A few requirements regarding backup &amp; restore. Ensure that:</p>
<ul>
<li>An automated backup procedure is in place and executed periodically; base the frequency of the backups and snapshots on the number of secrets and their lifecycle.</li>
<li>Frequently test restore procedures to guarantee that the backups are intact.</li>
<li>Encrypt backups and put them on secure storage with reduced access rights. Monitor the backup location for (unauthorized) access and administrative actions.</li>
</ul>
<p>Lastly, you should implement emergency ("break-glass") processes to restore the service if the system becomes unavailable for reasons other than regular maintenance. Therefore, emergency break-glass credentials should be regularly backed up securely in a secondary secrets management system and tested routinely to verify they work.</p>
<h3 id="210-policies">2.10 Policies<a class="headerlink" href="#210-policies" title="Permanent link">&para;</a></h3>
<p>Consistently enforce policies defining the minimum complexity requirements of passwords and approved encryption algorithms at an organization-wide level. Using a centralized secrets management solution can help companies implement these policies.</p>
<p>Next, having an organization-wide secrets management policy can help enforce applying the best practices defined in this cheat sheet.</p>
<h3 id="211-metadata-prepare-to-move-the-secret">2.11 Metadata: prepare to move the secret<a class="headerlink" href="#211-metadata-prepare-to-move-the-secret" title="Permanent link">&para;</a></h3>
<p>A secret management solution should provide the capability to store at least the following metadata about a secret:</p>
<ul>
<li>When it was created/consumed/archived/rotated/deleted</li>
<li>Who created/consumed/archived/rotated/deleted it (e.g. both the actual producer, and the engineer using the production method)</li>
<li>What created/consumed/archived/rotated/deleted it</li>
<li>Who to contact when having trouble with the secret or having questions about it</li>
<li>For what the secret is used (E.g. designated intended consumers and purpose of the secret)</li>
<li>What type of secret it is (E.g. AES Key, HMAC key, RSA private key)</li>
<li>When you need to rotate it, if done manually</li>
</ul>
<p>Note: if you don't store metadata about the secret nor prepare to move, you will increase the probability of vendor lock-in.</p>
<h2 id="3-continuous-integration-ci-and-continuous-deployment-cd">3 Continuous Integration (CI) and Continuous Deployment (CD)<a class="headerlink" href="#3-continuous-integration-ci-and-continuous-deployment-cd" title="Permanent link">&para;</a></h2>
<p>Building, testing and deploying changes generally requires access to many systems. Continuous Integration (CI) and Continuous Deployment (CD) tools typically store secrets to provide configuration to the application or during deployment. Alternatively, they interact heavily with the secrets management system. Various best practices can help smooth out secret management in CI/CD; we will deal with some of them in this section.</p>
<h3 id="31-hardening-your-cicd-pipeline">3.1 Hardening your CI/CD pipeline<a class="headerlink" href="#31-hardening-your-cicd-pipeline" title="Permanent link">&para;</a></h3>
<p>CI/CD tooling consumes (high-privilege) credentials regularly. Ensure that the pipeline cannot be easily hacked or misused by employees. Here are a few guidelines which can help you:</p>
<ul>
<li>Treat your CI/CD tooling as a production environment: harden it, patch it and harden the underlying infrastructure and services.</li>
<li>Have Security Event Monitoring in place.</li>
<li>Implement least-privilege access: developers do not need to be able to administer projects. Instead, they only need to be able to execute required functions, such as setting up pipelines, running them, and working with code. Administrative tasks can quickly be done using configuration-as-code in a separate repository used by the CI/CD system to update its configuration. There is no need for privileged roles that might have access to secrets.</li>
<li>Make sure that pipeline output does not leak secrets, and you can't listen in on production pipelines with debugging tools.</li>
<li>Make sure you cannot exec into any runners and workers for a CI/CD system.</li>
<li>Have proper authentication, authorization and accounting in place.</li>
<li>Ensure only an approved process can create pipelines, including MR/PR steps to ensure that a created pipeline is security-reviewed.</li>
</ul>
<h3 id="32-where-should-a-secret-be">3.2 Where should a secret be?<a class="headerlink" href="#32-where-should-a-secret-be" title="Permanent link">&para;</a></h3>
<p>There are various places where you can store a secret to execute CI/CD actions:</p>
<ul>
<li>As part of your CI/CD tooling: you can store a secret in <a href="https://docs.gitlab.com/charts/installation/secrets.html">GitLab</a>/<a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">GitHub</a>/<a href="https://www.jenkins.io/doc/developer/security/secrets/">jenkins</a>. This is not the same as committing it to code.</li>
<li>As part of your secrets-management system: you can store a secret in a secrets management system, such as facilities provided by a cloud provider (<a href="https://aws.amazon.com/secrets-manager/">AWS Secret Manager</a>, <a href="https://azure.microsoft.com/nl-nl/services/key-vault/">Azure Key Vault</a>, <a href="https://cloud.google.com/secret-manager">Google Secret Manager</a>), or other third-party facilities (<a href="https://www.vaultproject.io/">Hashicorp Vault</a>, <a href="https://www.conjur.org/">Conjur</a>, <a href="https://www.keepersecurity.com/">Keeper</a>). In this case, the CI/CD pipeline tooling requires credentials to connect to these secret management systems to have secrets in place. See <a href="#4-cloud-providers">Cloud Providers</a> for more details on using a cloud provider's secret management system.</li>
</ul>
<p>Another alternative here is using the CI/CD pipeline to leverage the Encryption as a Service from the secrets management systems to do the encryption of a secret. The CI/CD tooling can then commit the encrypted secret to git, which can be fetched by the consuming service on deployment and decrypted again. See section 3.6 for more details.</p>
<p>Note: not all secrets must be at the CI/CD pipeline to get to the actual deployment. Instead, make sure that the deployed services take care of part of their secrets management at their own lifecycle (E.g. deployment, runtime and destruction).</p>
<h4 id="321-as-part-of-your-cicd-tooling">3.2.1 As part of your CI/CD tooling<a class="headerlink" href="#321-as-part-of-your-cicd-tooling" title="Permanent link">&para;</a></h4>
<p>When secrets are part of your CI/CD tooling, it means that these secrets are exposed to your CI/CD jobs. CI/CD tooling can comprise, e.g. GitHub secrets, GitLab repository secrets, ENV Vars/Var Groups in Microsoft Azure DevOps, Kubernetes Secrets, etc.
These secrets are often configurable/viewable by people who have the authorization to do so (e.g. a maintainer in GitHub, a project owner in GitLab, an admin in Jenkins, etc.), which together lines up for the following best practices:</p>
<ul>
<li>No "big secret": ensure that secrets in your CI/CD tooling that are not long-term, don't have a wide blast radius, and don't have a high value. Also, limit shared secrets (e.g. never have one password for all administrative users).</li>
<li>As is / To be: have a clear overview of which users can view or alter the secrets. Often, maintainers of a GitLab/GitHub project can see or otherwise extract its secrets.</li>
<li>Reduce the number of people that can perform administrative tasks on the project to limit exposure.</li>
<li>Log &amp; Alert: Assemble all the logs from the CI/CD tooling and have rules in place to detect secret extraction, or misuse, whether through accessing them through a web interface or dumping them while double base64 encoding or encrypting them with OpenSSL.</li>
<li>Rotation: Regularly rotate secrets.</li>
<li>Forking should not leak: Validate that a fork of the repository or copy of the job definition does not copy the secret.</li>
<li>Document: Make sure you document which secrets you store as part of your CI/CD tooling and why so that you can migrate these easily when required.</li>
</ul>
<h4 id="322-storing-it-in-a-secrets-management-system">3.2.2 Storing it in a secrets management system<a class="headerlink" href="#322-storing-it-in-a-secrets-management-system" title="Permanent link">&para;</a></h4>
<p>Naturally, you can store secrets in a designated secrets management solution. For example, you can use a solution offered by your (cloud) infrastructure provider, such as <a href="https://aws.amazon.com/secrets-manager/">AWS Secrets Manager</a>, <a href="https://cloud.google.com/secret-manager">Google Secrets Manager</a>, or <a href="https://azure.microsoft.com/nl-nl/services/key-vault/">Azure KeyVault</a>. You can find more information about these in <a href="#4-cloud-providers">section 4</a> of this cheat sheet. Another option is a dedicated secrets management system, such as <a href="https://www.vaultproject.io/">Hashicorp Vault</a>, <a href="https://www.keepersecurity.com/">Keeper</a>, <a href="https://www.conjur.org/">Conjur</a>.
Here are a few do's and don'ts for the CI/CD interaction with these systems. Make sure that the following is taken care of:</p>
<ul>
<li>Rotation/Temporality: credentials used by the CI/CD tooling to authenticate against the secret management system are rotated frequently and expire after a job completes.</li>
<li>Scope of authorization: scope credentials used by the CI/CD tooling (e.g. roles, users, etc.), only authorize those secrets and services of the secret management system required for the CI/CD tooling to execute its job.</li>
<li>Attribution of the caller: credentials used by the CI/CD tooling still hold attribution of the one calling the secrets management solution. Ensure you can attribute any calls made by the CI/CD tooling to a person or service that requested the actions of the CI/CD tooling. If this is not possible through the default configuration of the secrets manager, make sure that you have a correlation setup in terms of request parameters.</li>
<li>All of the above: Still follow those do's and don'ts listed in section 3.2.1: log &amp; alert, take care of forking, etc.</li>
<li>Backup: back up secrets to product-critical operations in separate storage (e.g. cold storage), especially encryption keys.</li>
</ul>
<h4 id="323-not-touched-by-cicd-at-all">3.2.3 Not touched by CI/CD at all<a class="headerlink" href="#323-not-touched-by-cicd-at-all" title="Permanent link">&para;</a></h4>
<p>Secrets do not necessarily need to be brought to a consumer of the secret by a CI/CD pipeline. It is even better when the consumer of the secret retrieves the secret. In that case, the CI/CD pipeline still needs to instruct the orchestrating system (e.g. <a href="https://kubernetes.io/">Kubernetes</a>) that it needs to schedule a specific service with a given service account with which the consumer can then retrieve the required secret. The CI/CD tooling then still has credentials for the orchestrating platform but no longer has access to the secrets themselves. The do's and don'ts regarding these credentials types are similar to those described in section 3.2.2.</p>
<h3 id="33-authentication-and-authorization-of-cicd-tooling">3.3 Authentication and Authorization of CI/CD tooling<a class="headerlink" href="#33-authentication-and-authorization-of-cicd-tooling" title="Permanent link">&para;</a></h3>
<p>CI/CD tooling should have designated service accounts, which can only operate in the scope of the required secrets or orchestration of the consumers of a secret. Additionally, a CI/CD pipeline run should be easily attributable to the one who has defined the job or triggered it to detect who has tried to exfiltrate secrets or manipulate them. When you use certificate-based auth, the caller of the pipeline identity should be part of the certificate. If you use a token to authenticate towards the mentioned systems, make sure you set the principal requesting these actions (e.g. the user or the job creator).</p>
<p>Verify on a periodical basis whether this is (still) the case for your system so that you can do logging, attribution, and security alerting on suspicious actions effectively.</p>
<h3 id="34-logging-and-accounting">3.4 Logging and Accounting<a class="headerlink" href="#34-logging-and-accounting" title="Permanent link">&para;</a></h3>
<p>Attackers can use CI/CD tooling to extract secrets. They could, for example, use administrative interfaces or job creation which exfiltrates the secret using encryption or double base64 encoding. Therefore, you should log every action in a CI/CD tool. You should define security alerting rules at every non-standard manipulation of the pipeline tool and its administrative interface to monitor secret usage.
Logs should be queryable for at least 90 days and stored for a more extended period in cold storage. It might take security teams time to understand how attackers can exfiltrate or manipulate a secret using CI/CD tooling.</p>
<h3 id="35-rotation-vs-dynamic-creation">3.5 Rotation vs Dynamic Creation<a class="headerlink" href="#35-rotation-vs-dynamic-creation" title="Permanent link">&para;</a></h3>
<p>You can leverage CI/CD tooling to rotate secrets or instruct other components to do the rotation of the secret. For instance, the CI/CD tool can request a secrets management system or another application to rotate the secret. Alternatively, the CI/CD tool or another component could set up a dynamic secret: a secret required for a consumer to use for as long as it lives. The secret is invalidated when the consumer no longer lives. This procedure reduces possible leakage of a secret and allows for easy detection of misuse. If an attacker uses secret from anywhere other than the consumer's IP, you can easily detect it.</p>
<h3 id="36-pipeline-created-secrets">3.6 Pipeline Created Secrets<a class="headerlink" href="#36-pipeline-created-secrets" title="Permanent link">&para;</a></h3>
<p>You can use pipeline tooling to generate secrets and either offer them directly to the service deployed by the tooling or provide the secret to a secrets management solution. Alternatively, the secret can be stored encrypted in git so that the secret and its metadata is as close to the developer's daily place of work as possible. A git-stored secret does require that developers cannot decrypt the secrets themselves and that every consumer of a secret has its encrypted variant of the secret. For instance: the secret should then be different per DTAP environment and be encrypted with another key. For each environment, only the designated consumer in that environment should be able to decrypt the specific secret. A secret does not leak cross-environment and can still be easily stored next to the code.
Consumers of a secret could now decrypt the secret using a sidecar, as described in section 5.2. Instead of retrieving the secrets, the consumer would leverage the sidecar to decrypt the secret.</p>
<p>When a pipeline creates a secret by itself, ensure that the scripts or binaries involved adhere to best practices for secret generation. Best practices include secure-randomness, proper length of secret creation, etc. and that the secret is created based on well-defined metadata stored somewhere in git or somewhere else.</p>
<h2 id="4-cloud-providers">4 Cloud Providers<a class="headerlink" href="#4-cloud-providers" title="Permanent link">&para;</a></h2>
<p>For cloud providers, there are at least four essential topics to touch upon:</p>
<ul>
<li>Designated secret storage/management solutions. Which service(s) do you use?</li>
<li>Envelope &amp; client-side encryption</li>
<li>Identity and access management: decreasing the blast radius</li>
<li>API quotas or service limits</li>
</ul>
<h3 id="41-services-to-use">4.1 Services to Use<a class="headerlink" href="#41-services-to-use" title="Permanent link">&para;</a></h3>
<p>It is best to use a designated secret management solution in any environment. Most cloud providers have at least one service that offers secret management. Of course, it's also possible to run a different secret management solution (e.g. HashiCorp Vault or Conjur) on compute resources within the cloud. We'll consider cloud provider service offerings in this section.</p>
<p>Sometimes it's possible to automatically rotate your secret, either via a service provided by your cloud provider or a (custom-built) function. Generally, you should prefer the cloud provider's solution since the barrier of entry and risk of misconfiguration are lower. If you use a custom solution, ensure the function's role to do its rotation can only be assumed by said function.</p>
<h4 id="411-aws">4.1.1 AWS<a class="headerlink" href="#411-aws" title="Permanent link">&para;</a></h4>
<p>For AWS, the recommended solution is <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html">AWS secret manager</a>.</p>
<p>Permissions are granted at the secret level. Check out the <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/best-practices.html">Secrets Manager best practices</a>.</p>
<p>It is also possible to use the <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">Systems Manager Parameter store</a>, which is cheaper, but that has a few downsides:</p>
<ul>
<li>you'll need to make sure you've specified encryption yourself (secrets manager does that by default)</li>
<li>it offers fewer auto-rotation capabilities (you will likely need to build a custom function)</li>
<li>it doesn't support cross-account access</li>
<li>it doesn't support cross-region replication</li>
<li>there are fewer <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html">security hub controls</a> available</li>
</ul>
<h5 id="4111-aws-nitro-enclaves">4.1.1.1 AWS Nitro Enclaves<a class="headerlink" href="#4111-aws-nitro-enclaves" title="Permanent link">&para;</a></h5>
<p>With <a href="https://aws.amazon.com/ec2/nitro/nitro-enclaves/">AWS Nitro Enclaves</a>, you can create trusted execution environments. Thus, no human-based access is possible once the application is running. Additionally, enclaves do not have any permanent storage attached to them. Therefore, secrets and other sensitive data stored on the nitro enclaves have an additional layer of security.</p>
<h5 id="4112-aws-cloudhsm">4.1.1.2 AWS CloudHSM<a class="headerlink" href="#4112-aws-cloudhsm" title="Permanent link">&para;</a></h5>
<p>For secrets being used in highly confidential applications, it may be needed to have more control over the encryption and storage of these keys. AWS offers <a href="https://aws.amazon.com/cloudhsm/">CloudHSM</a>, which lets you bring your own key (BYOK) for AWS services. Thus, you will have more control over keys' creation, lifecycle, and durability. CloudHSM allows automatic scaling and backup of your data. The cloud service provider, Amazon, will not have any access to the key material stored in Azure Dedicated HSM.</p>
<h4 id="412-gcp">4.1.2 GCP<a class="headerlink" href="#412-gcp" title="Permanent link">&para;</a></h4>
<p>For GCP, the recommended service is <a href="https://cloud.google.com/secret-manager/docs">Secret Manager</a>.</p>
<p>Permissions are granted at the secret level.</p>
<p>Check out the <a href="https://cloud.google.com/secret-manager/docs/best-practices">Secret Manager best practices</a>.</p>
<h5 id="4121-google-cloud-confidential-computing">4.1.2.1 Google Cloud Confidential Computing<a class="headerlink" href="#4121-google-cloud-confidential-computing" title="Permanent link">&para;</a></h5>
<p><a href="https://cloud.google.com/confidential-computing">GCP Confidential Computing</a> allows encryption of data during runtime. Thus, application code and data are kept secret, encrypted, and cannot be accessed by humans or tools.</p>
<h4 id="413-azure">4.1.3 Azure<a class="headerlink" href="#413-azure" title="Permanent link">&para;</a></h4>
<p>For Azure, the recommended service is <a href="https://docs.microsoft.com/en-us/azure/key-vault/">Key Vault</a>.</p>
<p>Contrary to other clouds, permissions are granted at the <em><strong>Key Vault</strong></em> level. This means secrets for separate workloads and separate sensitivity levels should be in separated Key Vaults accordingly.</p>
<p>Check out the <a href="https://docs.microsoft.com/en-us/azure/key-vault/general/best-practices">Key Vault best practices</a>.</p>
<h5 id="4131-azure-confidential-computing">4.1.3.1 Azure Confidential Computing<a class="headerlink" href="#4131-azure-confidential-computing" title="Permanent link">&para;</a></h5>
<p>With <a href="https://azure.microsoft.com/en-us/solutions/confidential-compute/#overview">Azure Confidential Computing</a>, you can create trusted execution environments. Thus, every application will be executed in an encrypted enclave that protects the data and code consumed by the application is protected end-to-end. Furthermore, any application running inside enclaves is not accessible by any tool or human.</p>
<h5 id="4132-azure-dedicated-hsm">4.1.3.2 Azure Dedicated HSM<a class="headerlink" href="#4132-azure-dedicated-hsm" title="Permanent link">&para;</a></h5>
<p>For secrets being used in Azure environments and requiring special security considerations, Azure offers <a href="https://azure.microsoft.com/en-us/services/azure-dedicated-hsm/">Azure Dedicated HSM</a>. This allows you more control over the secrets stored on it, including enhanced administrative and cryptographic control. The cloud service provider, Microsoft, will not have any access to the key material stored in Azure Dedicated HSM.</p>
<h4 id="414-other-clouds-multi-cloud-and-cloud-agnostic">4.1.4 Other clouds, Multi-cloud, and Cloud agnostic<a class="headerlink" href="#414-other-clouds-multi-cloud-and-cloud-agnostic" title="Permanent link">&para;</a></h4>
<p>If you're using multiple cloud providers, you should consider using a cloud agnostic secret management solution. This will allow you to use the same secret management solution across all your cloud providers (and possibly also on-premises). Another advantage is that this avoids vendor lock-in with a specific cloud provider, as the solution can be used on any cloud provider.</p>
<p>There are open source and commercial solutions available. Some examples are:</p>
<ul>
<li><a href="https://www.conjur.org/">CyberArk Conjur</a></li>
<li><a href="https://www.vaultproject.io/">HashiCorp Vault</a></li>
<li><a href="https://www.pulumi.com/esc/">Pulumi ESC</a></li>
</ul>
<h3 id="42-envelope-client-side-encryption">4.2 Envelope &amp; client-side encryption<a class="headerlink" href="#42-envelope-client-side-encryption" title="Permanent link">&para;</a></h3>
<p>This section will describe how a secret is encrypted and how you can manage the keys for that encryption in the cloud.</p>
<h4 id="421-client-side-encryption-versus-server-side-encryption">4.2.1 Client-side encryption versus server-side encryption<a class="headerlink" href="#421-client-side-encryption-versus-server-side-encryption" title="Permanent link">&para;</a></h4>
<p>Server-side encryption of secrets ensures that the cloud provider takes care of the encryption of the secret in storage. The secret is then safeguarded against compromise while at rest. Encryption at rest often does not require additional work other than selecting the key to encrypt it with (See section 4.2.2). However: when you submit the secret to another service, it will no longer be encrypted. It is decrypted before sharing with the intended service or human user.</p>
<p>Client-side encryption of secrets ensures that the secret remains encrypted until you actively decrypt it. This means it is only decrypted when it arrives at the consumer. You need to have a proper crypto system to cater for this. Think about mechanisms such as PGP using a safe configuration and other more scalable and relatively easy to use systems. Client-side encryption can provide an end-to-end encryption of the secret: from producer till consumer.</p>
<h4 id="422-bring-your-own-key-versus-cloud-provider-key">4.2.2 Bring Your Own Key versus Cloud Provider Key<a class="headerlink" href="#422-bring-your-own-key-versus-cloud-provider-key" title="Permanent link">&para;</a></h4>
<p>When you encrypt a secret at rest, the question is: which key do you want to use? The less trust you have in the cloud provider, the more you will want to manage yourself.</p>
<p>Often, you can either encrypt a secret with a key managed at the secrets management service or use a key management solution from the cloud provider to encrypt the secret. The key offered through the key management solution of the cloud provider can be either managed by the cloud provider or by yourself. Industry standards call the latter "bring your own key" (BYOK). You can either directly import or generate this key at the key management solution or using cloud HSM supported by the cloud provider.
You can then either use your key or the customer main key from the provider to encrypt the data key of the secrets management solution. The data key, in turn, encrypts the secret. By managing the CMK, you have control over the data key at the secrets management solution.</p>
<p>While importing your own key material can generally be done with all providers (<a href="https://docs.aws.amazon.com/kms/latest/developerguide/importing-keys.html">AWS</a>, <a href="https://docs.microsoft.com/en-us/azure/key-vault/keys/byok-specification">Azure</a>, <a href="https://cloud.google.com/kms/docs/key-import">GCP</a>), unless you know what you are doing and your threat model and policy require this, this is not a recommended solution due to its complexity and difficulty of use.</p>
<h3 id="43-identity-and-access-management-iam">4.3 Identity and Access Management (IAM)<a class="headerlink" href="#43-identity-and-access-management-iam" title="Permanent link">&para;</a></h3>
<p>IAM applies to both on-premise and cloud setups: to effectively manage secrets, you need to set up suitable access policies and roles. Setting this up goes beyond policies regarding secrets; it should include hardening the full IAM setup, as it could otherwise allow for privilege escalation attacks. Ensure you never allow open "pass role" privileges or unrestricted IAM creation privileges, as these can use or create credentials that have access to the secrets. Next, make sure you tightly control what can impersonate a service account: are your machines' roles accessible by an attacker exploiting your server? Can service roles from the data-pipeline tooling access the secrets easily? Ensure you include IAM for every cloud component in your threat model (e.g. ask yourself: how can you do elevation of privileges with this component?). See <a href="https://xebia.com/ten-pitfalls-you-should-look-out-for-in-aws-iam/">this blog entry</a> for multiple do's and don'ts with examples.</p>
<p>Leverage the temporality of the IAM principals effectively: e.g. ensure that only specific roles and service accounts that require it can access the secrets. Monitor these accounts so that you can tell who or what used them to access the secrets.</p>
<p>Next, make sure that you scope access to your secrets: one should not be simply allowed to access all secrets. In GCP and AWS, you can create fine-grained access policies to ensure that a principal cannot access all secrets at once. In Azure, having access to the key vault means having access to all secrets in that key vault. It is, thus, essential to have separate key vaults when working on Azure to segregate access.</p>
<h3 id="44-api-limits">4.4 API limits<a class="headerlink" href="#44-api-limits" title="Permanent link">&para;</a></h3>
<p>Cloud services can generally provide a limited amount of API calls over a given period. You could potentially (D)DoS yourself when you run into these limits. Most of these limits apply per account, project, or subscription, so spread workloads to limit your blast radius accordingly. Additionally, some services may support data key caching, preventing load on the key management service API (see for example <a href="https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/data-key-caching.html">AWS data key caching</a>). Some services can leverage built-in data key caching. <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-key.html">S3 is one such example</a>.</p>
<h2 id="5-containers-orchestrators">5 Containers &amp; Orchestrators<a class="headerlink" href="#5-containers-orchestrators" title="Permanent link">&para;</a></h2>
<p>You can enrich containers with secrets in multiple ways: build time (not recommended) and during orchestration/deployment.</p>
<h3 id="51-injection-of-secrets-file-in-memory">5.1 Injection of Secrets (file, in-memory)<a class="headerlink" href="#51-injection-of-secrets-file-in-memory" title="Permanent link">&para;</a></h3>
<p>There are three ways to get secrets to an app inside a docker container.</p>
<ul>
<li>Mounted volumes (file): With this method, we keep our secrets within a particular config/secret file and mount that file to our instance as a mounted volume. Ensure that these mounts are mounted in by the orchestrator and never built-in, as this will leak the secret with the container definition. Instead, make sure that the orchestrator mounts in the volume when required.</li>
<li>Fetch from the secret store (in-memory): A sidecar app/container fetches the secrets it needs directly from a secret manager service without dealing with docker config. This solution allows you to use dynamically constructed secrets without worrying about the secrets being viewable from the file system or from checking the docker container's environment variables.</li>
<li>Environment variables: We can provide secrets directly as part of the docker container configuration. Note: secrets themselves should never be hardcoded using docker ENV or docker ARG commands, as these can easily leak with the container definitions. See the Docker challenges at <a href="https://github.com/OWASP/wrongsecrets">WrongSecrets</a> as well. Instead, let an orchestrator overwrite the environment variable with the actual secret and ensure that this is not hardcoded. Additionally, environment variables are generally accessible to all processes and may be included in logs or system dumps. Using environment variables is therefore not recommended unless the other methods are not possible.</li>
</ul>
<h3 id="52-short-lived-side-car-containers">5.2 Short Lived Side-car Containers<a class="headerlink" href="#52-short-lived-side-car-containers" title="Permanent link">&para;</a></h3>
<p>To inject secrets, you could create short-lived sidecar containers that fetch secrets from some remote endpoint and then store them on a shared volume mounted to the original container. The original container can now use the secrets from mounted volume. The benefit of using this approach is that we don't need to integrate any third-party tool or code to get secrets. Once the sidecar has fetched the secrets, it terminates. Examples of this include <a href="https://developer.hashicorp.com/vault/docs/platform/k8s/injector">Vault Agent Sidecar Injector</a> and <a href="https://github.com/cyberark/secrets-provider-for-k8s">Conjur Secrets Provider</a>. By mounting secrets to a volume shared with the pod, containers within the pod can consume secrets without being aware of the secrets manager.</p>
<h3 id="53-internal-vs-external-access">5.3 Internal vs External Access<a class="headerlink" href="#53-internal-vs-external-access" title="Permanent link">&para;</a></h3>
<p>You should only expose secrets to communication mechanisms between the container and the deployment representation (e.g. a Kubernetes Pod). Never expose secrets through external access mechanisms shared among deployments or orchestrators (e.g. a shared volume).</p>
<p>When the orchestrator stores secrets (e.g. Kubernetes Secrets), make sure that the storage backend of the orchestrator is encrypted and you manage the keys well. See the <a href="Kubernetes_Security_Cheat_Sheet.html">Kubernetes Security Cheat Sheet</a> for more information.</p>
<h2 id="6-implementation-guidance">6 Implementation Guidance<a class="headerlink" href="#6-implementation-guidance" title="Permanent link">&para;</a></h2>
<p>In this section, we will discuss implementation. Note that it is always best to refer to the official documentation of the secrets management system of choice for the actual implementation as it will be more up to date than any secondary document such as this cheat sheet.</p>
<h3 id="61-key-material-management-policies">6.1 Key Material Management Policies<a class="headerlink" href="#61-key-material-management-policies" title="Permanent link">&para;</a></h3>
<p>Key material management is discussed in the <a href="Key_Management_Cheat_Sheet.html">Key Management Cheat Sheet</a></p>
<h3 id="62-dynamic-vs-static-use-cases">6.2 Dynamic vs Static Use Cases<a class="headerlink" href="#62-dynamic-vs-static-use-cases" title="Permanent link">&para;</a></h3>
<p>We see the following use cases for dynamic secrets, amongst others:</p>
<ul>
<li>short-lived secrets (e.g. credentials or API keys) for a secondary service that expresses the intent for connecting the primary service (e.g. consumer) to the service.</li>
<li>short-lived integrity and encryption controls for guarding and securing in-memory and runtime communication processes. Think of encryption keys that only need to live for a single session or a single deployment lifetime.</li>
<li>short-lived credentials for building a stack during the deployment of a service for interacting with the deployers and supporting infrastructure.</li>
</ul>
<p>Note that these dynamic secrets often need to be created with the service we need to connect to. To create these types of dynamic secrets, we usually require long term static secrets to create the dynamic secrets themselves. Other static use cases:</p>
<ul>
<li>key material that needs to live longer than a single deployment due to the nature of their usage in the interaction with other instances of the same service (e.g. storage encryption keys, TLS PKI keys)</li>
<li>key material or credentials to connect to services that do not support creating temporal roles or credentials.</li>
</ul>
<h3 id="63-ensure-limitations-are-in-place">6.3 Ensure limitations are in place<a class="headerlink" href="#63-ensure-limitations-are-in-place" title="Permanent link">&para;</a></h3>
<p>Secrets should never be retrievable by everyone and everything. Always make sure that you put guardrails in place:</p>
<ul>
<li>Do you have the opportunity to create access policies? Ensure that there are policies in place to limit the number of entities that can read or write the secret. At the same time, write the policies so that you can easily extend them, and they are not too complicated to understand.</li>
<li>Is there no way to reduce access to certain secrets within a secrets management solution? Consider separating the production and development secrets by having separate secret management solutions. Then, reduce access to the production secrets management solution.</li>
</ul>
<h3 id="64-security-event-monitoring-is-key">6.4 Security Event Monitoring is Key<a class="headerlink" href="#64-security-event-monitoring-is-key" title="Permanent link">&para;</a></h3>
<p>Continually monitor who/what, from which IP, and what methodology accesses the secret. There are various patterns where you need to look out for, such as, but not limited to:</p>
<ul>
<li>Monitor who accesses the secret at the secret management system: is this normal behavior? If the CI/CD credentials are used to access the secret management solution from a different IP than where the CI/CD system is running, provide a security alert and assume the secret compromised.</li>
<li>Monitor the service requiring the secret (if possible), e.g., whether the user of the secret is coming from an expected IP, with an expected user agent. If not, alert and assume the secret is compromised.</li>
</ul>
<h3 id="65-usability">6.5 Usability<a class="headerlink" href="#65-usability" title="Permanent link">&para;</a></h3>
<p>Ensure that your secrets management solution is easy to use, as you do not want people to work around it or use it ineffectively due to complexity. This usability requires:</p>
<ul>
<li>Easy onboarding of new secrets and removal of invalidated secrets.</li>
<li>Easy integration with the existing software: it should be easy to integrate applications as consumers of the secret management system. For instance, an SDK or simple sidecar container should be available to communicate with the secret management system so that existing software is decoupled and does not need extensive modification. You can find examples of this in the AWS, Google, and Azure SDKs. These SDKs allow an application to interact with the respective secrets management solutions. You can find similar examples in the HashiCorp Vault software integrations and the <a href="https://developer.hashicorp.com/vault/docs/platform/k8s/injector">Vault Agent Sidecar Injector</a>, as well as Conjur integrations and <a href="https://github.com/cyberark/secrets-provider-for-k8s">Conjur Secrets Provider</a>.</li>
<li>A clear understanding of the organization of secrets management and its processes is essential.</li>
</ul>
<h2 id="7-encryption">7 Encryption<a class="headerlink" href="#7-encryption" title="Permanent link">&para;</a></h2>
<p>Secrets Management goes hand in hand with encryption. After all, secrets must be stored encrypted somewhere to protect their confidentiality and integrity.</p>
<h3 id="71-encryption-types-to-use">7.1 Encryption Types to Use<a class="headerlink" href="#71-encryption-types-to-use" title="Permanent link">&para;</a></h3>
<p>You can use various encryption types to secure a secret as long as they provide sufficient security, including adequate resistance against quantum computing-based attacks. Given that this is a moving field, it is best to take a look at sources like <a href="https://www.keylength.com/en/4/">keylength.com</a>, which enumerate up to date recommendations on the usage of encryption types and key lengths for existing standards, as well as the NSA's <a href="https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF">Commercial National Security Algorithm Suite 2.0</a> which enumerates quantum resistant algorithms.</p>
<p>Please note that in all cases, we need to preferably select an algorithm that provides encryption and confidentiality at the same time, such as AES-256 using GCM <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode">(Gallois Counter Mode)</a>, or a mixture of ChaCha20 and Poly1305 according to the best practices in the field.</p>
<h3 id="72-convergent-encryption">7.2 Convergent Encryption<a class="headerlink" href="#72-convergent-encryption" title="Permanent link">&para;</a></h3>
<p><a href="https://en.wikipedia.org/wiki/Convergent_encryption">Convergent Encryption</a> ensures that a given plaintext and its key results in the same ciphertext. This can help detect possible re-use of secrets, resulting in the same ciphertext.
The challenge with enabling convergent encryption is that it allows attackers to use the system to generate a set of cryptographic strings that might end up in the same secret, allowing the attacker to derive the plain text secret. Given the algorithm and key, you can mitigate this risk if the convergent crypto system you use has sufficient resource challenges during encryption. Another factor that can help reduce the risk is ensuring that a secret is of adequate length, further hampering the possible guess-iteration time required.</p>
<h3 id="73-where-to-store-the-encryption-keys">7.3 Where to store the Encryption Keys?<a class="headerlink" href="#73-where-to-store-the-encryption-keys" title="Permanent link">&para;</a></h3>
<p>You should not store keys next to the secrets they encrypt, except if those keys are encrypted themselves (see envelope encryption). Start by consulting the <a href="Key_Management_Cheat_Sheet.html">Key Management Cheat Sheet</a> on where and how to store the encryption and possible HMAC keys.</p>
<h3 id="74-encryption-as-a-service-eaas">7.4 Encryption as a Service (EaaS)<a class="headerlink" href="#74-encryption-as-a-service-eaas" title="Permanent link">&para;</a></h3>
<p>EaaS is a model in which users subscribe to a cloud-based encryption service without having to install encryption on their own systems. Using EaaS, you can get the following benefits:</p>
<ul>
<li>Encryption at rest</li>
<li>Encryption in transit (TLS)</li>
<li>Key handling and cryptographic implementations are taken care of by Encryption Service, not by developers</li>
<li>The provider could add more services to interact with the sensitive data</li>
</ul>
<h2 id="8-detection">8 Detection<a class="headerlink" href="#8-detection" title="Permanent link">&para;</a></h2>
<p>There are many approaches to secrets detection and some very useful open source projects to help with this. The <a href="https://github.com/Yelp/detect-secrets">Yelp Detect Secrets</a> project is mature and has signature matching for around 20 secrets. For more information on other tools to help you in the detection space, check out the <a href="https://github.com/topics/secrets-detection">Secrets Detection</a> topic on GitHub.</p>
<h3 id="81-general-detection-approaches">8.1 General detection approaches<a class="headerlink" href="#81-general-detection-approaches" title="Permanent link">&para;</a></h3>
<p>Shift-left and DevSecOps principles apply to secrets detection as well. These general approaches below aim to consider secrets earlier and evolve the practice over time.</p>
<ul>
<li>Create standard test secrets and use them universally across the organization. This allows for reducing false positives by only needing to track a single test secret for each secret type.</li>
<li>Consider enabling secrets detection at the developer level to avoid checking secrets into code before commit/PR either in the IDE, as part of test-driven development, or via pre-commit hook.</li>
<li>Make secrets detection part of the threat model. Consider secrets as part of the attack surface during threat modeling exercises.</li>
<li>Evaluate detection utilities and related signatures often to ensure they meet expectations.</li>
<li>Consider having more than one detection utility and correlating/de-duping results to identify potential areas of detection weakness.</li>
<li>Explore a balance between entropy and ease of detection. Secrets with consistent formats are easier to detect with lower false-positive rates, but you also don't want to miss a human-created password simply because it doesn't match your detection rules.</li>
</ul>
<h3 id="82-types-of-secrets-to-be-detected">8.2 Types of secrets to be detected<a class="headerlink" href="#82-types-of-secrets-to-be-detected" title="Permanent link">&para;</a></h3>
<p>Many types of secrets exist, and you should consider signatures for each to ensure accurate detection for all. Among the more common types are:</p>
<ul>
<li>High availability secrets (Tokens that are difficult to rotate)</li>
<li>Application configuration files</li>
<li>Connection strings</li>
<li>API keys</li>
<li>Credentials</li>
<li>Passwords</li>
<li>2FA keys</li>
<li>Private keys (e.g., SSH keys)</li>
<li>Session tokens</li>
<li>Platform-specific secret types (e.g., Amazon Web Services, Google Cloud)</li>
</ul>
<p>For more fun learning about secrets and practice rooting them out check out the <a href="https://owasp.org/www-project-wrongsecrets/">Wrong Secrets</a> project.</p>
<h3 id="83-detection-lifecycle">8.3 Detection lifecycle<a class="headerlink" href="#83-detection-lifecycle" title="Permanent link">&para;</a></h3>
<p>Secrets are like any other authorization token. They should:</p>
<ul>
<li>Exist only for as long as necessary (rotate often)</li>
<li>Have a method for automatic rotation</li>
<li>Only be visible to those who need them (least privilege)</li>
<li>Be revokable (including the logging of attempt to use a revoked secret)</li>
<li>Never be logged (must implement either an encryption or masking approach in place to avoid logging plaintext secrets)</li>
</ul>
<p>Create detection rules for each of the stages of the secret lifecycle.</p>
<h3 id="84-documentation-for-how-to-detect-secrets">8.4 Documentation for how to detect secrets<a class="headerlink" href="#84-documentation-for-how-to-detect-secrets" title="Permanent link">&para;</a></h3>
<p>Create documentation and update it regularly to inform the developer community on procedures and systems available at your organization and what types of secrets management you expect, how to test for secrets, and what to do in event of detected secrets.</p>
<p>Documentation should:</p>
<ul>
<li>Exist and be updated often, especially in response to an incident</li>
<li>
<p>Include the following information:</p>
<ul>
<li>Who has access to the secret</li>
<li>How it gets rotated</li>
<li>Any upstream or downstream dependencies that could potentially be broken during secret rotation</li>
<li>Who is the point of contact during an incident</li>
<li>Security impact of exposure</li>
</ul>
</li>
<li>
<p>Identify when secrets may be handled differently depending on the threat risk, data classification, etc.</p>
</li>
</ul>
<h2 id="9-incident-response">9 Incident Response<a class="headerlink" href="#9-incident-response" title="Permanent link">&para;</a></h2>
<p>Quick response in the event of a secret exposure is perhaps one of the most critical considerations for secrets management.</p>
<h3 id="91-documentation">9.1 Documentation<a class="headerlink" href="#91-documentation" title="Permanent link">&para;</a></h3>
<p>Incident response in the event of secret exposure should ensure that everyone in the chain of custody is aware and understands how to respond. This includes application creators (every member of a development team), information security, and technology leadership.</p>
<p>Documentation must include:</p>
<ul>
<li>How to test for secrets and secrets handling, especially during business continuity reviews.</li>
<li>Whom to alert when a secret is detected.</li>
<li>Steps to take for containment</li>
<li>Information to log during the event</li>
</ul>
<h3 id="92-remediation">9.2 Remediation<a class="headerlink" href="#92-remediation" title="Permanent link">&para;</a></h3>
<p>The primary goal of incident response is rapid response and containment.</p>
<p>Containment should follow these procedures:</p>
<ol>
<li>Revocation: Keys that were exposed should undergo immediate revocation. The secret must be able to be de-authorized quickly, and systems must be in place to identify the revocation status.</li>
<li>Rotation: A new secret must be able to be quickly created and implemented, preferably via an automated process to ensure repeatability, low rate of implementation error, and least-privilege (not directly human-readable).</li>
<li>Deletion: Secrets revoked/rotated must be removed from the exposed system immediately, including secrets discovered in code or logs. Secrets in code could have commit history for the exposure squashed to before the introduction of the secret, however, this may introduce other problems as it rewrites git history and will break any other links to a given commit. If you decide to do this be aware of the consequences and plan accordingly. Secrets in logs must have a process for removing the secret while maintaining log integrity.</li>
<li>Logging: Incident response teams must have access to information about the lifecycle of a secret to aid in containment and remediation, including:<ul>
<li>Who had access?</li>
<li>When did they use it?</li>
<li>When was it previously rotated?</li>
</ul>
</li>
</ol>
<h3 id="93-logging">9.3 Logging<a class="headerlink" href="#93-logging" title="Permanent link">&para;</a></h3>
<p>Additional considerations for logging of secrets usage should include:</p>
<ul>
<li>Logging for incident response should be to a single location accessible by incident response (IR) teams</li>
<li>Ensure fidelity of logging information during purple team exercises such as:<ul>
<li>What should have been logged?</li>
<li>What was actually logged?</li>
<li>Do we have adequate alerts in place to ensure this?</li>
</ul>
</li>
</ul>
<p>Consider using a standardized logging format and vocabulary such as the <a href="Logging_Vocabulary_Cheat_Sheet.html">Logging Vocabulary Cheat Sheet</a> to ensure that all necessary information is logged.</p>
<h2 id="10-secrets-management-in-a-multi-cloud-environment">10 Secrets Management in a Multi-Cloud Environment<a class="headerlink" href="#10-secrets-management-in-a-multi-cloud-environment" title="Permanent link">&para;</a></h2>
<h3 id="101-introduction">10.1 Introduction<a class="headerlink" href="#101-introduction" title="Permanent link">&para;</a></h3>
<p>Managing secrets in a multi-cloud environment presents unique challenges due to the diversity of cloud providers and their respective services. This section discusses the challenges and best practices for managing secrets across multiple cloud providers.</p>
<h3 id="102-challenges">10.2 Challenges<a class="headerlink" href="#102-challenges" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Diverse APIs and Interfaces</strong>: Each cloud provider has its own API and interface for managing secrets, which can lead to complexity in integrating and managing secrets across multiple providers.</li>
<li><strong>Inconsistent Security Policies</strong>: Different cloud providers may have varying security policies and practices, making it challenging to enforce consistent security standards across all environments.</li>
<li><strong>Key Rotation</strong>: Ensuring that keys are rotated consistently and securely across multiple cloud providers can be difficult, especially if each provider has different mechanisms for key rotation.</li>
<li><strong>Access Control</strong>: Managing access control for secrets across multiple cloud providers can be complex, as each provider may have different access control mechanisms and policies.</li>
<li><strong>Auditing and Monitoring</strong>: Ensuring comprehensive auditing and monitoring of secret access and usage across multiple cloud providers can be challenging due to the differences in logging and monitoring capabilities.</li>
</ol>
<h3 id="103-best-practices">10.3 Best Practices<a class="headerlink" href="#103-best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Use a Centralized Secrets Management Solution</strong>: Implement a centralized secrets management solution that can integrate with multiple cloud providers. This can help standardize the management of secrets and enforce consistent security policies across all environments. Examples include HashiCorp Vault and CyberArk Conjur.</li>
<li><strong>Standardize Security Policies</strong>: Define and enforce standardized security policies for managing secrets across all cloud providers. This includes policies for key rotation, access control, and auditing.</li>
<li><strong>Automate Key Rotation</strong>: Implement automated key rotation processes to ensure that keys are rotated consistently and securely across all cloud providers. Use tools and scripts to automate the rotation process and reduce the risk of human error.</li>
<li><strong>Implement Fine-Grained Access Control</strong>: Use fine-grained access control mechanisms to restrict access to secrets based on the principle of least privilege. Ensure that access control policies are consistently enforced across all cloud providers.</li>
<li><strong>Enable Comprehensive Auditing and Monitoring</strong>: Implement comprehensive auditing and monitoring of secret access and usage across all cloud providers. Use centralized logging and monitoring solutions to aggregate and analyze logs from multiple providers.</li>
</ol>
<h3 id="104-references">10.4 References<a class="headerlink" href="#104-references" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.vaultproject.io/">HashiCorp Vault</a></li>
<li><a href="https://www.conjur.org/">CyberArk Conjur</a></li>
<li><a href="https://aws.amazon.com/secrets-manager/">AWS Secrets Manager</a></li>
<li><a href="https://azure.microsoft.com/en-us/services/key-vault/">Azure Key Vault</a></li>
<li><a href="https://cloud.google.com/secret-manager">Google Cloud Secret Manager</a></li>
</ul>
<h2 id="11-related-cheat-sheets-further-reading">11 Related Cheat Sheets &amp; further reading<a class="headerlink" href="#11-related-cheat-sheets-further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="Key_Management_Cheat_Sheet.html">Key Management Cheat Sheet</a></li>
<li><a href="Logging_Cheat_Sheet.html">Logging Cheat Sheet</a></li>
<li><a href="Password_Storage_Cheat_Sheet.html">Password Storage Cheat Sheet</a></li>
<li><a href="Cryptographic_Storage_Cheat_Sheet.html">Cryptographic Storage Cheat Sheet</a></li>
<li><a href="https://github.com/OWASP/wrongsecrets/">OWASP WrongSecrets project</a></li>
<li><a href="https://xebia.com/blog/secure-deployment-10-pointers-on-secrets-management/">Blog: 10 Pointers on Secrets Management</a></li>
<li><a href="https://xebia.com/from-build-to-run-pointers-on-secure-deployment/">Blog: From build to run: pointers on secure deployment</a></li>
<li><a href="https://github.com/topics/secrets-detection">Github listing on secrets detection tools</a></li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final">NIST SP 800-57 Recommendation for Key Management</a></li>
<li><a href="https://opencre.org/cre/223-780">OpenCRE References to secrets</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>