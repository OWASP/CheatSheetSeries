
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html">
      
      
        <link rel="prev" href="Docker_Security_Cheat_Sheet.html">
      
      
        <link rel="next" href="Error_Handling_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>DotNet Security - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dotnet-security-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DotNet Security
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Alphabetical
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index ASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index MASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Proactive Controls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Top 10
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Browser_Extension_Vulnerabilities_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Extension Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C-Based Toolchain Hardening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-Site Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    DotNet Security
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    DotNet Security
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-net-framework" class="md-nav__link">
    <span class="md-ellipsis">
      The .NET Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-the-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Updating the Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-announcements" class="md-nav__link">
    <span class="md-ellipsis">
      Security Announcements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#net-general-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      .NET General Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label=".NET General Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a01-broken-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      A01 Broken Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A01 Broken Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weak-account-management" class="md-nav__link">
    <span class="md-ellipsis">
      Weak Account management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-function-level-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Missing function-level access control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insecure-direct-object-references" class="md-nav__link">
    <span class="md-ellipsis">
      Insecure Direct object references
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a02-cryptographic-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A02 Cryptographic Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A02 Cryptographic Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-cryptography-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      General cryptography guidance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashing" class="md-nav__link">
    <span class="md-ellipsis">
      Hashing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Passwords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-for-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption for storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-for-transmission" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption for transmission
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a03-injection" class="md-nav__link">
    <span class="md-ellipsis">
      A03 Injection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A03 Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-injection" class="md-nav__link">
    <span class="md-ellipsis">
      OS Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-injection" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a04-insecure-design" class="md-nav__link">
    <span class="md-ellipsis">
      A04 Insecure Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a05-security-misconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      A05 Security Misconfiguration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A05 Security Misconfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debug-and-stack-trace" class="md-nav__link">
    <span class="md-ellipsis">
      Debug and Stack Trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-site-request-forgery" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-site request forgery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-site request forgery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-net-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Using .NET Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-net-core-20-or-later" class="md-nav__link">
    <span class="md-ellipsis">
      Using .NET Core 2.0 or later
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-net-core-or-net-framework-with-ajax" class="md-nav__link">
    <span class="md-ellipsis">
      Using .Net Core or .NET Framework with AJAX
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a06-vulnerable-and-outdated-components" class="md-nav__link">
    <span class="md-ellipsis">
      A06 Vulnerable and Outdated Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a07-identification-and-authentication-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A07 Identification and Authentication Failures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a08-software-and-data-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A08 Software and Data Integrity Failures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a09-security-logging-and-monitoring-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A09 Security Logging and Monitoring Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A09 Security Logging and Monitoring Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a10-server-side-request-forgery-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      A10 Server-Side Request Forgery (SSRF)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owasp-2013-2017" class="md-nav__link">
    <span class="md-ellipsis">
      OWASP 2013 &amp; 2017
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OWASP 2013 & 2017">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a042017-xml-external-entities-xxe" class="md-nav__link">
    <span class="md-ellipsis">
      A04:2017 XML External Entities (XXE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a072017-cross-site-scripting-xss" class="md-nav__link">
    <span class="md-ellipsis">
      A07:2017 Cross-Site Scripting (XSS)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a082017-insecure-deserialization" class="md-nav__link">
    <span class="md-ellipsis">
      A08:2017 Insecure Deserialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a102013-unvalidated-redirects-and-forwards" class="md-nav__link">
    <span class="md-ellipsis">
      A10:2013 Unvalidated redirects and forwards
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-advice" class="md-nav__link">
    <span class="md-ellipsis">
      Other advice
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Other advice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-project" class="md-nav__link">
    <span class="md-ellipsis">
      Sample project
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guidance-for-specific-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Guidance for specific topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guidance for specific topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-and-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration and Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-access" class="md-nav__link">
    <span class="md-ellipsis">
      Data Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asp-net-web-forms-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      ASP NET Web Forms Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ASP NET Web Forms Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-validation-and-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP validation and encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forms-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Forms authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xaml-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      XAML Guidance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-forms-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Forms Guidance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wcf-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      WCF Guidance
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Legacy_Application_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legacy Application Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodejs Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-net-framework" class="md-nav__link">
    <span class="md-ellipsis">
      The .NET Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-the-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Updating the Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-announcements" class="md-nav__link">
    <span class="md-ellipsis">
      Security Announcements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#net-general-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      .NET General Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label=".NET General Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a01-broken-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      A01 Broken Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A01 Broken Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weak-account-management" class="md-nav__link">
    <span class="md-ellipsis">
      Weak Account management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-function-level-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Missing function-level access control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insecure-direct-object-references" class="md-nav__link">
    <span class="md-ellipsis">
      Insecure Direct object references
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a02-cryptographic-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A02 Cryptographic Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A02 Cryptographic Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-cryptography-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      General cryptography guidance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashing" class="md-nav__link">
    <span class="md-ellipsis">
      Hashing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Passwords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-for-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption for storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-for-transmission" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption for transmission
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a03-injection" class="md-nav__link">
    <span class="md-ellipsis">
      A03 Injection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A03 Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-injection" class="md-nav__link">
    <span class="md-ellipsis">
      OS Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-injection" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a04-insecure-design" class="md-nav__link">
    <span class="md-ellipsis">
      A04 Insecure Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a05-security-misconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      A05 Security Misconfiguration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A05 Security Misconfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debug-and-stack-trace" class="md-nav__link">
    <span class="md-ellipsis">
      Debug and Stack Trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-site-request-forgery" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-site request forgery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-site request forgery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-net-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Using .NET Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-net-core-20-or-later" class="md-nav__link">
    <span class="md-ellipsis">
      Using .NET Core 2.0 or later
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-net-core-or-net-framework-with-ajax" class="md-nav__link">
    <span class="md-ellipsis">
      Using .Net Core or .NET Framework with AJAX
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a06-vulnerable-and-outdated-components" class="md-nav__link">
    <span class="md-ellipsis">
      A06 Vulnerable and Outdated Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a07-identification-and-authentication-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A07 Identification and Authentication Failures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a08-software-and-data-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A08 Software and Data Integrity Failures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a09-security-logging-and-monitoring-failures" class="md-nav__link">
    <span class="md-ellipsis">
      A09 Security Logging and Monitoring Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A09 Security Logging and Monitoring Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a10-server-side-request-forgery-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      A10 Server-Side Request Forgery (SSRF)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owasp-2013-2017" class="md-nav__link">
    <span class="md-ellipsis">
      OWASP 2013 &amp; 2017
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OWASP 2013 & 2017">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a042017-xml-external-entities-xxe" class="md-nav__link">
    <span class="md-ellipsis">
      A04:2017 XML External Entities (XXE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a072017-cross-site-scripting-xss" class="md-nav__link">
    <span class="md-ellipsis">
      A07:2017 Cross-Site Scripting (XSS)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a082017-insecure-deserialization" class="md-nav__link">
    <span class="md-ellipsis">
      A08:2017 Insecure Deserialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a102013-unvalidated-redirects-and-forwards" class="md-nav__link">
    <span class="md-ellipsis">
      A10:2013 Unvalidated redirects and forwards
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-advice" class="md-nav__link">
    <span class="md-ellipsis">
      Other advice
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Other advice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-project" class="md-nav__link">
    <span class="md-ellipsis">
      Sample project
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guidance-for-specific-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Guidance for specific topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guidance for specific topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-and-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration and Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-access" class="md-nav__link">
    <span class="md-ellipsis">
      Data Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asp-net-web-forms-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      ASP NET Web Forms Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ASP NET Web Forms Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-validation-and-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP validation and encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forms-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Forms authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xaml-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      XAML Guidance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-forms-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Forms Guidance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wcf-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      WCF Guidance
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="dotnet-security-cheat-sheet">DotNet Security Cheat Sheet<a class="headerlink" href="#dotnet-security-cheat-sheet" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>This page intends to provide quick basic .NET security tips for developers.</p>
<h3 id="the-net-framework">The .NET Framework<a class="headerlink" href="#the-net-framework" title="Permanent link">&para;</a></h3>
<p>The .NET Framework is Microsoft's principal platform for enterprise development. It is the supporting API for ASP.NET, Windows Desktop applications, Windows Communication Foundation services, SharePoint, Visual Studio Tools for Office and other technologies.</p>
<p>The .NET Framework constitutes a collection of APIs that facilitate the usage of an advanced type system, managing data, graphics, networking, file operations, and more - essentially covering the vast majority of requirements for developing enterprise applications within the Microsoft ecosystem. It is a nearly ubiquitous library that is strongly named and versioned at the assembly level.</p>
<h3 id="updating-the-framework">Updating the Framework<a class="headerlink" href="#updating-the-framework" title="Permanent link">&para;</a></h3>
<p>The .NET Framework is kept up-to-date by Microsoft with the Windows Update service. Developers do not normally need to run separate updates to the Framework. Windows Update can be accessed at <a href="http://windowsupdate.microsoft.com/">Windows Update</a> or from the Windows Update program on a Windows computer.</p>
<p>Individual frameworks can be kept up to date using <a href="https://docs.microsoft.com/en-us/nuget/">NuGet</a>. As Visual Studio prompts for updates, build it into your lifecycle.</p>
<p>Remember that third-party libraries have to be updated separately and not all of them use NuGet. ELMAH for instance, requires a separate update effort.</p>
<h3 id="security-announcements">Security Announcements<a class="headerlink" href="#security-announcements" title="Permanent link">&para;</a></h3>
<p>Receive security notifications by selecting the "Watch" button at the following repositories:</p>
<ul>
<li><a href="https://github.com/dotnet/announcements/issues?q=is%3Aopen+is%3Aissue+label%3ASecurity">.NET Core Security Announcements</a></li>
<li><a href="https://github.com/aspnet/Announcements/issues?q=is%3Aopen+is%3Aissue+label%3ASecurity">ASP.NET Core &amp; Entity Framework Core Security Announcements</a></li>
</ul>
<h2 id="net-general-guidance">.NET General Guidance<a class="headerlink" href="#net-general-guidance" title="Permanent link">&para;</a></h2>
<p>This section contains general guidance for .NET applications.
This applies to all .NET applications, including ASP.NET, WPF, WinForms, and others.</p>
<p>The OWASP Top 10 lists the most prevalent and dangerous threats to web security in the world today and is reviewed every few years
and updated with the latest threat data. This section of the cheat sheet is based on this list.
Your approach to securing your web application should be to start at the top threat A1 below and work down;
this will ensure that any time spent on security will be spent most effectively and
cover the top threats first and lesser threats afterwards. After covering the Top 10 it is generally advisable
to assess for other threats or get a professionally completed Penetration Test.</p>
<h3 id="a01-broken-access-control">A01 Broken Access Control<a class="headerlink" href="#a01-broken-access-control" title="Permanent link">&para;</a></h3>
<h4 id="weak-account-management">Weak Account management<a class="headerlink" href="#weak-account-management" title="Permanent link">&para;</a></h4>
<p>Ensure cookies are sent with the HttpOnly flag set to prevent client side scripts from accessing the cookie:</p>
<div class="highlight"><pre><span></span><code><span class="n">CookieHttpOnly</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">true</span><span class="p">,</span>
</code></pre></div>
<p>Reduce the time period a session can be stolen in by reducing session timeout and removing sliding expiration:</p>
<div class="highlight"><pre><span></span><code><span class="n">ExpireTimeSpan</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">60</span><span class="p">),</span>
<span class="n">SlidingExpiration</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">false</span>
</code></pre></div>
<p>See <a href="https://github.com/johnstaveley/SecurityEssentials/blob/master/SecurityEssentials/App_Start/Startup.Auth.cs">here</a> for an example of a full startup code snippet.</p>
<p>Ensure cookies are sent over HTTPS in production. This should be enforced in the config transforms:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;httpCookies</span><span class="w"> </span><span class="na">requireSSL=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;authentication&gt;</span>
<span class="w">    </span><span class="nt">&lt;forms</span><span class="w"> </span><span class="na">requireSSL=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/authentication&gt;</span>
</code></pre></div>
<p>Protect LogOn, Registration and password reset methods against brute force attacks by throttling requests (see code below). Consider also using ReCaptcha.</p>
<div class="highlight"><pre><span></span><code><span class="na">[HttpPost]</span>
<span class="na">[AllowAnonymous]</span>
<span class="na">[ValidateAntiForgeryToken]</span>
<span class="na">[AllowXRequestsEveryXSecondsAttribute(Name = &quot;LogOn&quot;,</span>
<span class="na">Message = &quot;You have performed this action more than {x} times in the last {n} seconds.&quot;,</span>
<span class="na">Requests = 3, Seconds = 60)]</span>
<span class="k">public</span><span class="w"></span><span class="k">async</span><span class="w"></span><span class="n">Task</span><span class="o">&lt;</span><span class="n">ActionResult</span><span class="o">&gt;</span><span class="w"></span><span class="n">LogOn</span><span class="p">(</span><span class="n">LogOnViewModel</span><span class="w"></span><span class="n">model</span><span class="p">,</span><span class="w"></span><span class="kt">string</span><span class="w"></span><span class="n">returnUrl</span><span class="p">)</span>
</code></pre></div>
<p>DO NOT: Roll your own authentication or session management. Use the one provided by .NET.</p>
<p>DO NOT: Tell someone if the account exists on LogOn, Registration or Password reset. Say something like 'Either the username or password was incorrect', or 'If this account exists then a reset token will be sent to the registered email address'. This protects against account enumeration.</p>
<p>The feedback to the user should be identical whether or not the account exists, both in terms of content and behavior. E.g., if the response takes 50% longer when the account is real then membership information can be guessed and tested.</p>
<h4 id="missing-function-level-access-control">Missing function-level access control<a class="headerlink" href="#missing-function-level-access-control" title="Permanent link">&para;</a></h4>
<p>DO: Authorize users on all externally facing endpoints. The .NET framework has many ways to authorize a user, use them at method level:</p>
<div class="highlight"><pre><span></span><code><span class="na">[Authorize(Roles=&quot;Admin&quot;)]</span>
<span class="na">[HttpGet]</span>
<span class="k">public</span><span class="w"></span><span class="n">ActionResult</span><span class="w"></span><span class="nf">Index</span><span class="p">(</span><span class="kt">int</span><span class="w"></span><span class="n">page</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
<p>or better yet, at controller level:</p>
<div class="highlight"><pre><span></span><code><span class="na">[Authorize]</span>
<span class="k">public</span><span class="w"></span><span class="k">class</span><span class="w"></span><span class="nc">UserController</span>
</code></pre></div>
<p>You can also check roles in code using identity features in .net: <code>System.Web.Security.Roles.IsUserInRole(userName, roleName)</code></p>
<p>You can find more information in the <a href="Authorization_Cheat_Sheet.html">Authorization Cheat Sheet</a> and
<a href="Authorization_Testing_Automation_Cheat_Sheet.html">Authorization Testing Automation Cheat Sheet</a>.</p>
<h4 id="insecure-direct-object-references">Insecure Direct object references<a class="headerlink" href="#insecure-direct-object-references" title="Permanent link">&para;</a></h4>
<p>When you have a resource (object) which can be accessed by a reference (in the sample below this is the <code>id</code>), you need to ensure that the user is intended to have access to that resource.</p>
<div class="highlight"><pre><span></span><code><span class="c1">//Insecure</span>
<span class="k">public</span><span class="w"></span><span class="n">ActionResult</span><span class="w"></span><span class="nf">Edit</span><span class="p">(</span><span class="kt">int</span><span class="w"></span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="w"></span><span class="kt">var</span><span class="w"></span><span class="n">user</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">_context</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">(</span><span class="n">e</span><span class="w"></span><span class="o">=&gt;</span><span class="w"></span><span class="n">e</span><span class="p">.</span><span class="n">Id</span><span class="w"></span><span class="o">==</span><span class="w"></span><span class="n">id</span><span class="p">);</span>
<span class="w"></span><span class="k">return</span><span class="w"></span><span class="n">View</span><span class="p">(</span><span class="s">&quot;Details&quot;</span><span class="p">,</span><span class="w"></span><span class="k">new</span><span class="w"></span><span class="n">UserViewModel</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//Secure</span>
<span class="k">public</span><span class="w"></span><span class="n">ActionResult</span><span class="w"></span><span class="nf">Edit</span><span class="p">(</span><span class="kt">int</span><span class="w"></span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="w"></span><span class="kt">var</span><span class="w"></span><span class="n">user</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">_context</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">(</span><span class="n">e</span><span class="w"></span><span class="o">=&gt;</span><span class="w"></span><span class="n">e</span><span class="p">.</span><span class="n">Id</span><span class="w"></span><span class="o">==</span><span class="w"></span><span class="n">id</span><span class="p">);</span>
<span class="w"></span><span class="c1">//Establishuserhasrighttoeditthedetails</span>
<span class="w"></span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">Id</span><span class="w"></span><span class="o">!=</span><span class="w"></span><span class="n">_userIdentity</span><span class="p">.</span><span class="n">GetUserId</span><span class="p">())</span>
<span class="w"></span><span class="p">{</span>
<span class="w">        </span><span class="n">HandleErrorInfo</span><span class="w"></span><span class="n">error</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">new</span><span class="w"></span><span class="n">HandleErrorInfo</span><span class="p">(</span>
<span class="w">            </span><span class="k">new</span><span class="w"></span><span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;INFO:Youdonothavepermissiontoeditthesedetails&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="k">return</span><span class="w"></span><span class="nf">View</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">,</span><span class="w"></span><span class="n">error</span><span class="p">);</span>
<span class="w"></span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"></span><span class="nf">View</span><span class="p">(</span><span class="s">&quot;Edit&quot;</span><span class="p">,</span><span class="w"></span><span class="k">new</span><span class="w"></span><span class="n">UserViewModel</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>More information can be found in the <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html">Insecure Direct Object Reference Prevention Cheat Sheet</a>.</p>
<h3 id="a02-cryptographic-failures">A02 Cryptographic Failures<a class="headerlink" href="#a02-cryptographic-failures" title="Permanent link">&para;</a></h3>
<h4 id="general-cryptography-guidance">General cryptography guidance<a class="headerlink" href="#general-cryptography-guidance" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Never, ever write your own cryptographic functions.</strong></li>
<li>Wherever possible, try and avoid writing any cryptographic code at all. Instead try and either use pre-existing secrets management solutions or the secret management solution provided by your cloud provider. For more information, see the <a href="Secrets_Management_Cheat_Sheet.html">OWASP Secrets Management Cheat Sheet</a>.</li>
<li>If you cannot use a pre-existing secrets management solution, try and use a trusted and well known implementation library rather than using the libraries built into .NET as it is far too easy to make cryptographic errors with them.</li>
<li>Make sure your application or protocol can easily support a future change of cryptographic algorithms.</li>
</ul>
<h4 id="hashing">Hashing<a class="headerlink" href="#hashing" title="Permanent link">&para;</a></h4>
<p>DO: Use a strong hashing algorithm.</p>
<ul>
<li>In .NET (both Framework and Core), the strongest hashing algorithm for general hashing requirements is
  <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.sha512">System.Security.Cryptography.SHA512</a>.</li>
<li>In .NET Framework 4.6 and earlier, the strongest algorithm for password hashing is PBKDF2, implemented as
  <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rfc2898derivebytes">System.Security.Cryptography.Rfc2898DeriveBytes</a>.</li>
<li>In .NET Framework 4.6.1 and later and .NET Core, the strongest algorithm for password hashing is PBKDF2, implemented as
  <a href="https://docs.microsoft.com/en-us/aspnet/core/security/data-protection/consumer-apis/password-hashing">Microsoft.AspNetCore.Cryptography.KeyDerivation.Pbkdf2</a>
  which has several significant advantages over <code>Rfc2898DeriveBytes</code>.</li>
<li>When using a hashing function to hash non-unique inputs such as passwords, use a salt value added to the original value before hashing.</li>
<li>Refer to the <a href="Password_Storage_Cheat_Sheet.html">Password Storage Cheat Sheet</a> for more information.</li>
</ul>
<h4 id="passwords">Passwords<a class="headerlink" href="#passwords" title="Permanent link">&para;</a></h4>
<p>DO: Enforce passwords with a minimum complexity that will survive a dictionary attack; i.e. longer passwords that use the full character set (numbers, symbols and letters) to increase entropy.</p>
<h4 id="encryption">Encryption<a class="headerlink" href="#encryption" title="Permanent link">&para;</a></h4>
<p>DO: Use a strong encryption algorithm such as AES-512 where personally identifiable data needs to be restored to it's original format.</p>
<p>DO: Protect encryption keys more than any other asset. Find more information about storing encryption keys at rest in the
  <a href="Key_Management_Cheat_Sheet.html#storage">Key Management Cheat Sheet</a>.</p>
<p>DO: Use TLS 1.2+ for your entire site. Get a free certificate <a href="https://letsencrypt.org/">LetsEncrypt.org</a> and automate renewals.</p>
<p>DO NOT: <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices">Allow SSL, this is now obsolete</a>.</p>
<p>DO: Have a strong TLS policy (see <a href="https://www.ssllabs.com/projects/best-practices/index.html">SSL Best Practices</a>), use TLS 1.2+ wherever possible. Then check the configuration using <a href="https://www.ssllabs.com/ssltest/">SSL Test</a> or <a href="https://testssl.sh/">TestSSL</a>.</p>
<p>More information on Transport Layer Protection can be found in the
<a href="Transport_Layer_Security_Cheat_Sheet.html">Transport Layer Security Cheat Sheet</a>.</p>
<p>DO: Ensure headers are not disclosing information about your application. See <a href="https://github.com/johnstaveley/SecurityEssentials/blob/master/SecurityEssentials/Core/HttpHeaders.cs">HttpHeaders.cs</a>, <a href="https://github.com/Dionach/StripHeaders/">Dionach StripHeaders</a>, disable via <code>web.config</code> or <a href="https://medium.com/bugbountywriteup/security-headers-1c770105940b">Startup.cs</a>.</p>
<p>e.g Web.config</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;system.web&gt;</span>
<span class="w">    </span><span class="nt">&lt;httpRuntime</span><span class="w"> </span><span class="na">enableVersionHeader=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/system.web&gt;</span>
<span class="nt">&lt;system.webServer&gt;</span>
<span class="w">    </span><span class="nt">&lt;security&gt;</span>
<span class="w">        </span><span class="nt">&lt;requestFiltering</span><span class="w"> </span><span class="na">removeServerHeader=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/security&gt;</span>
<span class="w">    </span><span class="nt">&lt;httpProtocol&gt;</span>
<span class="w">        </span><span class="nt">&lt;customHeaders&gt;</span>
<span class="w">            </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Content-Type-Options&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Frame-Options&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;DENY&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Permitted-Cross-Domain-Policies&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;master-only&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-XSS-Protection&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;remove</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Powered-By&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/customHeaders&gt;</span>
<span class="w">    </span><span class="nt">&lt;/httpProtocol&gt;</span>
<span class="nt">&lt;/system.webServer&gt;</span>
</code></pre></div>
<p>e.g Startup.cs</p>
<div class="highlight"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">UseHsts</span><span class="p">(</span><span class="n">hsts</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">hsts</span><span class="p">.</span><span class="n">MaxAge</span><span class="p">(</span><span class="m">365</span><span class="p">).</span><span class="n">IncludeSubdomains</span><span class="p">());</span>
<span class="n">app</span><span class="p">.</span><span class="n">UseXContentTypeOptions</span><span class="p">();</span>
<span class="n">app</span><span class="p">.</span><span class="n">UseReferrerPolicy</span><span class="p">(</span><span class="n">opts</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">opts</span><span class="p">.</span><span class="n">NoReferrer</span><span class="p">());</span>
<span class="n">app</span><span class="p">.</span><span class="n">UseXXssProtection</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">FilterDisabled</span><span class="p">());</span>
<span class="n">app</span><span class="p">.</span><span class="n">UseXfo</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Deny</span><span class="p">());</span>

<span class="n">app</span><span class="p">.</span><span class="n">UseCsp</span><span class="p">(</span><span class="n">opts</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">opts</span>
<span class="w"> </span><span class="p">.</span><span class="n">BlockAllMixedContent</span><span class="p">()</span>
<span class="w"> </span><span class="p">.</span><span class="n">StyleSources</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Self</span><span class="p">())</span>
<span class="w"> </span><span class="p">.</span><span class="n">StyleSources</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">UnsafeInline</span><span class="p">())</span>
<span class="w"> </span><span class="p">.</span><span class="n">FontSources</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Self</span><span class="p">())</span>
<span class="w"> </span><span class="p">.</span><span class="n">FormActions</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Self</span><span class="p">())</span>
<span class="w"> </span><span class="p">.</span><span class="n">FrameAncestors</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Self</span><span class="p">())</span>
<span class="w"> </span><span class="p">.</span><span class="n">ImageSources</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Self</span><span class="p">())</span>
<span class="w"> </span><span class="p">.</span><span class="n">ScriptSources</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Self</span><span class="p">())</span>
<span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>More information about headers can be found at the <a href="https://owasp.org/www-project-secure-headers/">OWASP Secure Headers Project</a>.</p>
<h4 id="encryption-for-storage">Encryption for storage<a class="headerlink" href="#encryption-for-storage" title="Permanent link">&para;</a></h4>
<ul>
<li>Use the <a href="https://docs.microsoft.com/en-us/dotnet/standard/security/how-to-use-data-protection">Windows Data Protection API (DPAPI)</a> for secure local storage of sensitive data.</li>
<li>Where DPAPI cannot be used, follow the algorithm guidance in the <a href="Cryptographic_Storage_Cheat_Sheet.html#algorithms">OWASP Cryptographic Storage Cheat Sheet</a>.</li>
</ul>
<p>The following code snippet shows an example of using AES-GCM to perform encryption/decryption of data. It is strongly recommended to have a cryptography expert review your final design and code, as even the most trivial error can severely weaken your encryption.</p>
<p>The code is based on example from here: <a href="https://www.scottbrady91.com/c-sharp/aes-gcm-dotnet">https://www.scottbrady91.com/c-sharp/aes-gcm-dotnet</a></p>
<p>A few constraints/pitfalls with this code:</p>
<ul>
<li>It does not take into account key rotation or management which is a whole topic in itself.</li>
<li>It is important to use a different nonce for every encryption operation, even if the same key is used.</li>
<li>The key will need to be stored securely.</li>
</ul>
<details>
  <summary>Click here to view the "AES-GCM symmetric encryption" code snippet.</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// Code based on example from here:</span>
<span class="c1">// https://www.scottbrady91.com/c-sharp/aes-gcm-dotnet</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">AesGcmSimpleTest</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// Key of 32 bytes / 256 bits for AES</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="m">32</span><span class="p">];</span>
<span class="w">        </span><span class="n">RandomNumberGenerator</span><span class="p">.</span><span class="n">Fill</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// MaxSize = 12 bytes / 96 bits and this size should always be used.</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">nonce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">NonceByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span>
<span class="w">        </span><span class="n">RandomNumberGenerator</span><span class="p">.</span><span class="n">Fill</span><span class="p">(</span><span class="n">nonce</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Tag for authenticated encryption</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">TagByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span>

<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This message to be encrypted&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Encrypt the message</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">cipherText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AesGcmSimple</span><span class="p">.</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">cipherText</span><span class="p">));</span>

<span class="w">        </span><span class="c1">// Decrypt the message</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">message2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AesGcmSimple</span><span class="p">.</span><span class="n">Decrypt</span><span class="p">(</span><span class="n">cipherText</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">message2</span><span class="p">);</span>


<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>


<span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">AesGcmSimple</span>
<span class="p">{</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="nf">Encrypt</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">plaintext</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">using</span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AesGcm</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Tag for authenticated encryption</span>
<span class="w">            </span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">TagByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span>

<span class="w">            </span><span class="c1">// Create a byte array from the message to encrypt</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">plaintextBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">plaintext</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Ciphertext will be same length in bytes as plaintext</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">ciphertext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">plaintextBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>

<span class="w">            </span><span class="c1">// perform the actual encryption</span>
<span class="w">            </span><span class="n">aes</span><span class="p">.</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">plaintextBytes</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Decrypt</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">using</span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AesGcm</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Plaintext will be same length in bytes as Ciphertext</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">plaintextBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">ciphertext</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>

<span class="w">            </span><span class="c1">// perform the actual decryption</span>
<span class="w">            </span><span class="n">aes</span><span class="p">.</span><span class="n">Decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">plaintextBytes</span><span class="p">);</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">plaintextBytes</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="encryption-for-transmission">Encryption for transmission<a class="headerlink" href="#encryption-for-transmission" title="Permanent link">&para;</a></h4>
<ul>
<li>Again, follow the algorithm guidance in the <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#algorithms">OWASP Cryptographic Storage Cheat Sheet</a>.</li>
</ul>
<p>The following code snippet shows an example of using Eliptic Curve/Diffie Helman (ECDH) together with AES-GCM to perform encryption/decryption of data between two different sides without the need the transfer the symmetric key between the two sides. Instead, the sides exchange public keys and can then use ECDH to generate a shared secret which can be used for the symmetric encryption.</p>
<p>Again, it is strongly recommended to have a cryptography expert review your final design and code, as even the most trivial error can severely weaken your encryption.</p>
<p>Note that this code sample relies on the <code>AesGcmSimple</code> class from the <a href="#encryption-for-storage">previous section</a>.</p>
<p>A few constraints/pitfalls with this code:</p>
<ul>
<li>It does not take into account key rotation or management which is a whole topic in itself.</li>
<li>The code deliberately enforces a new nonce for every encryption operation but this must be managed as a separate data item alongside the ciphertext.</li>
<li>The private keys will need to be stored securely.</li>
<li>The code does not consider the validation of public keys before use.</li>
<li>Overall, there is no verification of authenticity between the two sides.</li>
</ul>
<details>
  <summary>Click here to view the "ECDH asymmetric encryption" code snippet.</summary>

<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ECDHSimpleTest</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Generate ECC key pair for Alice</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">alice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ECDHSimple</span><span class="p">();</span>
<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">alicePublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">PublicKey</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Generate ECC key pair for Bob</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">bob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ECDHSimple</span><span class="p">();</span>
<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">bobPublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bob</span><span class="p">.</span><span class="n">PublicKey</span><span class="p">;</span>

<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">plaintext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello, Bob! How are you?&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Secret being sent from Alice to Bob: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">plaintext</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Note that a new nonce is generated with every encryption operation in line with</span>
<span class="w">        </span><span class="c1">// in line with the AES GCM security</span>
<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">tag</span><span class="p">;</span>
<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">nonce</span><span class="p">;</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">cipherText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">bobPublicKey</span><span class="p">,</span><span class="w"> </span><span class="n">plaintext</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">tag</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Ciphertext, nonce, and tag being sent from Alice to Bob: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">cipherText</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">tag</span><span class="p">));</span>

<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bob</span><span class="p">.</span><span class="n">Decrypt</span><span class="p">(</span><span class="n">alicePublicKey</span><span class="p">,</span><span class="w"> </span><span class="n">cipherText</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Secret received by Bob from Alice: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">decrypted</span><span class="p">);</span>

<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">();</span>

<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">plaintext2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello, Alice! I&#39;m good, how are you?&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Secret being sent from Bob to Alice: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">plaintext2</span><span class="p">);</span>

<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">tag2</span><span class="p">;</span>
<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">nonce2</span><span class="p">;</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">cipherText2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bob</span><span class="p">.</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">alicePublicKey</span><span class="p">,</span><span class="w"> </span><span class="n">plaintext2</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">nonce2</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">tag2</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Ciphertext, nonce, and tag being sent from Bob to Alice: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">cipherText2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">nonce2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">tag2</span><span class="p">));</span>

<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">decrypted2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">Decrypt</span><span class="p">(</span><span class="n">bobPublicKey</span><span class="p">,</span><span class="w"> </span><span class="n">cipherText2</span><span class="p">,</span><span class="w"> </span><span class="n">nonce2</span><span class="p">,</span><span class="w"> </span><span class="n">tag2</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Secret received by Alice from Bob: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">decrypted2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>


<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ECDHSimple</span>
<span class="p">{</span>

<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="n">ECDiffieHellmanCng</span><span class="w"> </span><span class="n">ecdh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ECDiffieHellmanCng</span><span class="p">();</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">PublicKey</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">get</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ecdh</span><span class="p">.</span><span class="n">PublicKey</span><span class="p">.</span><span class="n">ToByteArray</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="nf">Encrypt</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">partnerPublicKey</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">tag</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Generate the AES Key and Nonce</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">aesKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerateAESKey</span><span class="p">(</span><span class="n">partnerPublicKey</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Tag for authenticated encryption</span>
<span class="w">        </span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">TagByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span>

<span class="w">        </span><span class="c1">// MaxSize = 12 bytes / 96 bits and this size should always be used.</span>
<span class="w">        </span><span class="c1">// A new nonce is generated with every encryption operation in line with</span>
<span class="w">        </span><span class="c1">// the AES GCM security model</span>
<span class="w">        </span><span class="n">nonce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">NonceByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span>
<span class="w">        </span><span class="n">RandomNumberGenerator</span><span class="p">.</span><span class="n">Fill</span><span class="p">(</span><span class="n">nonce</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// return the encrypted value</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">AesGcmSimple</span><span class="p">.</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">aesKey</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Decrypt</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">partnerPublicKey</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">tag</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Generate the AES Key and Nonce</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">aesKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerateAESKey</span><span class="p">(</span><span class="n">partnerPublicKey</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// return the decrypted value</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">AesGcmSimple</span><span class="p">.</span><span class="n">Decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">aesKey</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="nf">GenerateAESKey</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">partnerPublicKey</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Derive the secret based on this side&#39;s private key and the other side&#39;s public key</span>
<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ecdh</span><span class="p">.</span><span class="n">DeriveKeyMaterial</span><span class="p">(</span><span class="n">CngKey</span><span class="p">.</span><span class="n">Import</span><span class="p">(</span><span class="n">partnerPublicKey</span><span class="p">,</span><span class="w"> </span><span class="n">CngKeyBlobFormat</span><span class="p">.</span><span class="n">EccPublicBlob</span><span class="p">));</span>

<span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">aesKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="m">32</span><span class="p">];</span><span class="w"> </span><span class="c1">// 256-bit AES key</span>
<span class="w">        </span><span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">aesKey</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">32</span><span class="p">);</span><span class="w"> </span><span class="c1">// Copy first 32 bytes as the key</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">aesKey</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="a03-injection">A03 Injection<a class="headerlink" href="#a03-injection" title="Permanent link">&para;</a></h3>
<h4 id="sql-injection">SQL Injection<a class="headerlink" href="#sql-injection" title="Permanent link">&para;</a></h4>
<p>DO: Using an object relational mapper (ORM) or stored procedures is the most effective way of countering the SQL Injection vulnerability.</p>
<p>DO: Use parameterized queries where a direct SQL query must be used. More Information can be found in the
<a href="Query_Parameterization_Cheat_Sheet.html">Query Parameterization Cheat Sheet</a>.</p>
<p>E.g., using Entity Framework:</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"></span><span class="n">sql</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="s">@&quot;Update[User]SETFirstName=@FirstNameWHEREId=@Id&quot;</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">Database</span><span class="p">.</span><span class="n">ExecuteSqlCommand</span><span class="p">(</span>
<span class="w">    </span><span class="n">sql</span><span class="p">,</span>
<span class="w">    </span><span class="k">new</span><span class="w"></span><span class="nf">SqlParameter</span><span class="p">(</span><span class="s">&quot;@FirstName&quot;</span><span class="p">,</span><span class="w"></span><span class="n">firstname</span><span class="p">),</span>
<span class="w">    </span><span class="k">new</span><span class="w"></span><span class="nf">SqlParameter</span><span class="p">(</span><span class="s">&quot;@Id&quot;</span><span class="p">,</span><span class="w"></span><span class="n">id</span><span class="p">));</span>
</code></pre></div>
<p>DO NOT: Concatenate strings anywhere in your code and execute them against your database (Known as <em>dynamic SQL</em>).</p>
<p>Note: You can still accidentally do this with ORMs or Stored procedures so check everywhere. For example:</p>
<div class="highlight"><pre><span></span><code><span class="kt">string</span><span class="w"></span><span class="n">sql</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="s">&quot;SELECT*FROMUsersWHEREUserName=&#39;&quot;</span><span class="w"></span><span class="o">+</span><span class="w"></span><span class="n">txtUser</span><span class="p">.</span><span class="n">Text</span><span class="w"></span><span class="o">+</span><span class="w"></span><span class="s">&quot;&#39;ANDPassword=&#39;&quot;</span>
<span class="w">                </span><span class="o">+</span><span class="w"></span><span class="n">txtPassword</span><span class="p">.</span><span class="n">Text</span><span class="w"></span><span class="o">+</span><span class="w"></span><span class="s">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">Database</span><span class="p">.</span><span class="n">ExecuteSqlCommand</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span><span class="w"> </span><span class="c1">//SQLInjectionvulnerability!</span>
</code></pre></div>
<p>DO: Practice Least Privilege - connect to the database using an account with a minimum set of permissions required
to do its job, not the database administrator account.</p>
<h4 id="os-injection">OS Injection<a class="headerlink" href="#os-injection" title="Permanent link">&para;</a></h4>
<p>General guidance about OS Injection can be found in the <a href="OS_Command_Injection_Defense_Cheat_Sheet.html">OS Command Injection Defense Cheat Sheet</a>.</p>
<p>DO: Use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.start?view=netframework-4.7.2">System.Diagnostics.Process.Start</a> to call underlying OS functions.</p>
<p>e.g</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">Process</span><span class="p">();</span>
<span class="kt">var</span><span class="w"> </span><span class="n">startInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">ProcessStartInfo</span><span class="p">();</span>
<span class="n">startInfo</span><span class="p">.</span><span class="n">FileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;validatedCommand&quot;</span><span class="p">;</span>
<span class="n">startInfo</span><span class="p">.</span><span class="n">Arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;validatedArg1 validatedArg2 validatedArg3&quot;</span><span class="p">;</span>
<span class="n">process</span><span class="p">.</span><span class="n">StartInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startInfo</span><span class="p">;</span>
<span class="n">process</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</code></pre></div>
<p>DO NOT: Assume that this mechanism will protect against malicious input designed to break out of one argument and then tamper with another argument to the process. This will still be possible.</p>
<p>DO: Use allowlist validation on all user supplied input wherever possible. Input validation prevents improperly formed data from entering an information system. For more information please see the <a href="Input_Validation_Cheat_Sheet.html">Input Validation Cheat Sheet</a>.</p>
<p>e.g Validating user input using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.ipaddress.tryparse?view=netframework-4.8">IPAddress.TryParse Method</a></p>
<div class="highlight"><pre><span></span><code><span class="c1">//User input</span>
<span class="kt">string</span><span class="w"> </span><span class="n">ipAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">;</span>

<span class="c1">//check to make sure an ip address was provided</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">ipAddress</span><span class="p">))</span>
<span class="p">{</span>
<span class="w"> </span><span class="c1">// Create an instance of IPAddress for the specified address string (in</span>
<span class="w"> </span><span class="c1">// dotted-quad, or colon-hexadecimal notation).</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IPAddress</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">ipAddress</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">var</span><span class="w"> </span><span class="n">address</span><span class="p">))</span>
<span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Display the address in standard notation.</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">address</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">else</span>
<span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">//ipAddress is not of type IPAddress</span>
<span class="w">  </span><span class="p">...</span>
<span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>DO: Try to only accept characters which are simple alphanumeric.</p>
<p>DO NOT: Assume you can sanitize special characters without actually removing them. Various combinations of <code>\</code>, <code>'</code> and <code>@</code> may have an unexpected impact on sanitization attempts.</p>
<p>DO NOT: Rely on methods without a security guarantee.</p>
<p>e.g. .NET Core 2.2 and greater and .NET 5 and greater support <a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.argumentlist">ProcessStartInfo.ArgumentList</a> which performs some character escaping but the object includes <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.argumentlist#remarks">a disclaimer that it is not safe with untrusted input</a>.</p>
<p>DO: Look at alternatives to passing raw untrusted arguments via command-line parameters such as encoding using Base64 (which would safely encode any special characters as well) and then decode the parameters in the receiving application.</p>
<h4 id="ldap-injection">LDAP injection<a class="headerlink" href="#ldap-injection" title="Permanent link">&para;</a></h4>
<p>Almost any characters can be used in Distinguished Names. However, some must be escaped with the backslash <code>\</code> escape character.
A table showing which characters that should be escaped for Active Directory can be found at the in the
<a href="LDAP_Injection_Prevention_Cheat_Sheet.html">LDAP Injection Prevention Cheat Sheet</a>.</p>
<p>Note: The space character must be escaped only if it is the leading or trailing character in a component name, such as a Common Name.
Embedded spaces should not be escaped.</p>
<p>More information can be found in the <a href="LDAP_Injection_Prevention_Cheat_Sheet.html">LDAP Injection Prevention Cheat Sheet</a>.</p>
<h3 id="a04-insecure-design">A04 Insecure Design<a class="headerlink" href="#a04-insecure-design" title="Permanent link">&para;</a></h3>
<p>Insecure design refers to security failures in the design of the application or system. This is different than the other items
in the OWASP Top 10 list which refer to implementation failures. The topic of secure design is therefore not related to a specific
technology or language and is therefore out of scope for this cheat sheet. See the <a href="Secure_Product_Design_Cheat_Sheet.html">Secure Product Design Cheat Sheet</a> for more information.</p>
<h3 id="a05-security-misconfiguration">A05 Security Misconfiguration<a class="headerlink" href="#a05-security-misconfiguration" title="Permanent link">&para;</a></h3>
<h4 id="debug-and-stack-trace">Debug and Stack Trace<a class="headerlink" href="#debug-and-stack-trace" title="Permanent link">&para;</a></h4>
<p>Ensure debug and trace are off in production. This can be enforced using web.config transforms:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;compilation</span><span class="w"> </span><span class="na">xdt:Transform=</span><span class="s">&quot;RemoveAttributes(debug)&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;trace</span><span class="w"> </span><span class="na">enabled=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="na">xdt:Transform=</span><span class="s">&quot;Replace&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>DO NOT: Use default passwords</p>
<p>DO: Redirect a request made over HTTP to HTTPS:</p>
<p>E.g, Global.asax.cs:</p>
<div class="highlight"><pre><span></span><code><span class="k">protected</span><span class="w"></span><span class="k">void</span><span class="w"></span><span class="nf">Application_BeginRequest</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="cp">#if!DEBUG</span>
<span class="w">    </span><span class="c1">//SECURE:EnsureanyrequestisreturnedoverSSL/TLSinproduction</span>
<span class="w">    </span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="o">!</span><span class="n">Request</span><span class="p">.</span><span class="n">IsLocal</span><span class="w"></span><span class="o">&amp;&amp;</span><span class="w"></span><span class="o">!</span><span class="n">Context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">IsSecureConnection</span><span class="p">)</span><span class="w"></span><span class="p">{</span>
<span class="w">        </span><span class="kt">var</span><span class="w"></span><span class="n">redirect</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">Context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Url</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="n">ToLower</span><span class="p">(</span><span class="n">CultureInfo</span><span class="p">.</span><span class="n">CurrentCulture</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&quot;http:&quot;</span><span class="p">,</span><span class="w"></span><span class="s">&quot;https:&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">Response</span><span class="p">.</span><span class="n">Redirect</span><span class="p">(</span><span class="n">redirect</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cp">#endif</span>
<span class="p">}</span>
</code></pre></div>
<p>E.g., Startup.cs in <code>Configure()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="n">app</span><span class="p">.</span><span class="n">UseHttpsRedirection</span><span class="p">();</span>
</code></pre></div>
<h4 id="cross-site-request-forgery">Cross-site request forgery<a class="headerlink" href="#cross-site-request-forgery" title="Permanent link">&para;</a></h4>
<p>DO NOT: Send sensitive data without validating Anti-Forgery-Tokens (<a href="https://docs.microsoft.com/en-us/aspnet/web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks">.NET</a> / <a href="https://learn.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-7.0#aspnet-core-antiforgery-configuration">.NET Core</a>).</p>
<p>DO: Send the anti-forgery token with every POST/PUT request:</p>
<h5 id="using-net-framework">Using .NET Framework<a class="headerlink" href="#using-net-framework" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">Html</span><span class="p">.</span><span class="n">BeginForm</span><span class="p">(</span><span class="s">&quot;LogOff&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Account&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">FormMethod</span><span class="p">.</span><span class="n">Post</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;logoutForm&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">@class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pull-right&quot;</span><span class="w"> </span><span class="p">}))</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">@Html</span><span class="p">.</span><span class="n">AntiForgeryToken</span><span class="p">()</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">ul</span><span class="w"> </span><span class="n">class</span><span class="o">=</span><span class="s">&quot;nav nav-pills&quot;</span><span class="o">&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="n">li</span><span class="w"> </span><span class="n">role</span><span class="o">=</span><span class="s">&quot;presentation&quot;</span><span class="o">&gt;</span>
<span class="w">        </span><span class="n">Logged</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">@User</span><span class="p">.</span><span class="n">Identity</span><span class="p">.</span><span class="n">Name</span>
<span class="w">        </span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="n">li</span><span class="w"> </span><span class="n">role</span><span class="o">=</span><span class="s">&quot;presentation&quot;</span><span class="o">&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="n">a</span><span class="w"> </span><span class="n">href</span><span class="o">=</span><span class="s">&quot;javascript:document.getElementById(&#39;logoutForm&#39;).submit()&quot;</span><span class="o">&gt;</span><span class="n">Log</span><span class="w"> </span><span class="n">off</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="w">        </span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre></div>
<p>Then validate it at the method or preferably the controller level:</p>
<div class="highlight"><pre><span></span><code><span class="na">[HttpPost]</span>
<span class="na">[ValidateAntiForgeryToken]</span>
<span class="k">public</span><span class="w"></span><span class="n">ActionResult</span><span class="w"></span><span class="nf">LogOff</span><span class="p">()</span>
</code></pre></div>
<p>Make sure the tokens are removed completely for invalidation on logout.</p>
<div class="highlight"><pre><span></span><code><span class="c1">///&lt;summary&gt;</span>
<span class="c1">///SECURE:RemoveanyremainingcookiesincludingAnti-CSRFcookie</span>
<span class="c1">///&lt;/summary&gt;</span>
<span class="k">public</span><span class="w"></span><span class="k">void</span><span class="w"></span><span class="nf">RemoveAntiForgeryCookie</span><span class="p">(</span><span class="n">Controller</span><span class="w"></span><span class="n">controller</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="p">[]</span><span class="w"></span><span class="n">allCookies</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">controller</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Cookies</span><span class="p">.</span><span class="n">AllKeys</span><span class="p">;</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"></span><span class="p">(</span><span class="kt">string</span><span class="w"></span><span class="n">cookie</span><span class="w"></span><span class="k">in</span><span class="w"></span><span class="n">allCookies</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">controller</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Cookies</span><span class="p">[</span><span class="n">cookie</span><span class="p">]</span><span class="w"></span><span class="o">!=</span><span class="w"></span><span class="k">null</span><span class="w"></span><span class="o">&amp;&amp;</span>
<span class="w">            </span><span class="n">cookie</span><span class="w"></span><span class="o">==</span><span class="w"></span><span class="s">&quot;__RequestVerificationToken&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">controller</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Cookies</span><span class="p">[</span><span class="n">cookie</span><span class="p">].</span><span class="n">Expires</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">AddDays</span><span class="p">(</span><span class="o">-</span><span class="m">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="using-net-core-20-or-later">Using .NET Core 2.0 or later<a class="headerlink" href="#using-net-core-20-or-later" title="Permanent link">&para;</a></h5>
<p>Starting with .NET Core 2.0 it is possible to <a href="https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-7.0#aspnet-core-antiforgery-configuration">automatically generate and verify the antiforgery token</a>.</p>
<p>If you are using <a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro">tag-helpers</a>, which is the default for most web project templates, then all forms will automatically send the anti-forgery token. You can check if tag-helpers are enabled by checking if your main <code>_ViewImports.cshtml</code> file contains:</p>
<div class="highlight"><pre><span></span><code><span class="n">@addTagHelper</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Microsoft</span><span class="p">.</span><span class="n">AspNetCore</span><span class="p">.</span><span class="n">Mvc</span><span class="p">.</span><span class="n">TagHelpers</span>
</code></pre></div>
<p><code>IHtmlHelper.BeginForm</code> also sends anti-forgery-tokens automatically.</p>
<p>If you are not using tag-helpers or <code>IHtmlHelper.BeginForm</code>, you must use the requisite helper on forms as seen here:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;RelevantAction&quot;</span> <span class="p">&gt;</span>
@Html.AntiForgeryToken()
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>
<p>To automatically validate all requests other than GET, HEAD, OPTIONS and TRACE you need to add a global action filter with the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.autovalidateantiforgerytokenattribute?view=aspnetcore-7.0">AutoValidateAntiforgeryToken</a> attribute inside your <code>Startup.cs</code> as mentioned in the following <a href="https://andrewlock.net/automatically-validating-anti-forgery-tokens-in-asp-net-core-with-the-autovalidateantiforgerytokenattribute/">article</a>:</p>
<div class="highlight"><pre><span></span><code><span class="n">services</span><span class="p">.</span><span class="n">AddMvc</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">Filters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AutoValidateAntiforgeryTokenAttribute</span><span class="p">());</span>
<span class="p">});</span>
</code></pre></div>
<p>If you need to disable the attribute validation for a specific method on a controller you can add the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.ignoreantiforgerytokenattribute?view=aspnetcore-7.0">IgnoreAntiforgeryToken</a> attribute to the controller method (for MVC controllers) or parent class (for Razor pages):</p>
<div class="highlight"><pre><span></span><code><span class="na">[IgnoreAntiforgeryToken]</span>
<span class="na">[HttpDelete]</span>
<span class="k">public</span><span class="w"> </span><span class="n">IActionResult</span><span class="w"> </span><span class="nf">Delete</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="na">[IgnoreAntiforgeryToken]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UnsafeModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PageModel</span>
</code></pre></div>
<p>If you need to also validate the token on GET, HEAD, OPTIONS and TRACE requests you can add the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.validateantiforgerytokenattribute?view=aspnetcore-7.0">ValidateAntiforgeryToken</a> attribute to the controller method (for MVC controllers) or parent class (for Razor pages):</p>
<div class="highlight"><pre><span></span><code><span class="na">[HttpGet]</span>
<span class="na">[ValidateAntiforgeryToken]</span>
<span class="k">public</span><span class="w"> </span><span class="n">IActionResult</span><span class="w"> </span><span class="nf">DoSomethingDangerous</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="na">[HttpGet]</span>
<span class="na">[ValidateAntiforgeryToken]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">SafeModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PageModel</span>
</code></pre></div>
<p>In case you can't use a global action filter, add the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.autovalidateantiforgerytokenattribute?view=aspnetcore-7.0">AutoValidateAntiforgeryToken</a> attribute to your controller classes or razor page models:</p>
<div class="highlight"><pre><span></span><code><span class="na">[AutoValidateAntiforgeryToken]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UserController</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="na">[AutoValidateAntiforgeryToken]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">SafeModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PageModel</span>
</code></pre></div>
<h5 id="using-net-core-or-net-framework-with-ajax">Using .Net Core or .NET Framework with AJAX<a class="headerlink" href="#using-net-core-or-net-framework-with-ajax" title="Permanent link">&para;</a></h5>
<p>You will need to attach the anti-forgery token to AJAX requests.</p>
<p>If you are using jQuery in an ASP.NET Core MVC view this can be achieved using this snippet:</p>
<div class="highlight"><pre><span></span><code><span class="err">@</span><span class="nx">inject</span><span class="w">  </span><span class="nx">Microsoft</span><span class="p">.</span><span class="nx">AspNetCore</span><span class="p">.</span><span class="nx">Antiforgery</span><span class="p">.</span><span class="nx">IAntiforgery</span><span class="w"> </span><span class="nx">antiforgeryProvider</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span>
<span class="p">{</span>
<span class="w">    </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;@Url.Action(&quot;Action&quot;, &quot;Controller&quot;)&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">contentType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/x-www-form-urlencoded; charset=utf-8&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">id</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;__RequestVerificationToken&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;@antiforgeryProvider.GetAndStoreTokens(this.Context).RequestToken&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
<p>If you are using the .NET Framework, you can find some code snippets <a href="https://docs.microsoft.com/en-us/aspnet/web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks#anti-csrf-and-ajax">here</a>.</p>
<p>More information can be found in the <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">Cross-Site Request Forgery Prevention Cheat Sheet</a>.</p>
<h3 id="a06-vulnerable-and-outdated-components">A06 Vulnerable and Outdated Components<a class="headerlink" href="#a06-vulnerable-and-outdated-components" title="Permanent link">&para;</a></h3>
<p>DO: Keep the .NET framework updated with the latest patches</p>
<p>DO: Keep your <a href="https://docs.microsoft.com/en-us/nuget/">NuGet</a> packages up to date</p>
<p>DO: Run the <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html#tools">OWASP Dependency Checker</a> against your application as part of your build process and act on any high or critical level vulnerabilities.</p>
<p>DO: Include SCA (software composition analysis) tools in your CI/CD pipeline to ensure that any new vulnerabilities
in your dependencies are detected and acted upon.</p>
<h3 id="a07-identification-and-authentication-failures">A07 Identification and Authentication Failures<a class="headerlink" href="#a07-identification-and-authentication-failures" title="Permanent link">&para;</a></h3>
<p>DO: Use <a href="https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity?view=aspnetcore-2.2&amp;">ASP.NET Core Identity</a>.
ASP.NET Core Identity framework is well configured by default, where it uses secure password hashes and an individual salt. Identity uses the PBKDF2 hashing function for passwords, and generates a random salt per user.</p>
<p>DO: Set secure password policy</p>
<p>e.g ASP.NET Core Identity</p>
<div class="highlight"><pre><span></span><code><span class="c1">//Startup.cs</span>
<span class="n">services</span><span class="p">.</span><span class="n">Configure</span><span class="o">&lt;</span><span class="n">IdentityOptions</span><span class="o">&gt;</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w"> </span><span class="c1">// Password settings</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireDigit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequiredLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">;</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireNonAlphanumeric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireUppercase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireLowercase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequiredUniqueChars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">;</span>

<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Lockout</span><span class="p">.</span><span class="n">DefaultLockoutTimeSpan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">30</span><span class="p">);</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Lockout</span><span class="p">.</span><span class="n">MaxFailedAccessAttempts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span>

<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">SignIn</span><span class="p">.</span><span class="n">RequireConfirmedEmail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>

<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">User</span><span class="p">.</span><span class="n">RequireUniqueEmail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>
<p>DO: Set a cookie policy</p>
<p>e.g</p>
<div class="highlight"><pre><span></span><code><span class="c1">//Startup.cs</span>
<span class="n">services</span><span class="p">.</span><span class="n">ConfigureApplicationCookie</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Cookie</span><span class="p">.</span><span class="n">HttpOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">Cookie</span><span class="p">.</span><span class="n">Expiration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromHours</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="w"> </span><span class="n">options</span><span class="p">.</span><span class="n">SlidingExpiration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>
<h3 id="a08-software-and-data-integrity-failures">A08 Software and Data Integrity Failures<a class="headerlink" href="#a08-software-and-data-integrity-failures" title="Permanent link">&para;</a></h3>
<p>DO: Digitally sign assemblies and executable files</p>
<p>DO: Use Nuget package signing</p>
<p>DO: Review code and configuration changes to avoid malicious code
or dependencies being introduced</p>
<p>DO NOT: Send unsigned or unencrypted serialized objects over the network</p>
<p>DO: Perform integrity checks or validate digital signatures on serialized
objects received from the network</p>
<p>DO NOT: Use theBinaryFormattertype which is dangerous and <a href="https://learn.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide">notrecommended</a> for data processing.
.NET offers several in-box serializers that can handle untrusted data safely:</p>
<ul>
<li>XmlSerializerandDataContractSerializerto serialize object graphs into and from XML. Do not confuseDataContractSerializerwithNetDataContractSerializer.</li>
<li>BinaryReaderandBinaryWriterfor XML and JSON.</li>
<li>TheSystem.Text.JsonAPIs to serialize object graphs into JSON.</li>
</ul>
<h3 id="a09-security-logging-and-monitoring-failures">A09 Security Logging and Monitoring Failures<a class="headerlink" href="#a09-security-logging-and-monitoring-failures" title="Permanent link">&para;</a></h3>
<p>DO: Ensure all login, access control, and server-side input validation failures are logged with sufficient user context to identify suspicious or malicious accounts.</p>
<p>DO: Establish effective monitoring and alerting so suspicious activities are detected and responded to in a timely fashion.</p>
<p>DO NOT: Log generic error messages such as: <code>csharp Log.Error("Error was thrown");</code>. Instead, log the stack trace, error message and user ID who caused the error.</p>
<p>DO NOT: Log sensitive data such as user's passwords.</p>
<h4 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h4>
<p>What logs to collect and more information about logging can be found in the <a href="Logging_Cheat_Sheet.html">Logging Cheat Sheet</a>.</p>
<p>.NET Core comes with a LoggerFactory, which is in Microsoft.Extensions.Logging. More information about ILogger can be found <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.ilogger">here</a>.</p>
<p>Here's how to log all errors from the <code>Startup.cs</code>, so that anytime an error is thrown it will be logged:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Configure</span><span class="p">(</span><span class="n">IApplicationBuilder</span><span class="w"> </span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="n">IHostingEnvironment</span><span class="w"> </span><span class="n">env</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="n">IsDevelopment</span><span class="p">())</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_isDevelopment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="n">UseDeveloperExceptionPage</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//Log all errors in the application</span>
<span class="w">    </span><span class="n">app</span><span class="p">.</span><span class="n">UseExceptionHandler</span><span class="p">(</span><span class="n">errorApp</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">errorApp</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">errorFeature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">Features</span><span class="p">.</span><span class="n">Get</span><span class="o">&lt;</span><span class="n">IExceptionHandlerFeature</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errorFeature</span><span class="p">.</span><span class="n">Error</span><span class="p">;</span>

<span class="w">            </span><span class="n">Log</span><span class="p">.</span><span class="n">Error</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;Stacktrace of error: {0}&quot;</span><span class="p">,</span><span class="n">exception</span><span class="p">.</span><span class="n">StackTrace</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">app</span><span class="p">.</span><span class="n">UseAuthentication</span><span class="p">();</span>
<span class="w">    </span><span class="n">app</span><span class="p">.</span><span class="n">UseMvc</span><span class="p">();</span>
<span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>E.g. injecting into the class constructor, which makes writing unit test simpler. This is recommended if instances of the class will be created using dependency injection (e.g. MVC controllers). The below example shows logging of all unsuccessful login attempts.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">AccountsController</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Controller</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">private</span><span class="w"> </span><span class="n">ILogger</span><span class="w"> </span><span class="n">_Logger</span><span class="p">;</span>

<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="nf">AccountsController</span><span class="p">(</span><span class="n">ILogger</span><span class="w"> </span><span class="n">logger</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">_Logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logger</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="na">[HttpPost]</span>
<span class="w">        </span><span class="na">[AllowAnonymous]</span>
<span class="w">        </span><span class="na">[ValidateAntiForgeryToken]</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">IActionResult</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Login</span><span class="p">(</span><span class="n">LoginViewModel</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ModelState</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_signInManager</span><span class="p">.</span><span class="n">PasswordSignInAsync</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">Password</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">RememberMe</span><span class="p">,</span><span class="w"> </span><span class="n">lockoutOnFailure</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">//Log all successful log in attempts</span>
<span class="w">                    </span><span class="n">Log</span><span class="p">.</span><span class="n">Information</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;User: {0}, Successfully Logged in&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">));</span>
<span class="w">                    </span><span class="c1">//Code for successful login</span>
<span class="w">                    </span><span class="c1">//...</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">//Log all incorrect log in attempts</span>
<span class="w">                    </span><span class="n">Log</span><span class="p">.</span><span class="n">Information</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;User: {0}, Incorrect Password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">));</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">            </span><span class="p">...</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>
<h4 id="monitoring">Monitoring<a class="headerlink" href="#monitoring" title="Permanent link">&para;</a></h4>
<p>Monitoring allow us to validate the performance and health of a running system through key performance indicators.</p>
<p>In .NET a great option to add monitoring capabilities is <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/asp-net-core">Application Insights</a>.</p>
<p>More information about Logging and Monitoring can be found <a href="https://github.com/microsoft/code-with-engineering-playbook/blob/main/docs/observability/README.md">here</a>.</p>
<h3 id="a10-server-side-request-forgery-ssrf">A10 Server-Side Request Forgery (SSRF)<a class="headerlink" href="#a10-server-side-request-forgery-ssrf" title="Permanent link">&para;</a></h3>
<p>DO: Validate and sanitize all user input before using it to make a request</p>
<p>DO: Use an allowlist of allowed protocols and domains</p>
<p>DO: Use <code>IPAddress.TryParse()</code> and <code>Uri.CheckHostName()</code> to ensure that IP addresses and domain names are valid</p>
<p>DO NOT: Follow HTTP redirects</p>
<p>DO NOT: Forward raw HTTP responses to the user</p>
<p>For more information please see the <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html">Server-Side Request Forgery Prevention Cheat Sheet</a>.</p>
<h3 id="owasp-2013-2017">OWASP 2013 &amp; 2017<a class="headerlink" href="#owasp-2013-2017" title="Permanent link">&para;</a></h3>
<p>Below are vulnerabilities that were included in the 2013 or 2017 OWASP Top 10 list
that were not included in the 2021 list. These vulnerabilities are still relevant
but were not included in the 2021 list because they have become less prevalent.</p>
<h4 id="a042017-xml-external-entities-xxe">A04:2017 XML External Entities (XXE)<a class="headerlink" href="#a042017-xml-external-entities-xxe" title="Permanent link">&para;</a></h4>
<p>XXE attacks occur when an XML parse does not properly process user input that contains external entity declarations in the doctype of an XML payload.</p>
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xml-processing-options">This article</a> discusses the most common XML Processing Options for .NET.</p>
<p>Please refer to the <a href="XML_External_Entity_Prevention_Cheat_Sheet.html#net">XXE cheat sheet</a> for more detailed information on preventing XXE and other XML Denial of Service attacks.</p>
<h4 id="a072017-cross-site-scripting-xss">A07:2017 Cross-Site Scripting (XSS)<a class="headerlink" href="#a072017-cross-site-scripting-xss" title="Permanent link">&para;</a></h4>
<p>DO NOT: Trust any data the user sends you. Prefer allowlists (always safe) over denylists.</p>
<p>You get encoding of all HTML content with MVC3. To properly encode all content whether HTML,
JavaScript, CSS, LDAP, etc., use the Microsoft AntiXSS library:</p>
<p><code>Install-PackageAntiXSS</code></p>
<p>Then set in config:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;system.web&gt;</span>
<span class="nt">&lt;httpRuntime</span><span class="w"> </span><span class="na">targetFramework=</span><span class="s">&quot;4.5&quot;</span>
<span class="na">enableVersionHeader=</span><span class="s">&quot;false&quot;</span>
<span class="na">encoderType=</span><span class="s">&quot;Microsoft.Security.Application.AntiXssEncoder, AntiXssLibrary&quot;</span>
<span class="na">maxRequestLength=</span><span class="s">&quot;4096&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
<p>DO NOT: Use the <code>[AllowHTML]</code> attribute or helper class <code>@Html.Raw</code> unless you are absolutely
sure that the content you are writing to the browser is safe and has been escaped properly.</p>
<p>DO: Enable a <a href="Content_Security_Policy_Cheat_Sheet.html#context">Content Security Policy</a>. This will prevent your pages from accessing assets they should not be able to access (e.g. malicious scripts):</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;system.webServer&gt;</span>
<span class="w">    </span><span class="nt">&lt;httpProtocol&gt;</span>
<span class="w">        </span><span class="nt">&lt;customHeaders&gt;</span>
<span class="w">            </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Content-Security-Policy&quot;</span>
<span class="w">                </span><span class="na">value=</span><span class="s">&quot;default-src &#39;none&#39;; style-src &#39;self&#39;; img-src &#39;self&#39;;</span>
<span class="s">                font-src &#39;self&#39;; script-src &#39;self&#39;&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
<p>More information can be found in the <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html">Cross Site Scripting Prevention Cheat Sheet</a>.</p>
<h4 id="a082017-insecure-deserialization">A08:2017 Insecure Deserialization<a class="headerlink" href="#a082017-insecure-deserialization" title="Permanent link">&para;</a></h4>
<p>DO NOT: Accept Serialized Objects from Untrusted Sources</p>
<p>DO: Validate User Input</p>
<p>Malicious users are able to use objects like cookies to insert malicious information to change user roles. In some cases, hackers are able to elevate their privileges to administrator rights by using a pre-existing or cached password hash from a previous session.</p>
<p>DO: Prevent Deserialization of Domain Objects</p>
<p>DO: Run the Deserialization Code with Limited Access Permissions
If a deserialized hostile object tries to initiate a system process or access a resource within the server or the host's OS, it will be denied access and a permission flag will be raised so that a system administrator is made aware of any anomalous activity on the server.</p>
<p>More information about Insecure Deserialization can be found in the <a href="Deserialization_Cheat_Sheet.html#net-csharp">Deserialization Cheat Sheet</a>.</p>
<h4 id="a102013-unvalidated-redirects-and-forwards">A10:2013 Unvalidated redirects and forwards<a class="headerlink" href="#a102013-unvalidated-redirects-and-forwards" title="Permanent link">&para;</a></h4>
<p>A protection against this was introduced in MVC 3 template. Here is the code:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"></span><span class="k">async</span><span class="w"></span><span class="n">Task</span><span class="o">&lt;</span><span class="n">ActionResult</span><span class="o">&gt;</span><span class="w"></span><span class="n">LogOn</span><span class="p">(</span><span class="n">LogOnViewModel</span><span class="w"></span><span class="n">model</span><span class="p">,</span><span class="w"></span><span class="kt">string</span><span class="w"></span><span class="n">returnUrl</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">ModelState</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">var</span><span class="w"></span><span class="n">logonResult</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">await</span><span class="w"></span><span class="n">_userManager</span><span class="p">.</span><span class="n">TryLogOnAsync</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">UserName</span><span class="p">,</span><span class="w"></span><span class="n">model</span><span class="p">.</span><span class="n">Password</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">logonResult</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">await</span><span class="w"></span><span class="n">_userManager</span><span class="p">.</span><span class="n">LogOnAsync</span><span class="p">(</span><span class="n">logonResult</span><span class="p">.</span><span class="n">UserName</span><span class="p">,</span><span class="w"></span><span class="n">model</span><span class="p">.</span><span class="n">RememberMe</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"></span><span class="nf">RedirectToLocal</span><span class="p">(</span><span class="n">returnUrl</span><span class="p">);</span>
<span class="p">...</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"></span><span class="n">ActionResult</span><span class="w"></span><span class="nf">RedirectToLocal</span><span class="p">(</span><span class="kt">string</span><span class="w"></span><span class="n">returnUrl</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">Url</span><span class="p">.</span><span class="n">IsLocalUrl</span><span class="p">(</span><span class="n">returnUrl</span><span class="p">))</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"></span><span class="nf">Redirect</span><span class="p">(</span><span class="n">returnUrl</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"></span><span class="nf">RedirectToAction</span><span class="p">(</span><span class="s">&quot;Landing&quot;</span><span class="p">,</span><span class="w"></span><span class="s">&quot;Account&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="other-advice">Other advice<a class="headerlink" href="#other-advice" title="Permanent link">&para;</a></h3>
<ul>
<li>Protect against Clickjacking and Man-in-the-Middle attack from capturing an initial Non-TLS request: Set the <code>X-Frame-Options</code> and <code>Strict-Transport-Security</code> (HSTS) headers. Full details <a href="https://github.com/johnstaveley/SecurityEssentials/blob/master/SecurityEssentials/Core/HttpHeaders.cs">here</a></li>
<li>Protect against a man-in-the-middle attack for a user who has never been to your site before. Register for <a href="https://hstspreload.org/">HSTS preload</a></li>
<li>Maintain security testing and analysis on Web API services. They are hidden inside MVC sites, and are public parts of a site that
will be found by an attacker. All of the MVC guidance and much of the WCF guidance applies to Web API as well.</li>
<li>Also see the <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html">Unvalidated Redirects and Forwards Cheat Sheet</a>.</li>
</ul>
<h4 id="sample-project">Sample project<a class="headerlink" href="#sample-project" title="Permanent link">&para;</a></h4>
<p>For more information on all of the above and code samples incorporated into a sample MVC5 application with an enhanced security baseline
go to <a href="http://github.com/johnstaveley/SecurityEssentials/">Security Essentials Baseline project</a>.</p>
<h2 id="guidance-for-specific-topics">Guidance for specific topics<a class="headerlink" href="#guidance-for-specific-topics" title="Permanent link">&para;</a></h2>
<p>This section contains guidance for specific topics in .NET.</p>
<h3 id="configuration-and-deployment">Configuration and Deployment<a class="headerlink" href="#configuration-and-deployment" title="Permanent link">&para;</a></h3>
<ul>
<li>Lock down config files.<ul>
<li>Remove all aspects of configuration that are not in use.</li>
<li>Encrypt sensitive parts of the <code>web.config</code> using <code>aspnet_regiis -pe</code> (<a href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-2.0/k6h9cz8h(v=vs.80)">command line help</a>).</li>
</ul>
</li>
<li>For ClickOnce applications, the .NET Framework should be upgraded to use the latest version to ensure support of TLS 1.2 or later.</li>
</ul>
<h3 id="data-access">Data Access<a class="headerlink" href="#data-access" title="Permanent link">&para;</a></h3>
<ul>
<li>Use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlcommand.prepare?view=netframework-4.7.2">Parameterized SQL</a> commands for all data access, without exception.</li>
<li>Do not use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlcommand">SqlCommand</a> with a string parameter made up of a <a href="https://docs.microsoft.com/en-gb/visualstudio/code-quality/ca2100-review-sql-queries-for-security-vulnerabilities?view=vs-2017">concatenated SQL String</a>.</li>
<li>List allowable values coming from the user. Use enums, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.int32.tryparse#System_Int32_TryParse_System_String_System_Int32__">TryParse</a> or lookup values to assure that the data coming from the user is as expected.<ul>
<li>Enums are still vulnerable to unexpected values because .NET only validates a successful cast to the underlying data type, integer by default. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.enum.isdefined">Enum.IsDefined</a> can validate whether the input value is valid within the list of defined constants.</li>
</ul>
</li>
<li>Apply the principle of least privilege when setting up the Database User in your database of choice. The database user should only be able to access items that make sense for the use case.</li>
<li>Use of <a href="https://docs.microsoft.com/en-us/ef/">Entity Framework</a> is a very effective <a href="SQL_Injection_Prevention_Cheat_Sheet.html">SQL injection</a> prevention mechanism. <strong>Remember that building your own ad hoc queries in Entity Framework is just as susceptible to SQLi as a plain SQL query</strong>.</li>
<li>When using SQL Server, prefer <a href="https://learn.microsoft.com/en-us/sql/connect/odbc/linux-mac/using-integrated-authentication?view=sql-server-ver16">integrated authentication</a> over <a href="https://learn.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode?view=sql-server-ver16#connecting-through-sql-server-authentication">SQL authentication</a>.</li>
<li>Use <a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/always-encrypted-database-engine">Always Encrypted</a> where possible for sensitive data (SQL Server 2016+ and Azure SQL)</li>
</ul>
<h2 id="asp-net-web-forms-guidance">ASP NET Web Forms Guidance<a class="headerlink" href="#asp-net-web-forms-guidance" title="Permanent link">&para;</a></h2>
<p>ASP.NET Web Forms is the original browser-based application development API for the .NET Framework, and is still the most common enterprise platform for web application development.</p>
<ul>
<li>Always use <a href="http://support.microsoft.com/kb/324069">HTTPS</a>.</li>
<li>Enable <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpcookiessection.requiressl">requireSSL</a> on cookies and form elements and <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpcookiessection.httponlycookies">HttpOnly</a> on cookies in the web.config.</li>
<li>Implement <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.customerror">customErrors</a>.</li>
<li>Make sure <a href="http://www.iis.net/configreference/system.webserver/tracing">tracing</a> is turned off.</li>
<li>While ViewState isn't always appropriate for web development, using it can provide CSRF mitigation. To make the ViewState protect against CSRF attacks you need to set the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.page.viewstateuserkey">ViewStateUserKey</a>:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">protected</span><span class="w"></span><span class="k">override</span><span class="w"></span><span class="nf">OnInit</span><span class="p">(</span><span class="n">EventArgs</span><span class="w"></span><span class="n">e</span><span class="p">)</span><span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="k">base</span><span class="p">.</span><span class="n">OnInit</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w"></span><span class="n">ViewStateUserKey</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">Session</span><span class="p">.</span><span class="n">SessionID</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>If you don't use Viewstate, then look to the default main page of the ASP.NET Web Forms default template for a manual anti-CSRF token using a double-submit cookie.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"></span><span class="k">const</span><span class="w"></span><span class="kt">string</span><span class="w"></span><span class="n">AntiXsrfTokenKey</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="s">&quot;__AntiXsrfToken&quot;</span><span class="p">;</span>
<span class="k">private</span><span class="w"></span><span class="k">const</span><span class="w"></span><span class="kt">string</span><span class="w"></span><span class="n">AntiXsrfUserNameKey</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="s">&quot;__AntiXsrfUserName&quot;</span><span class="p">;</span>
<span class="k">private</span><span class="w"></span><span class="kt">string</span><span class="w"></span><span class="n">_antiXsrfTokenValue</span><span class="p">;</span>
<span class="k">protected</span><span class="w"></span><span class="k">void</span><span class="w"></span><span class="nf">Page_Init</span><span class="p">(</span><span class="kt">object</span><span class="w"></span><span class="n">sender</span><span class="p">,</span><span class="w"></span><span class="n">EventArgs</span><span class="w"></span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w"></span><span class="c1">//ThecodebelowhelpstoprotectagainstXSRFattacks</span>
<span class="w"></span><span class="kt">var</span><span class="w"></span><span class="n">requestCookie</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">Request</span><span class="p">.</span><span class="n">Cookies</span><span class="p">[</span><span class="n">AntiXsrfTokenKey</span><span class="p">];</span>
<span class="w"></span><span class="n">Guid</span><span class="w"></span><span class="n">requestCookieGuidValue</span><span class="p">;</span>
<span class="w"></span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">requestCookie</span><span class="w"></span><span class="o">!=</span><span class="w"></span><span class="k">null</span><span class="w"></span><span class="o">&amp;&amp;</span><span class="w"></span><span class="n">Guid</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">requestCookie</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span><span class="w"></span><span class="k">out</span><span class="w"></span><span class="n">requestCookieGuidValue</span><span class="p">))</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="c1">//UsetheAnti-XSRFtokenfromthecookie</span>
<span class="w"></span><span class="n">_antiXsrfTokenValue</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">requestCookie</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
<span class="w"></span><span class="n">Page</span><span class="p">.</span><span class="n">ViewStateUserKey</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">_antiXsrfTokenValue</span><span class="p">;</span>
<span class="w"></span><span class="p">}</span>
<span class="w"></span><span class="k">else</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="c1">//GenerateanewAnti-XSRFtokenandsavetothecookie</span>
<span class="w"></span><span class="n">_antiXsrfTokenValue</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">Guid</span><span class="p">.</span><span class="n">NewGuid</span><span class="p">().</span><span class="n">ToString</span><span class="p">(</span><span class="s">&quot;N&quot;</span><span class="p">);</span>
<span class="w"></span><span class="n">Page</span><span class="p">.</span><span class="n">ViewStateUserKey</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">_antiXsrfTokenValue</span><span class="p">;</span>
<span class="w"></span><span class="kt">var</span><span class="w"></span><span class="n">responseCookie</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">new</span><span class="w"></span><span class="n">HttpCookie</span><span class="p">(</span><span class="n">AntiXsrfTokenKey</span><span class="p">)</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="n">HttpOnly</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">true</span><span class="p">,</span>
<span class="w"></span><span class="n">Value</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">_antiXsrfTokenValue</span>
<span class="w"></span><span class="p">};</span>
<span class="w"></span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="n">FormsAuthentication</span><span class="p">.</span><span class="n">RequireSSL</span><span class="w"></span><span class="o">&amp;&amp;</span><span class="w"></span><span class="n">Request</span><span class="p">.</span><span class="n">IsSecureConnection</span><span class="p">)</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="n">responseCookie</span><span class="p">.</span><span class="n">Secure</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="k">true</span><span class="p">;</span>
<span class="w"></span><span class="p">}</span>
<span class="w"></span><span class="n">Response</span><span class="p">.</span><span class="n">Cookies</span><span class="p">.</span><span class="n">Set</span><span class="p">(</span><span class="n">responseCookie</span><span class="p">);</span>
<span class="w"></span><span class="p">}</span>
<span class="w"></span><span class="n">Page</span><span class="p">.</span><span class="n">PreLoad</span><span class="w"></span><span class="o">+=</span><span class="w"></span><span class="n">master_Page_PreLoad</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">protected</span><span class="w"></span><span class="k">void</span><span class="w"></span><span class="nf">master_Page_PreLoad</span><span class="p">(</span><span class="kt">object</span><span class="w"></span><span class="n">sender</span><span class="p">,</span><span class="w"></span><span class="n">EventArgs</span><span class="w"></span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w"></span><span class="k">if</span><span class="w"></span><span class="p">(</span><span class="o">!</span><span class="n">IsPostBack</span><span class="p">)</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="c1">//SetAnti-XSRFtoken</span>
<span class="w"></span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfTokenKey</span><span class="p">]</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">Page</span><span class="p">.</span><span class="n">ViewStateUserKey</span><span class="p">;</span>
<span class="w"></span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfUserNameKey</span><span class="p">]</span><span class="w"></span><span class="o">=</span><span class="w"></span><span class="n">Context</span><span class="p">.</span><span class="n">User</span><span class="p">.</span><span class="n">Identity</span><span class="p">.</span><span class="n">Name</span><span class="w"></span><span class="o">??</span><span class="w"></span><span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
<span class="w"></span><span class="p">}</span>
<span class="w"></span><span class="k">else</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="c1">//ValidatetheAnti-XSRFtoken</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="kt">string</span><span class="p">)</span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfTokenKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_antiXsrfTokenValue</span><span class="w"> </span><span class="o">||</span>
<span class="w"></span><span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfUserNameKey</span><span class="p">]</span><span class="w"></span><span class="o">!=</span><span class="w"></span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="n">User</span><span class="p">.</span><span class="n">Identity</span><span class="p">.</span><span class="n">Name</span><span class="w"></span><span class="o">??</span><span class="w"></span><span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">))</span>
<span class="w"></span><span class="p">{</span>
<span class="w"></span><span class="k">throw</span><span class="w"></span><span class="k">new</span><span class="w"></span><span class="n">InvalidOperationException</span><span class="p">(</span><span class="s">&quot;ValidationofAnti-XSRFtokenfailed.&quot;</span><span class="p">);</span>
<span class="w"></span><span class="p">}</span>
<span class="w"></span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Consider <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">HSTS</a> in IIS. See <a href="https://support.microsoft.com/en-us/help/954002/how-to-add-a-custom-http-response-header-to-a-web-site-that-is-hosted">here</a> for the procedure.</li>
<li>This is a recommended <code>web.config</code> setup that handles HSTS among other things.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="w"></span><span class="nt">&lt;configuration&gt;</span>
<span class="w"></span><span class="nt">&lt;system.web&gt;</span>
<span class="w"></span><span class="nt">&lt;httpRuntime</span><span class="w"> </span><span class="na">enableVersionHeader=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/system.web&gt;</span>
<span class="w"></span><span class="nt">&lt;system.webServer&gt;</span>
<span class="w"></span><span class="nt">&lt;security&gt;</span>
<span class="w"></span><span class="nt">&lt;requestFiltering</span><span class="w"> </span><span class="na">removeServerHeader=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/security&gt;</span>
<span class="w"></span><span class="nt">&lt;staticContent&gt;</span>
<span class="w"></span><span class="nt">&lt;clientCache</span><span class="w"> </span><span class="na">cacheControlCustom=</span><span class="s">&quot;public&quot;</span>
<span class="w">            </span><span class="na">cacheControlMode=</span><span class="s">&quot;UseMaxAge&quot;</span>
<span class="w">            </span><span class="na">cacheControlMaxAge=</span><span class="s">&quot;1.00:00:00&quot;</span>
<span class="w">            </span><span class="na">setEtag=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/staticContent&gt;</span>
<span class="w"></span><span class="nt">&lt;httpProtocol&gt;</span>
<span class="w"></span><span class="nt">&lt;customHeaders&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Content-Security-Policy&quot;</span>
<span class="w">            </span><span class="na">value=</span><span class="s">&quot;default-src &#39;none&#39;; style-src &#39;self&#39;; img-src &#39;self&#39;; font-src &#39;self&#39;&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Content-Type-Options&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;NOSNIFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Frame-Options&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;DENY&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Permitted-Cross-Domain-Policies&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;master-only&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-XSS-Protection&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;remove</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Powered-By&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/customHeaders&gt;</span>
<span class="w"></span><span class="nt">&lt;/httpProtocol&gt;</span>
<span class="w"></span><span class="nt">&lt;rewrite&gt;</span>
<span class="w"></span><span class="nt">&lt;rules&gt;</span>
<span class="w"></span><span class="nt">&lt;rule</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Redirect to https&quot;</span><span class="nt">&gt;</span>
<span class="w"></span><span class="nt">&lt;match</span><span class="w"> </span><span class="na">url=</span><span class="s">&quot;(.*)&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;conditions&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">input=</span><span class="s">&quot;{HTTPS}&quot;</span><span class="w"> </span><span class="na">pattern=</span><span class="s">&quot;Off&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">input=</span><span class="s">&quot;{REQUEST_METHOD}&quot;</span><span class="w"> </span><span class="na">pattern=</span><span class="s">&quot;^get$|^head$&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/conditions&gt;</span>
<span class="w"></span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Redirect&quot;</span><span class="w"> </span><span class="na">url=</span><span class="s">&quot;https://{HTTP_HOST}/{R:1}&quot;</span><span class="w"> </span><span class="na">redirectType=</span><span class="s">&quot;Permanent&quot;</span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/rule&gt;</span>
<span class="w"></span><span class="nt">&lt;/rules&gt;</span>
<span class="w"></span><span class="nt">&lt;outboundRules&gt;</span>
<span class="w"></span><span class="nt">&lt;rule</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Add HSTS Header&quot;</span><span class="w"> </span><span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w"></span><span class="nt">&lt;match</span><span class="w"> </span><span class="na">serverVariable=</span><span class="s">&quot;RESPONSE_Strict_Transport_Security&quot;</span><span class="w"> </span><span class="na">pattern=</span><span class="s">&quot;.*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;conditions&gt;</span>
<span class="w"></span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">input=</span><span class="s">&quot;{HTTPS}&quot;</span><span class="w"> </span><span class="na">pattern=</span><span class="s">&quot;on&quot;</span><span class="w"> </span><span class="na">ignoreCase=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/conditions&gt;</span>
<span class="w"></span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Rewrite&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;max-age=15768000&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w"></span><span class="nt">&lt;/rule&gt;</span>
<span class="w"></span><span class="nt">&lt;/outboundRules&gt;</span>
<span class="w"></span><span class="nt">&lt;/rewrite&gt;</span>
<span class="w"></span><span class="nt">&lt;/system.webServer&gt;</span>
<span class="w"></span><span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>
<ul>
<li>Remove the version header by adding the following line in <code>Machine.config</code> file:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;httpRuntime</span><span class="w"> </span><span class="na">enableVersionHeader=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
<ul>
<li>Also remove the Server header using the HttpContext Class in your code.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">HttpContext</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="s">&quot;Server&quot;</span><span class="p">);</span>
</code></pre></div>
<h3 id="http-validation-and-encoding">HTTP validation and encoding<a class="headerlink" href="#http-validation-and-encoding" title="Permanent link">&para;</a></h3>
<ul>
<li>Do not disable <a href="http://www.asp.net/whitepapers/request-validation">validateRequest</a> in the <code>web.config</code> or the page setup. This value enables limited XSS protection in ASP.NET and should be left intact as it provides partial prevention of Cross Site Scripting. Complete request validation is recommended in addition to the built-in protections.</li>
<li>The 4.5 version of the .NET Frameworks includes the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.antixss.antixssencoder?view=netframework-4.7.2">AntiXssEncoder</a> library, which has a comprehensive input encoding library for the prevention of XSS. Use it.</li>
<li>List allowable values anytime user input is accepted.</li>
<li>Validate the format of URIs using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.uri.iswellformeduristring">Uri.IsWellFormedUriString</a>.</li>
</ul>
<h3 id="forms-authentication">Forms authentication<a class="headerlink" href="#forms-authentication" title="Permanent link">&para;</a></h3>
<ul>
<li>Use cookies for persistence when possible. <code>Cookieless</code> auth will default to <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookiemode?view=netframework-4.7.2">UseDeviceProfile</a>.</li>
<li>Don't trust the URI of the request for persistence of the session or authorization. It can be easily faked.</li>
<li>Reduce the Forms Authentication timeout from the default of <em>20 minutes</em> to the shortest period appropriate for your application. If <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.slidingexpiration?view=netframework-4.7.2">slidingExpiration</a> is used this timeout resets after each request, so active users won't be affected.</li>
<li>If HTTPS is not used, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.slidingexpiration?view=netframework-4.7.2">slidingExpiration</a> should be disabled. Consider disabling <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.slidingexpiration?view=netframework-4.7.2">slidingExpiration</a> even with HTTPS.</li>
<li>Always implement proper access controls.<ul>
<li>Compare user provided username with <code>User.Identity.Name</code>.</li>
<li>Check roles against <code>User.Identity.IsInRole</code>.</li>
</ul>
</li>
<li>Use the <a href="https://docs.microsoft.com/en-us/dotnet/framework/wcf/samples/membership-and-role-provider">ASP.NET Membership provider and role provider</a>, but review the password storage. The default storage hashes the password with a single iteration of SHA-1 which is rather weak. The ASP.NET MVC4 template uses <a href="http://www.asp.net/identity/overview/getting-started/introduction-to-aspnet-identity">ASP.NET Identity</a> instead of ASP.NET Membership, and ASP.NET Identity uses PBKDF2 by default which is better. Review the OWASP <a href="Password_Storage_Cheat_Sheet.html">Password Storage Cheat Sheet</a> for more information.</li>
<li>Explicitly authorize resource requests.</li>
<li>Leverage role based authorization using <code>User.Identity.IsInRole</code>.</li>
</ul>
<h2 id="xaml-guidance">XAML Guidance<a class="headerlink" href="#xaml-guidance" title="Permanent link">&para;</a></h2>
<ul>
<li>Work within the constraints of Internet Zone security for your application.</li>
<li>Use ClickOnce deployment. For enhanced permissions, use permission elevation at runtime or trusted application deployment at install time.</li>
</ul>
<h2 id="windows-forms-guidance">Windows Forms Guidance<a class="headerlink" href="#windows-forms-guidance" title="Permanent link">&para;</a></h2>
<ul>
<li>Use partial trust when possible. Partially trusted Windows applications reduce the attack surface of an application. Manage a list of what permissions your app must use, and what it may use, and then make the request for those permissions declaratively at runtime.</li>
<li>Use ClickOnce deployment. For enhanced permissions, use permission elevation at runtime or trusted application deployment at install time.</li>
</ul>
<h2 id="wcf-guidance">WCF Guidance<a class="headerlink" href="#wcf-guidance" title="Permanent link">&para;</a></h2>
<ul>
<li>Keep in mind that the only safe way to pass a request in RESTful services is via <code>HTTP POST</code>, with TLS enabled.
Using <code>HTTP GET</code> necessitates putting the data in the URL (e.g. the query string) which is visible to the user and will
be logged and stored in their browser history.</li>
<li>Avoid <a href="https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.basichttpbinding?view=netframework-4.7.2">BasicHttpBinding</a>. It has no default security configuration. Use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.wshttpbinding?view=netframework-4.7.2">WSHttpBinding</a> instead.</li>
<li>Use at least two security modes for your binding. Message security includes security provisions in the headers. Transport security means use of SSL. <a href="https://docs.microsoft.com/en-us/dotnet/framework/wcf/samples/ws-transport-with-message-credential">TransportWithMessageCredential</a> combines the two.</li>
<li>Test your WCF implementation with a fuzzer like <a href="https://www.zaproxy.org/">ZAP</a>.</li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>