
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/Kubernetes_Security_Cheat_Sheet.html">
      
      
        <link rel="prev" href="Key_Management_Cheat_Sheet.html">
      
      
        <link rel="next" href="LDAP_Injection_Prevention_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Kubernetes Security - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetes-security-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kubernetes Security
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Alphabetical
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index ASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index MASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Proactive Controls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Top 10
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Browser_Extension_Vulnerabilities_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Extension Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C-Based Toolchain Hardening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-Site Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DotNet Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Kubernetes Security
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Kubernetes Security
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#receive-alerts-for-security-updates-and-reporting-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Receive Alerts for Security Updates and Reporting Vulnerabilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-what-is-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      INTRODUCTION: What Is Kubernetes?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="INTRODUCTION: What Is Kubernetes?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#control-plane-components" class="md-nav__link">
    <span class="md-ellipsis">
      Control Plane Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-components" class="md-nav__link">
    <span class="md-ellipsis">
      Node Components
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-1-securing-kubernetes-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 1: Securing Kubernetes Hosts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 1: Securing Kubernetes Hosts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Updating Kubernetes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-schedule-for-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Release schedule for Kubernetes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2-securing-kubernetes-components" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 2: Securing Kubernetes Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 2: Securing Kubernetes Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#securing-the-kubernetes-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Securing the Kubernetes Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restricting-access-to-etcd-important" class="md-nav__link">
    <span class="md-ellipsis">
      Restricting Access To etcd (IMPORTANT)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Restricting Access To etcd (IMPORTANT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limiting-access-to-the-primary-etcd-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting access to the primary etcd instance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-network-access-to-sensitive-ports" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling Network Access to Sensitive Ports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-access-to-the-kubernetes-api" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling Access To The Kubernetes API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Controlling Access To The Kubernetes API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-kubernetes-handles-api-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      How Kubernetes handles API authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-api-authentication-for-kubernetes-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      External API Authentication for Kubernetes (RECOMMENDED)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-for-kubernetes-built-in-api-authentication-not-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Options for Kubernetes Built-In API Authentication (NOT RECOMMENDED)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-role-based-access-control-in-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Role-Based Access Control in Kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-access-to-the-kubelets" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting access to the Kubelets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3-kubernetes-security-best-practices-build-phase" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 3: Kubernetes Security Best Practices: Build Phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 3: Kubernetes Security Best Practices: Build Phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-a-container-image" class="md-nav__link">
    <span class="md-ellipsis">
      What is a container image?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What is a container image?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ensure-that-cis-are-up-to-date" class="md-nav__link">
    <span class="md-ellipsis">
      Ensure that CIs are up to date
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-use-authorized-images-in-your-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Only use authorized images in Your environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-ci-pipeline-to-control-and-identify-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Use A CI Pipeline To Control and Identify Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimize-features-in-all-cis" class="md-nav__link">
    <span class="md-ellipsis">
      Minimize Features in All CIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Minimize Features in All CIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-distroless-or-empty-images-when-possible" class="md-nav__link">
    <span class="md-ellipsis">
      Use distroless or empty images when possible
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4-kubernetes-security-best-practices-deploy-phase" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 4: Kubernetes Security Best Practices: Deploy Phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 4: Kubernetes Security Best Practices: Deploy Phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-that-uses-namespaces-to-isolate-kubernetes-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Code that uses namespaces to isolate Kubernetes resources
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code that uses namespaces to isolate Kubernetes resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-the-namespace-for-a-request" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the namespace for a request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-the-namespace-preference" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the namespace preference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-the-imagepolicywebhook-to-govern-image-provenance" class="md-nav__link">
    <span class="md-ellipsis">
      Use the ImagePolicyWebhook to govern image provenance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-continuous-security-vulnerability-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Implement continuous security vulnerability scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply-security-context-to-your-pods-and-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Apply security context to your pods and containers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Apply security context to your pods and containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-context-example-a-pod-definition-that-includes-security-context-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Security context example: A pod definition that includes security context parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuously-assess-the-privileges-used-by-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Continuously assess the privileges used by containers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Continuously assess the privileges used by containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilize-pod-security-standards-and-the-built-in-pod-security-admission-controller-to-enforce-container-privilege-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Utilize Pod Security Standards and the Built-in Pod Security Admission Controller to enforce container privilege levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-pod-security-policies-to-control-the-security-related-attributes-of-pods-which-includes-container-privilege-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Use Pod security policies to control the security-related attributes of pods, which includes container privilege levels
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#providing-extra-security-with-a-service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Providing extra security with a service mesh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Providing extra security with a service mesh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advantages-of-a-service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Advantages of a service mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disadvantages-of-the-security-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Disadvantages of the security mesh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-centralized-policy-management" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing centralized policy management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing centralized policy management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#most-common-use-cases-of-opa" class="md-nav__link">
    <span class="md-ellipsis">
      Most common use cases of OPA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Most common use cases of OPA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opa-for-application-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      OPA for application authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opa-for-kubernetes-admission-control" class="md-nav__link">
    <span class="md-ellipsis">
      OPA for Kubernetes admission control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opa-for-service-mesh-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      OPA for service mesh authorization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-resource-usage-on-a-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting resource usage on a cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-kubernetes-network-policies-to-control-traffic-between-pods-and-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Use Kubernetes network policies to control traffic between pods and clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Securing data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Securing data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-secrets-as-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Keep secrets as secrets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypt-secrets-at-rest" class="md-nav__link">
    <span class="md-ellipsis">
      Encrypt secrets at rest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternatives-to-kubernetes-secret-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Alternatives to Kubernetes Secret resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-exposed-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Finding exposed secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5-kubernetes-security-best-practices-runtime-phase" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 5: Kubernetes Security Best Practices: Runtime Phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 5: Kubernetes Security Best Practices: Runtime Phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-pod-security-admission-to-prevent-risky-containerspods-from-being-deployed" class="md-nav__link">
    <span class="md-ellipsis">
      Use Pod Security Admission to prevent risky containers/Pods from being deployed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-runtime-security" class="md-nav__link">
    <span class="md-ellipsis">
      Container Runtime Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-sandboxing" class="md-nav__link">
    <span class="md-ellipsis">
      Container Sandboxing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-containers-from-loading-unwanted-kernel-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing containers from loading unwanted kernel modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-and-analyze-different-runtime-activity-in-pods-of-the-same-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      Compare and analyze different runtime activity in pods of the same deployments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-network-traffic-to-limit-unnecessary-or-insecure-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor network traffic to limit unnecessary or insecure communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-breached-scale-suspicious-pods-to-zero" class="md-nav__link">
    <span class="md-ellipsis">
      If breached, scale suspicious pods to zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rotate-infrastructure-credentials-frequently" class="md-nav__link">
    <span class="md-ellipsis">
      Rotate infrastructure credentials frequently
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Enable audit logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enable audit logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#audit-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Audit logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-audit-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Define Audit Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Container logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Node logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster logging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      Events
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5-final-thoughts" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 5: Final Thoughts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 5: Final Thoughts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#embed-security-into-the-container-lifecycle-as-early-as-possible" class="md-nav__link">
    <span class="md-ellipsis">
      Embed security into the container lifecycle as early as possible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-kubernetes-native-security-controls-to-reduce-operational-risk" class="md-nav__link">
    <span class="md-ellipsis">
      Use Kubernetes-native security controls to reduce operational risk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leverage-the-context-that-kubernetes-provides-to-prioritize-remediation-efforts" class="md-nav__link">
    <span class="md-ellipsis">
      Leverage the context that Kubernetes provides to prioritize remediation efforts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Legacy_Application_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legacy Application Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodejs Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#receive-alerts-for-security-updates-and-reporting-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Receive Alerts for Security Updates and Reporting Vulnerabilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-what-is-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      INTRODUCTION: What Is Kubernetes?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="INTRODUCTION: What Is Kubernetes?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#control-plane-components" class="md-nav__link">
    <span class="md-ellipsis">
      Control Plane Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-components" class="md-nav__link">
    <span class="md-ellipsis">
      Node Components
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-1-securing-kubernetes-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 1: Securing Kubernetes Hosts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 1: Securing Kubernetes Hosts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Updating Kubernetes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-schedule-for-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Release schedule for Kubernetes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2-securing-kubernetes-components" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 2: Securing Kubernetes Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 2: Securing Kubernetes Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#securing-the-kubernetes-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Securing the Kubernetes Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restricting-access-to-etcd-important" class="md-nav__link">
    <span class="md-ellipsis">
      Restricting Access To etcd (IMPORTANT)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Restricting Access To etcd (IMPORTANT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limiting-access-to-the-primary-etcd-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting access to the primary etcd instance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-network-access-to-sensitive-ports" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling Network Access to Sensitive Ports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-access-to-the-kubernetes-api" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling Access To The Kubernetes API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Controlling Access To The Kubernetes API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-kubernetes-handles-api-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      How Kubernetes handles API authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-api-authentication-for-kubernetes-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      External API Authentication for Kubernetes (RECOMMENDED)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-for-kubernetes-built-in-api-authentication-not-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Options for Kubernetes Built-In API Authentication (NOT RECOMMENDED)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-role-based-access-control-in-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Role-Based Access Control in Kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-access-to-the-kubelets" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting access to the Kubelets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3-kubernetes-security-best-practices-build-phase" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 3: Kubernetes Security Best Practices: Build Phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 3: Kubernetes Security Best Practices: Build Phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-a-container-image" class="md-nav__link">
    <span class="md-ellipsis">
      What is a container image?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What is a container image?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ensure-that-cis-are-up-to-date" class="md-nav__link">
    <span class="md-ellipsis">
      Ensure that CIs are up to date
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-use-authorized-images-in-your-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Only use authorized images in Your environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-ci-pipeline-to-control-and-identify-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Use A CI Pipeline To Control and Identify Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimize-features-in-all-cis" class="md-nav__link">
    <span class="md-ellipsis">
      Minimize Features in All CIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Minimize Features in All CIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-distroless-or-empty-images-when-possible" class="md-nav__link">
    <span class="md-ellipsis">
      Use distroless or empty images when possible
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4-kubernetes-security-best-practices-deploy-phase" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 4: Kubernetes Security Best Practices: Deploy Phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 4: Kubernetes Security Best Practices: Deploy Phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-that-uses-namespaces-to-isolate-kubernetes-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Code that uses namespaces to isolate Kubernetes resources
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code that uses namespaces to isolate Kubernetes resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-the-namespace-for-a-request" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the namespace for a request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-the-namespace-preference" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the namespace preference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-the-imagepolicywebhook-to-govern-image-provenance" class="md-nav__link">
    <span class="md-ellipsis">
      Use the ImagePolicyWebhook to govern image provenance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-continuous-security-vulnerability-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Implement continuous security vulnerability scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply-security-context-to-your-pods-and-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Apply security context to your pods and containers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Apply security context to your pods and containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-context-example-a-pod-definition-that-includes-security-context-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Security context example: A pod definition that includes security context parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuously-assess-the-privileges-used-by-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Continuously assess the privileges used by containers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Continuously assess the privileges used by containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilize-pod-security-standards-and-the-built-in-pod-security-admission-controller-to-enforce-container-privilege-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Utilize Pod Security Standards and the Built-in Pod Security Admission Controller to enforce container privilege levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-pod-security-policies-to-control-the-security-related-attributes-of-pods-which-includes-container-privilege-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Use Pod security policies to control the security-related attributes of pods, which includes container privilege levels
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#providing-extra-security-with-a-service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Providing extra security with a service mesh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Providing extra security with a service mesh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advantages-of-a-service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Advantages of a service mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disadvantages-of-the-security-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Disadvantages of the security mesh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-centralized-policy-management" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing centralized policy management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing centralized policy management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#most-common-use-cases-of-opa" class="md-nav__link">
    <span class="md-ellipsis">
      Most common use cases of OPA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Most common use cases of OPA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opa-for-application-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      OPA for application authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opa-for-kubernetes-admission-control" class="md-nav__link">
    <span class="md-ellipsis">
      OPA for Kubernetes admission control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opa-for-service-mesh-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      OPA for service mesh authorization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-resource-usage-on-a-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting resource usage on a cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-kubernetes-network-policies-to-control-traffic-between-pods-and-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Use Kubernetes network policies to control traffic between pods and clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Securing data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Securing data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-secrets-as-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Keep secrets as secrets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypt-secrets-at-rest" class="md-nav__link">
    <span class="md-ellipsis">
      Encrypt secrets at rest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternatives-to-kubernetes-secret-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Alternatives to Kubernetes Secret resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-exposed-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Finding exposed secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5-kubernetes-security-best-practices-runtime-phase" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 5: Kubernetes Security Best Practices: Runtime Phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 5: Kubernetes Security Best Practices: Runtime Phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-pod-security-admission-to-prevent-risky-containerspods-from-being-deployed" class="md-nav__link">
    <span class="md-ellipsis">
      Use Pod Security Admission to prevent risky containers/Pods from being deployed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-runtime-security" class="md-nav__link">
    <span class="md-ellipsis">
      Container Runtime Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-sandboxing" class="md-nav__link">
    <span class="md-ellipsis">
      Container Sandboxing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-containers-from-loading-unwanted-kernel-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing containers from loading unwanted kernel modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-and-analyze-different-runtime-activity-in-pods-of-the-same-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      Compare and analyze different runtime activity in pods of the same deployments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-network-traffic-to-limit-unnecessary-or-insecure-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor network traffic to limit unnecessary or insecure communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-breached-scale-suspicious-pods-to-zero" class="md-nav__link">
    <span class="md-ellipsis">
      If breached, scale suspicious pods to zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rotate-infrastructure-credentials-frequently" class="md-nav__link">
    <span class="md-ellipsis">
      Rotate infrastructure credentials frequently
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Enable audit logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enable audit logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#audit-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Audit logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-audit-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Define Audit Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Container logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Node logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster logging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      Events
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5-final-thoughts" class="md-nav__link">
    <span class="md-ellipsis">
      SECTION 5: Final Thoughts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SECTION 5: Final Thoughts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#embed-security-into-the-container-lifecycle-as-early-as-possible" class="md-nav__link">
    <span class="md-ellipsis">
      Embed security into the container lifecycle as early as possible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-kubernetes-native-security-controls-to-reduce-operational-risk" class="md-nav__link">
    <span class="md-ellipsis">
      Use Kubernetes-native security controls to reduce operational risk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leverage-the-context-that-kubernetes-provides-to-prioritize-remediation-efforts" class="md-nav__link">
    <span class="md-ellipsis">
      Leverage the context that Kubernetes provides to prioritize remediation efforts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="kubernetes-security-cheat-sheet">Kubernetes Security Cheat Sheet<a class="headerlink" href="#kubernetes-security-cheat-sheet" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>This cheat sheet provides a starting point for securing a Kubernetes cluster. It is divided into the following categories:</p>
<ul>
<li>Receive Alerts for Kubernetes Updates</li>
<li>INTRODUCTION: What is Kubernetes?</li>
<li>Securing Kubernetes hosts</li>
<li>Securing Kubernetes components</li>
<li>Using the Kubernetes dashboard</li>
<li>Kubernetes Security Best Practices: Build Phase</li>
<li>Kubernetes Security Best Practices: Deploy Phase</li>
<li>Kubernetes Security Best Practices: Runtime Phase</li>
</ul>
<p>For more information about Kubernetes, refer to the Appendix.</p>
<h2 id="receive-alerts-for-security-updates-and-reporting-vulnerabilities">Receive Alerts for Security Updates and Reporting Vulnerabilities<a class="headerlink" href="#receive-alerts-for-security-updates-and-reporting-vulnerabilities" title="Permanent link">&para;</a></h2>
<p>Join the kubernetes-announce group (<a href="https://kubernetes.io/docs/reference/issues-security/security/">https://kubernetes.io/docs/reference/issues-security/security/</a>) for emails about security announcements. See the security reporting page (<a href="https://kubernetes.io/docs/reference/issues-security/security">https://kubernetes.io/docs/reference/issues-security/security</a>) for more on how to report vulnerabilities.</p>
<h2 id="introduction-what-is-kubernetes">INTRODUCTION: What Is Kubernetes?<a class="headerlink" href="#introduction-what-is-kubernetes" title="Permanent link">&para;</a></h2>
<p>Kubernetes is an open source container orchestration engine for automating deployment, scaling, and management of containerized applications. The open source project is hosted by the Cloud Native Computing Foundation (CNCF).</p>
<p>When you deploy Kubernetes, you get a cluster. A Kubernetes cluster consists of a set of worker machines, called nodes that run containerized applications. The control plane manages the worker nodes and the Pods in the cluster.</p>
<h3 id="control-plane-components">Control Plane Components<a class="headerlink" href="#control-plane-components" title="Permanent link">&para;</a></h3>
<p>The control plane's components make global decisions about the cluster, as well as detecting and responding to cluster events. It consists of components such as kube-apiserver, etcd, kube-scheduler, kube-controller-manager and cloud-controller-manager.</p>
<p><strong>Component:</strong> kube-apiserver<br />
<strong>Description:</strong> Exposes the Kubernetes API. The API server is the front end for the Kubernetes control plane.</p>
<p><strong>Component:</strong> etcd<br />
<strong>Description:</strong> A consistent and highly-available key-value store used as Kubernetes' backing store for all cluster data.</p>
<p><strong>Component:</strong> kube-scheduler<br />
<strong>Description:</strong> Watches for newly created Pods with no assigned node, and selects a node for them to run on.</p>
<p><strong>Component:</strong> kube-controller-manager<br />
<strong>Description:</strong> Runs controller processes. Logically, each controller is a separate process, but to reduce complexity, they are all compiled into a single binary and run in a single process.</p>
<p><strong>Component:</strong> cloud-controller-manager<br />
<strong>Description:</strong> The cloud controller manager lets you link your cluster into your cloud provider's API, and separates out the components that interact with that cloud platform from components that just interact with your cluster.</p>
<h3 id="node-components">Node Components<a class="headerlink" href="#node-components" title="Permanent link">&para;</a></h3>
<p>Node components run on every node, maintaining running pods and providing the Kubernetes runtime environment. It consists of components such as kubelet, kube-proxy and container runtime.</p>
<p><strong>Component:</strong> kubelet<br />
<strong>Description:</strong> An agent that runs on each node in the cluster. It makes sure that containers are running in a Pod.</p>
<p><strong>Component:</strong> kube-proxy<br />
<strong>Description:</strong> A network proxy that runs on each node in your cluster, implementing part of the Kubernetes Service concept.</p>
<p><strong>Container:</strong> runtime<br />
<strong>Description:</strong> The container runtime is the software that is responsible for running containers |</p>
<h2 id="section-1-securing-kubernetes-hosts">SECTION 1: Securing Kubernetes Hosts<a class="headerlink" href="#section-1-securing-kubernetes-hosts" title="Permanent link">&para;</a></h2>
<p>Kubernetes can be deployed in different ways: on bare metal, on-premise, and in the public cloud (a custom Kubernetes build on virtual machines OR use a managed service). Since Kubernetes is designed to be highly portable, customers can easily and migrate their workloads and switch between multiple installations.</p>
<p>Because Kubernetes can be designed to fit a large variety of scenarios, this flexibility is a weakness when it comes to securing Kubernetes clusters. The engineers responsible for deploying the Kubernetes platform must know about all the potential attack vectors and vulnerabilities for their clusters.</p>
<p>To harden the underlying hosts for Kubernetes clusters, we recommend that you install the latest version of the operating systems, harden the operating systems, implement necessary patch management and configuration management systems, implement essential firewall rules and undertake specific datacenter-based security measures.</p>
<h3 id="updating-kubernetes">Updating Kubernetes<a class="headerlink" href="#updating-kubernetes" title="Permanent link">&para;</a></h3>
<p>Since no one can track all potential attack vectors for your Kubernetes cluster, the first and best defense is to always run the latest stable version of Kubernetes.</p>
<p>In case vulnerabilities are found in running containers, it is recommended to always update the source image and redeploy the containers. <strong>Try to avoid direct updates to the running containers as this can break the image-container relationship.</strong></p>
<div class="highlight"><pre><span></span><code>Example: apt-update
</code></pre></div>
<p><strong>Upgrading containers is extremely easy with the Kubernetes rolling updates feature - this allows gradually updating a running application by upgrading its images to the latest version.</strong></p>
<h4 id="release-schedule-for-kubernetes">Release schedule for Kubernetes<a class="headerlink" href="#release-schedule-for-kubernetes" title="Permanent link">&para;</a></h4>
<p>The Kubernetes project maintains release branches for the most recent three minor releases and it backports the applicable fixes, including security fixes, to those three release branches, depending on severity and feasibility. Patch releases are cut from those branches at a regular cadence, plus additional urgent releases, when required. Hence it is always recommended to upgrade the Kubernetes cluster to the latest available stable version. It is recommended to refer to the version skew policy for further details <a href="https://kubernetes.io/docs/setup/release/version-skew-policy/">https://kubernetes.io/docs/setup/release/version-skew-policy/</a>.</p>
<p>There are several techniques such as rolling updates, and node pool migrations that allow you to complete an update with minimal disruption and downtime.</p>
<p>--</p>
<h2 id="section-2-securing-kubernetes-components">SECTION 2: Securing Kubernetes Components<a class="headerlink" href="#section-2-securing-kubernetes-components" title="Permanent link">&para;</a></h2>
<p>This section discusses how to secure Kubernetes components. It covers the following topics:</p>
<ul>
<li>Securing the Kubernetes Dashboard</li>
<li>Restricting access to etcd (Important)</li>
<li>Controlling network access to sensitive ports</li>
<li>Controlling access to the Kubernetes API</li>
<li>Implementing role-based access control in Kubernetes</li>
<li>Limiting access to Kubelets</li>
</ul>
<p>--</p>
<h3 id="securing-the-kubernetes-dashboard">Securing the Kubernetes Dashboard<a class="headerlink" href="#securing-the-kubernetes-dashboard" title="Permanent link">&para;</a></h3>
<p>The Kubernetes dashboard is a webapp for managing your cluster. It is not a part of the Kubernetes cluster itself, it has to be installed by the owners of the cluster. Thus, there are a lot of tutorials on how to do this. Unfortunately, most of them create a service account with very high privileges. This caused Tesla and some others to be hacked via such a poorly configured K8s dashboard. (Reference: Tesla cloud resources are hacked to run cryptocurrency-mining malware - <a href="https://arstechnica.com/information-technology/2018/02/tesla-cloud-resources-are-hacked-to-run-cryptocurrency-mining-malware/">https://arstechnica.com/information-technology/2018/02/tesla-cloud-resources-are-hacked-to-run-cryptocurrency-mining-malware/</a>)</p>
<p>To prevent attacks via the dashboard, you should follow some tips:</p>
<ul>
<li>Do not expose the dashboard without additional authentication to the public. There is no need to access such a powerful tool from outside your LAN</li>
<li>Turn on Role-Based Access Control (see below), so you can limit the service account the dashboard uses</li>
<li>Do not grant the service account of the dashboard high privileges</li>
<li>Grant permissions per user, so each user only can see what they are supposed to see</li>
<li>If you are using network policies, you can block requests to the dashboard even from internal pods (this will not affect the proxy tunnel via kubectl proxy)</li>
<li>Before version 1.8, the dashboard had a service account with full privileges, so check that there is no role binding for cluster-admin left.</li>
<li>Deploy the dashboard with an authenticating reverse proxy, with multi-factor authentication enabled. This can be done with either embedded OIDC <code>id_tokens</code> or using Kubernetes Impersonation. This allows you to use the dashboard with the user's credentials instead of using a privileged <code>ServiceAccount</code>. This method can be used on both on-prem and managed cloud clusters.</li>
</ul>
<p>--</p>
<h3 id="restricting-access-to-etcd-important">Restricting Access To etcd (IMPORTANT)<a class="headerlink" href="#restricting-access-to-etcd-important" title="Permanent link">&para;</a></h3>
<p>etcd is a critical Kubernetes component which stores information on states and secrets, and it should be protected differently from the rest of your cluster. Write access to the API server's etcd is equivalent to gaining root on the entire cluster, and even read access can be used to escalate privileges fairly easily.</p>
<p>The Kubernetes scheduler will search etcd for pod definitions that do not have a node. It then sends the pods it finds to an available kubelet for scheduling. Validation for submitted pods is performed by the API server before it writes them to etcd, so malicious users writing directly to etcd can bypass many security mechanisms - e.g. PodSecurityPolicies.</p>
<p>Administrators should always use strong credentials from the API servers to their etcd server, such as mutual auth via TLS client certificates, and it is often recommended to isolate the etcd servers behind a firewall that only the API servers may access.</p>
<h4 id="limiting-access-to-the-primary-etcd-instance">Limiting access to the primary etcd instance<a class="headerlink" href="#limiting-access-to-the-primary-etcd-instance" title="Permanent link">&para;</a></h4>
<p>Allowing other components within the cluster to access the primary etcd instance with read or write access to the full keyspace is equivalent to granting cluster-admin access. Using separate etcd instances for other components or using etcd ACLs to restrict read and write access to a subset of the keyspace is strongly recommended.</p>
<p>--</p>
<h3 id="controlling-network-access-to-sensitive-ports">Controlling Network Access to Sensitive Ports<a class="headerlink" href="#controlling-network-access-to-sensitive-ports" title="Permanent link">&para;</a></h3>
<p>It is highly recommended to configure authentication and authorization on the cluster and cluster nodes. Since Kubernetes clusters usually listen on a range of well-defined and distinctive ports, it is easier for attackers to identify the clusters and attack them.</p>
<p>An overview of the default ports used in Kubernetes is provided below. Make sure that your network blocks access to ports, and you should seriously consider limiting access to the Kubernetes API server to trusted networks.</p>
<p><strong>Control plane node(s):</strong></p>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Port Range</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>6443-</td>
<td>Kubernetes API Server</td>
</tr>
<tr>
<td>TCP</td>
<td>2379-2380</td>
<td>etcd server client API</td>
</tr>
<tr>
<td>TCP</td>
<td>10250</td>
<td>Kubelet API</td>
</tr>
<tr>
<td>TCP</td>
<td>10251</td>
<td>kube-scheduler</td>
</tr>
<tr>
<td>TCP</td>
<td>10252</td>
<td>kube-controller-manager</td>
</tr>
<tr>
<td>TCP</td>
<td>10255</td>
<td>Read-Only Kubelet API</td>
</tr>
</tbody>
</table>
<p><strong>Worker nodes:</strong></p>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Port Range</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>10250</td>
<td>Kubelet API</td>
</tr>
<tr>
<td>TCP</td>
<td>10255</td>
<td>Read-Only Kubelet API</td>
</tr>
<tr>
<td>TCP</td>
<td>30000-32767</td>
<td>NodePort Services</td>
</tr>
</tbody>
</table>
<p>--</p>
<h3 id="controlling-access-to-the-kubernetes-api">Controlling Access To The Kubernetes API<a class="headerlink" href="#controlling-access-to-the-kubernetes-api" title="Permanent link">&para;</a></h3>
<p>The first line of defense of Kubernetes against attackers is limiting and securing access to API requests, because those requests are used to control the Kubernetes platform. For more information, refer to the documentation at <a href="https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/">https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/</a>.</p>
<p>This part contains the following topics:</p>
<ul>
<li>How Kubernetes handles API authorization</li>
<li>External API Authentication for Kubernetes (recommended)</li>
<li>Kubernetes Built-In API Authentication (not recommended)</li>
<li>Implementing role-based access in Kubernetes</li>
<li>Limiting access to Kubelets</li>
</ul>
<p>--</p>
<h4 id="how-kubernetes-handles-api-authorization">How Kubernetes handles API authorization<a class="headerlink" href="#how-kubernetes-handles-api-authorization" title="Permanent link">&para;</a></h4>
<p>In Kubernetes, you must be authenticated (logged in) before your request can be authorized (granted permission to access), and Kubernetes expects attributes that are common to REST API requests. This means that existing organization-wide or cloud-provider-wide access control systems which may handle other APIs work with Kubernetes authorization.</p>
<p>When Kubernetes authorizes API requests using the API server, permissions are denied by default. It evaluates all of the request attributes against all policies and allows or denies the request. All parts of an API request must be allowed by some policy in order to proceed.</p>
<p>--</p>
<h4 id="external-api-authentication-for-kubernetes-recommended">External API Authentication for Kubernetes (RECOMMENDED)<a class="headerlink" href="#external-api-authentication-for-kubernetes-recommended" title="Permanent link">&para;</a></h4>
<p>Due to the weakness of Kubernetes' internal mechanisms for authenticating APIs, we strongly recommended that larger or production clusters use one of the external API authentication methods.</p>
<ul>
<li><a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#openid-connect-tokens">OpenID Connect</a> (OIDC) lets you externalize authentication, use short lived tokens, and leverage centralized groups for authorization.</li>
<li>Managed Kubernetes distributions such as GKE, EKS and AKS support authentication using credentials from their respective IAM providers.</li>
<li><a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#user-impersonation">Kubernetes Impersonation</a> can be used with both managed cloud clusters and on-prem clusters to externalize authentication without having to have access to the API server configuration parameters.</li>
</ul>
<p>In addition to choosing the appropriate authentication system, API access should be considered privileged and use Multi-Factor Authentication (MFA) for all user access.</p>
<p>For more information, consult Kubernetes authentication reference documentation at <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication">https://kubernetes.io/docs/reference/access-authn-authz/authentication</a>.</p>
<p>--</p>
<h4 id="options-for-kubernetes-built-in-api-authentication-not-recommended">Options for Kubernetes Built-In API Authentication (NOT RECOMMENDED)<a class="headerlink" href="#options-for-kubernetes-built-in-api-authentication-not-recommended" title="Permanent link">&para;</a></h4>
<p>Kubernetes provides a number of internal mechanisms for API server authentication but these are usually only suitable for non-production or small clusters. We will briefly discuss each internal mechanism and explain why you should not use them.</p>
<ul>
<li>
<p><a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#static-token-file">Static Token File</a>: Authentication makes use of clear text tokens stored in a CSV file on API server node(s). WARNING: You cannot modify credentials in this file until the API server is restarted.</p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#x509-client-certs">X509 Client Certs</a> are available but are unsuitable for production use, since Kubernetes does <a href="https://github.com/kubernetes/kubernetes/issues/18982">not support certificate revocation</a>. As a result, these user credentials cannot be modified or revoked without rotating the root certificate authority key and re-issuing all cluster certificates.</p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#service-account-tokens">Service Accounts Tokens</a> are also available for authentication. Their primary intended use is to allow workloads running in the cluster to authenticate to the API server, however they can also be used for user authentication.</p>
</li>
</ul>
<p>--</p>
<h3 id="implementing-role-based-access-control-in-kubernetes">Implementing Role-Based Access Control in Kubernetes<a class="headerlink" href="#implementing-role-based-access-control-in-kubernetes" title="Permanent link">&para;</a></h3>
<p>Role-based access control (RBAC) is a method for regulating access to computer or network resources based on the roles of individual users within your organization. Fortunately, Kubernetes comes with an integrated Role-Based Access Control (RBAC) component with default roles that allow you to define user responsibilities depending on what actions a client might want to perform. You should use the Node and RBAC authorizers together in combination with the NodeRestriction admission plugin.</p>
<p>The RBAC component matches an incoming user or group to a set of permissions linked to roles. These permissions combine verbs (get, create, delete) with resources (pods, services, nodes) and can be namespace or cluster scoped. RBAC authorization uses the rbac.authorization.k8s.io API group to drive authorization decisions, allowing you to dynamically configure policies through the Kubernetes API.</p>
<p>To enable RBAC, start the API server with the --authorization-mode flag set to a comma-separated list that includes RBAC; for example:</p>
<div class="highlight"><pre><span></span><code>kube-apiserver<span class="w"> </span>--authorization-mode<span class="o">=</span>Example,RBAC<span class="w"> </span>--other-options<span class="w"> </span>--more-options
</code></pre></div>
<p>For detailed examples of utilizing RBAC, refer to Kubernetes documentation at <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac">https://kubernetes.io/docs/reference/access-authn-authz/rbac</a></p>
<p>--</p>
<h3 id="limiting-access-to-the-kubelets">Limiting access to the Kubelets<a class="headerlink" href="#limiting-access-to-the-kubelets" title="Permanent link">&para;</a></h3>
<p>Kubelets expose HTTPS endpoints which grant powerful control over the node and containers. By default Kubelets allow unauthenticated access to this API. Production clusters should enable Kubelet authentication and authorization.</p>
<p>For more information, refer to Kubelet authentication/authorization documentation at <a href="https://kubernetes.io/docs/reference/access-authn-authz/kubelet-authn-authz/">https://kubernetes.io/docs/reference/access-authn-authz/kubelet-authn-authz/</a></p>
<p>--</p>
<h2 id="section-3-kubernetes-security-best-practices-build-phase">SECTION 3: Kubernetes Security Best Practices: Build Phase<a class="headerlink" href="#section-3-kubernetes-security-best-practices-build-phase" title="Permanent link">&para;</a></h2>
<p>During the build phase, you should secure your Kubernetes container images by building secure images and scanning those images for any known vulnerabilities.</p>
<p>--</p>
<h3 id="what-is-a-container-image">What is a container image?<a class="headerlink" href="#what-is-a-container-image" title="Permanent link">&para;</a></h3>
<p>A container image (CI) is an immutable, lightweight, standalone, executable package of software that includes everything needed to run an application: code, runtime, system tools, system libraries and settings [<a href="https://www.docker.com/resources/what-container">https://www.docker.com/resources/what-container</a>]. Each image shares the kernel of the operating system present in the host machine.</p>
<p>Your CIs must be built on a approved and secure base image. This base image must be scanned and monitored at regular intervals to ensure that all CIs are based on a secure and authentic image. Implement strong governance policies that determine how images are built and stored in trusted image registries.</p>
<p>--</p>
<h4 id="ensure-that-cis-are-up-to-date">Ensure that CIs are up to date<a class="headerlink" href="#ensure-that-cis-are-up-to-date" title="Permanent link">&para;</a></h4>
<p>Ensure your images (and any third-party tools you include) are up-to-date and use the latest versions of their components.</p>
<p>--</p>
<h3 id="only-use-authorized-images-in-your-environment">Only use authorized images in Your environment<a class="headerlink" href="#only-use-authorized-images-in-your-environment" title="Permanent link">&para;</a></h3>
<p>Downloading and running CIs from unknown sources is very dangerous. Make sure that only images adhering to the organization’s policy are allowed to run, or else the organization is open to risk of running vulnerable or even malicious containers.</p>
<p>--</p>
<h3 id="use-a-ci-pipeline-to-control-and-identify-vulnerabilities">Use A CI Pipeline To Control and Identify Vulnerabilities<a class="headerlink" href="#use-a-ci-pipeline-to-control-and-identify-vulnerabilities" title="Permanent link">&para;</a></h3>
<p>The Kubernetes container registry serves as a central repository of all container images in the system. Depending on your needs, you can utilize a public repository or have a private repository as the container registry. We recommend that you store your approved images in a private registry and only push approved images to these registries, which automatically reduces the number of potential images that enter your pipeline down to a fraction of the hundreds of thousands of publicly available images.</p>
<p>Also, we strongly recommend that you add a CI pipeline that integrates security assessment (like vulnerability scanning) into the build process. This pipeline should vet all code that is approved for production and is used to build the images. After an image is built, it should be scanned for security vulnerabilities. Only if no issues are found, then the image would be pushed to a private registry then deployed to production. If the security assessment mechanism fails any code, it should create a failure in the pipeline, which will help you find images with security problems and prevent them from entering the image registry.</p>
<p>Many source code repositories provide scanning capabilities (e.g. <a href="https://docs.github.com/en/code-security/supply-chain-security">Github</a>, <a href="https://docs.gitlab.com/ee/user/application_security/container_scanning/index.html">GitLab</a>), and many CI tools offer integration with open source vulnerability scanners such as <a href="https://github.com/aquasecurity/trivy">Trivy</a> or <a href="https://github.com/anchore/grype">Grype</a>.</p>
<p>Projects are developing image authorization plugins for Kubernetes that prevent unauthorized images from shipping. For more information, refer to the PR <a href="https://github.com/kubernetes/kubernetes/pull/27129">https://github.com/kubernetes/kubernetes/pull/27129</a>.</p>
<p>--</p>
<h3 id="minimize-features-in-all-cis">Minimize Features in All CIs<a class="headerlink" href="#minimize-features-in-all-cis" title="Permanent link">&para;</a></h3>
<p>As a best practice, Google and other tech giants have strictly limiting the code in their runtime container for years. This approach improves the signal-to-noise of scanners (e.g. CVE) and reduces the burden of establishing provenance to just what you need.</p>
<p>Consider using minimal CIs such as distroless images (see below). If this is not possible, do not include OS package managers or shells in CIs because they may have unknown vulnerabilities. If you absolutely must include any OS packages, remove the package manager at a later step in the generation process.</p>
<p>--</p>
<h4 id="use-distroless-or-empty-images-when-possible">Use distroless or empty images when possible<a class="headerlink" href="#use-distroless-or-empty-images-when-possible" title="Permanent link">&para;</a></h4>
<p>Distroless images sharply reduce the attack surface because they do not include shells and contain fewer packages than other images. For more information on distroless images, refer to <a href="https://github.com/GoogleContainerTools/distroless">https://github.com/GoogleContainerTools/distroless</a>.</p>
<p>An empty image, ideal for statically compiled languages like Go, because the image is empty - the attack surface it is truly minimal - only your code!</p>
<p>For more information, refer to <a href="https://hub.docker.com/_/scratch">https://hub.docker.com/_/scratch</a></p>
<hr />
<h2 id="section-4-kubernetes-security-best-practices-deploy-phase">SECTION 4: Kubernetes Security Best Practices: Deploy Phase<a class="headerlink" href="#section-4-kubernetes-security-best-practices-deploy-phase" title="Permanent link">&para;</a></h2>
<p>Once a Kubernetes infrastructure is in place, you must configure it securely before any workloads are deployed. And as you configure your infrastructure, ensure that you have visibility into what CIs are being deployed and how they are being deployed or else you will not be able to identify and respond to security policy violations. Before deployment, your system should know and be able to tell you:</p>
<ul>
<li><strong>What is being deployed</strong> - including information about the image being used, such as components or vulnerabilities, and the pods that will be deployed.</li>
<li><strong>Where it is going to be deployed</strong> - which clusters, namespaces, and nodes.</li>
<li><strong>How it is deployed</strong> - whether it runs privileged, what other deployments it can communicate with, the pod security context that is applied, if any.</li>
<li><strong>What it can access</strong> - including secrets, volumes, and other infrastructure components such as the host or orchestrator API.</li>
<li><strong>Is it compliant?</strong> - whether it complies with your policies and security requirements.</li>
</ul>
<p>--</p>
<h3 id="code-that-uses-namespaces-to-isolate-kubernetes-resources">Code that uses namespaces to isolate Kubernetes resources<a class="headerlink" href="#code-that-uses-namespaces-to-isolate-kubernetes-resources" title="Permanent link">&para;</a></h3>
<p>Namespaces give you the ability to create logical partitions, enforce separation of your resources and limit the scope of user permissions.</p>
<p>--</p>
<h4 id="setting-the-namespace-for-a-request">Setting the namespace for a request<a class="headerlink" href="#setting-the-namespace-for-a-request" title="Permanent link">&para;</a></h4>
<p>To set the namespace for a current request, use the --namespace flag. Refer to the following examples:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>run<span class="w"> </span>nginx<span class="w"> </span>--image<span class="o">=</span>nginx<span class="w"> </span>--namespace<span class="o">=</span>&lt;insert-namespace-name-here&gt;
kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--namespace<span class="o">=</span>&lt;insert-namespace-name-here&gt;
</code></pre></div>
<p>--</p>
<h4 id="setting-the-namespace-preference">Setting the namespace preference<a class="headerlink" href="#setting-the-namespace-preference" title="Permanent link">&para;</a></h4>
<p>You can permanently save the namespace for all subsequent kubectl commands in that context with:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>config<span class="w"> </span>set-context<span class="w"> </span>--current<span class="w"> </span>--namespace<span class="o">=</span>&lt;insert-namespace-name-here&gt;
</code></pre></div>
<p>Then validate it with the following command:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>config<span class="w"> </span>view<span class="w"> </span>--minify<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>namespace:
</code></pre></div>
<p>Learn more about namespaces at <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces">https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces</a></p>
<p>--</p>
<h3 id="use-the-imagepolicywebhook-to-govern-image-provenance">Use the ImagePolicyWebhook to govern image provenance<a class="headerlink" href="#use-the-imagepolicywebhook-to-govern-image-provenance" title="Permanent link">&para;</a></h3>
<p>We strongly recommend that you use the admission controller ImagePolicyWebhook to prevent unapproved images from being used, reject pods that use unapproved images, and refuse CIs that meet the following criteria:</p>
<ul>
<li>Images that haven’t been scanned recently</li>
<li>Images that use a base image that’s not explicitly allowed</li>
<li>Images from insecure registries</li>
</ul>
<p>Learn more about webhook at <a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#imagepolicywebhook">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#imagepolicywebhook</a></p>
<p>--</p>
<h3 id="implement-continuous-security-vulnerability-scanning">Implement continuous security vulnerability scanning<a class="headerlink" href="#implement-continuous-security-vulnerability-scanning" title="Permanent link">&para;</a></h3>
<p>Since new vulnerabilities are always being discovered, you may not always know if your containers may have recently-disclosed vulnerabilities (CVEs) or outdated packages. To maintain a strong security posture, do regular production scanning of first-party containers (applications you have built and previously scanned) as well as third-party containers (which are sourced from trusted repository and vendors).</p>
<p>Open Source projects such as <a href="https://github.com/deepfence/ThreatMapper">ThreatMapper</a> can assist in identifying and prioritizing vulnerabilities.</p>
<p>--</p>
<h3 id="apply-security-context-to-your-pods-and-containers">Apply security context to your pods and containers<a class="headerlink" href="#apply-security-context-to-your-pods-and-containers" title="Permanent link">&para;</a></h3>
<p>The security context is a property that is defined in the deployment yaml and controls the security parameters for all pod/container/volumes, and it should be applied throughout your infrastructure. When the security context property is properly implemented everywhere, it can eliminate entire classes of attacks that rely on privileged access. For example, any attack that depends on installing software or writing to the file system will be stopped if you specify read-only root file systems in the security context.</p>
<p>When you are configuring the security context for your pods, only grant the privileges that are needed for the resources to function in your containers and volumes. Some of the important parameters in the security context property are:</p>
<p>Security Context Settings:</p>
<ol>
<li>
<p>SecurityContext-&gt;<strong>runAsNonRoot</strong><br />
   Description: Indicates that containers should run as non-root user.</p>
</li>
<li>
<p>SecurityContext-&gt;<strong>Capabilities</strong><br />
   Description: Controls the Linux capabilities assigned to the container.</p>
</li>
<li>
<p>SecurityContext-&gt;<strong>readOnlyRootFilesystem</strong><br />
   Description: Controls whether a container will be able to write into the root filesystem.</p>
</li>
<li>
<p>PodSecurityContext-&gt;<strong>runAsNonRoot</strong><br />
   Description: Prevents running a container with 'root' user as part of the pod |</p>
</li>
</ol>
<h4 id="security-context-example-a-pod-definition-that-includes-security-context-parameters">Security context example: A pod definition that includes security context parameters<a class="headerlink" href="#security-context-example-a-pod-definition-that-includes-security-context-parameters" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>

<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-world</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># specification of the pod’s containers</span>
<span class="w">  </span><span class="c1"># ...</span>
<span class="w">  </span><span class="c1"># ...</span>
<span class="w">  </span><span class="c1"># Security Context</span>
<span class="w">  </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">    </span><span class="nt">readOnlyRootFilesystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p>For more information on security context for Pods, refer to the documentation at <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context">https://kubernetes.io/docs/tasks/configure-pod-container/security-context</a></p>
<p>--</p>
<h3 id="continuously-assess-the-privileges-used-by-containers">Continuously assess the privileges used by containers<a class="headerlink" href="#continuously-assess-the-privileges-used-by-containers" title="Permanent link">&para;</a></h3>
<p>We strongly recommend that all your containers should adhere to the principle of least privilege, since your security risk is heavily influenced by the capabilities, role bindings, and privileges given to containers. Each container should only have the minimum privileges and capabilities that allows it to perform its intended function.</p>
<h4 id="utilize-pod-security-standards-and-the-built-in-pod-security-admission-controller-to-enforce-container-privilege-levels">Utilize Pod Security Standards and the Built-in Pod Security Admission Controller to enforce container privilege levels<a class="headerlink" href="#utilize-pod-security-standards-and-the-built-in-pod-security-admission-controller-to-enforce-container-privilege-levels" title="Permanent link">&para;</a></h4>
<p>Pod Security Standards combined with the Pod Security Admission Controller allow cluster administrators to enforce requirements on a pods <code>securityContext</code> fields. Three Pod Security Standard profiles exist:</p>
<ul>
<li><strong>Privileged</strong>: Unrestricted, allows for known privilege escalations. Intended for use with system and infrastructure level workloads that require privilege to operate properly. All securityContext settings are permitted</li>
<li><strong>Baseline</strong>: Minimally restrictive policy designed for common containerized workloads while preventing known privilege escalations. Targeted at developers and operators of non-critical applications. The most dangerous securityContext settings, such as securityContext.privileged, hostPID, hostPath, hostIPC, are not permitted.</li>
<li><strong>Restricted</strong>: The most restrictive policy, designed to enforce current Pod hardening practices at the expense of some compatibility. Intended for security critical workloads or untrusted users. Restricted includes all of the enforcements from the baseline policy, in addition to much more restrictive requirements, such as requiring the dropping of all capabilities, enforcing runAsNotRoot, and more.</li>
</ul>
<p>Each of the profiles have defined settings baselines that can be found in more detail <a href="https://kubernetes.io/docs/concepts/security/pod-security-standards/#profile-details">here</a>.</p>
<p>The Pod Security Admission Controller allows you to enforce, audit, or warn upon the violation of a defined policy. <code>audit</code> and <code>warn</code> modes can be utilized to determine if a particular Pod Security Standard would normally prevent the deployment of a pod when set to <code>enforce</code> mode.</p>
<p>Below is an example of a namespace that would only allow Pods to be deployed that conform to the restricted Pod Security Standard:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Namespace</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy-test</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">    </span>
<span class="w">    </span><span class="nt">pod-security.kubernetes.io/enforce</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restricted</span>
<span class="w">    </span><span class="nt">pod-security.kubernetes.io/audit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restricted</span>
<span class="w">    </span><span class="nt">pod-security.kubernetes.io/warn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restricted</span>
</code></pre></div>
<p>Cluster administrators should properly organize and and enforce policy on cluster namespaces, only permitting the privileged policy on namespaces where it is absolutely required, such as for critical cluster services that require access to the underlying host. Namespaces should be set to the lowest Pod Security Policy that can be enforced and supports their risk level.</p>
<p>If more granular policy enforcement is required beyond the three profiles (Privileged, Baseline, Restricted), Third party admission controllers like OPA Gatekeeper or Kyverno, or built-in Validating Admission Policy can be utilized.</p>
<h4 id="use-pod-security-policies-to-control-the-security-related-attributes-of-pods-which-includes-container-privilege-levels">Use Pod security policies to control the security-related attributes of pods, which includes container privilege levels<a class="headerlink" href="#use-pod-security-policies-to-control-the-security-related-attributes-of-pods-which-includes-container-privilege-levels" title="Permanent link">&para;</a></h4>
<blockquote>
<p><strong>Warning</strong><br />
Kubernetes deprecated Pod Security Policies in favor of Pod Security Standards and the Pod Security Admission Controller, and was removed from Kubernetes in v1.25. Consider using Pod Security Standards and the Pod Security Admission Controller instead.</p>
</blockquote>
<p>All security policies should include the following conditions:</p>
<ul>
<li>Application processes do not run as root.</li>
<li>Privilege escalation is not allowed.</li>
<li>The root filesystem is read-only.</li>
<li>The default (masked) /proc filesystem mount is used.</li>
<li>The host network or process space should NOT be used - using <code>hostNetwork: true</code> will cause NetworkPolicies to be ignored since the Pod will use its host network.</li>
<li>Unused and unnecessary Linux capabilities are eliminated.</li>
<li>Use SELinux options for more fine-grained process controls.</li>
<li>Give each application its own Kubernetes Service Account.</li>
<li>If a container does not need to access the Kubernetes API, do not let it mount the service account credentials.</li>
</ul>
<p>For more information on Pod security policies, refer to the documentation at <a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</a>.</p>
<p>--</p>
<h3 id="providing-extra-security-with-a-service-mesh">Providing extra security with a service mesh<a class="headerlink" href="#providing-extra-security-with-a-service-mesh" title="Permanent link">&para;</a></h3>
<p>A service mesh is an infrastructure layer that can handle communications between services in applications quickly, securely and reliably, which can help reduce the complexity of managing microservices and deployments. They provide a uniform way to secure, connect and monitor microservices. and a service mesh is great at resolving operational challenges and issues when running those containers and microservices.</p>
<h4 id="advantages-of-a-service-mesh">Advantages of a service mesh<a class="headerlink" href="#advantages-of-a-service-mesh" title="Permanent link">&para;</a></h4>
<p>A service mesh provides the following advantages:</p>
<ol>
<li>Observability</li>
</ol>
<p>It generates tracing and telemetry metrics, which make it easy to understand your system and quickly root cause any problems.</p>
<ol start="2">
<li>Specialized security features</li>
</ol>
<p>It provides security features which quickly identify any compromising traffic that enters your cluster and can secure the services inside your network if they are properly implemented. It can also help you manage security through mTLS, ingress and egress control, and more.</p>
<ol start="3">
<li>Ability to secure microservices with mTLS</li>
</ol>
<p>Since securing microservices is hard, there are many tools that address microservices security. However, the service mesh is the most elegant solution for addressing encryption of on-the-wire traffic within the network.</p>
<p>It provides defense with mutual TLS (mTLS) encryption of the traffic between your services, and the mesh can automatically encrypt and decrypt requests and responses, which removes that burden from application developers. The mesh can also improve performance by prioritizing the reuse of existing, persistent connections, which reduces the need for the computationally expensive creation of new ones. With service mesh, you can secure traffic over the wire and also make strong identity-based authentication and authorizations for each microservice.</p>
<p>We see that a service mesh has a lot of value of enterprise companies, because a mesh allows you to see whether mTLS is enabled and working between each of your services. Also, you can get immediate alerts if the security status changes.</p>
<ol start="4">
<li>Ingress &amp; egress control</li>
</ol>
<p>It allows you to monitor and address compromising traffic as it passes through the mesh. For example, if Istio integrates with Kubernetes as an ingress controller, it can take care of load balancing for ingress. This allows defenders to add a level of security at the perimeter with ingress rules, while egress control allows you to see and manage external services and control how your services interact with traffic.</p>
<ol start="5">
<li>Operational Control</li>
</ol>
<p>It can help security and platform teams set the right macro controls to enforce access controls, while allowing developers to make customizations they need to move quickly within these guardrails.</p>
<ol start="6">
<li>Ability to manage RBAC</li>
</ol>
<p>A service mesh can help defenders implement a strong Role Based Access Control (RBAC) system, which is arguably one of the most critical requirements in large engineering organizations. Even a secure system can be easily circumvented by over-privileged users or employees, and an RBAC system can:</p>
<ul>
<li>Restrict privileged users to least privileges necessary to perform job responsibilities</li>
<li>Ensure that access to systems are set to “deny all” by default</li>
<li>Help developers make sure that proper documentation detailing roles and responsibilities are in place, which is one of the most critical security concerns in the enterprise.</li>
</ul>
<h4 id="disadvantages-of-the-security-mesh">Disadvantages of the security mesh<a class="headerlink" href="#disadvantages-of-the-security-mesh" title="Permanent link">&para;</a></h4>
<p>Though a service mesh has many advantages, they also bring in a unique set of challenges and a few of them are listed below:</p>
<ul>
<li>Adds A New Layer of Complexity</li>
</ul>
<p>When proxies, sidecars and other components are introduced an already sophisticated environment, it dramatically increases the complexity of development and operations.</p>
<ul>
<li>Additional Expertise Is Required</li>
</ul>
<p>If a mesh like Istio is added on top of an orchestrator such as Kubernetes, operators need to become experts in both technologies.</p>
<ul>
<li>Infrastructure Can Be Slowed</li>
</ul>
<p>Because a service mesh is an invasive and intricate technology, it can significantly slow down an architecture.</p>
<ul>
<li>Requires Adoption of Yet Another Platform</li>
</ul>
<p>Since service meshes are invasive, they force developers and operators to adapt to a highly opinionated platform and conform to its rules.</p>
<h3 id="implementing-centralized-policy-management">Implementing centralized policy management<a class="headerlink" href="#implementing-centralized-policy-management" title="Permanent link">&para;</a></h3>
<p>There are numerous projects which are able to provide centralized policy management for a Kubernetes cluster, including the <a href="https://www.openpolicyagent.org/">Open Policy Agent</a> (OPA) project, <a href="https://kyverno.io/">Kyverno</a>, or the <a href="https://kubernetes.io/docs/reference/access-authn-authz/validating-admission-policy/">Validating Admission Policy</a> (a built-in feature released to general availability in 1.30). In order to provide an example with some depth, we will focus on OPA in this cheat sheet.</p>
<p>OPA was started in 2016 to unify policy enforcement across different technologies and systems, and it can be used to enforce policies on a platform like Kubernetes. Currently, OPA is part of CNCF as an incubating project. It can create a unified method of enforcing security policy in the stack. While developers can impose fine-grained control over the cluster with RBAC and Pod security policies, these technologies only apply to the cluster but not outside the cluster.</p>
<p>Since OPA is a general-purpose, domain-agnostic policy enforcement tool that is not based on any other project, the policy queries and decisions do not follow a specific format. Thus it can be integrated with APIs, the Linux SSH daemon, an object store like Ceph, and you can use any valid JSON data as request attributes as long as it provides the required data. OPA allows you to choose what is input and what is output--for example, you can opt to have OPA return a True or False JSON object, a number, a string, or even a complex data object.</p>
<h4 id="most-common-use-cases-of-opa">Most common use cases of OPA<a class="headerlink" href="#most-common-use-cases-of-opa" title="Permanent link">&para;</a></h4>
<h5 id="opa-for-application-authorization">OPA for application authorization<a class="headerlink" href="#opa-for-application-authorization" title="Permanent link">&para;</a></h5>
<p>OPA can provide developers with an already-developed authorization technology so the team doesn’t have to develop one from scratch. It uses a declarative policy language purpose built for writing and enforcing rules such as, “Alice can write to this repository,” or “Bob can update this account.” This technology provides a rich suite of tools that can allow developers to integrate policies into their applications and allow end users to also create policy for their tenants.</p>
<p>If you already have a homegrown application authorization solution, you may not want to swap in OPA. But if you want to improve developer efficiency by moving to a solution that scales with microservices and allows you to decompose monolithic apps, you’re going to need a distributed authorization system and OPA (or one of the related competitors) could be the answer.</p>
<h5 id="opa-for-kubernetes-admission-control">OPA for Kubernetes admission control<a class="headerlink" href="#opa-for-kubernetes-admission-control" title="Permanent link">&para;</a></h5>
<p>Since Kubernetes gives developers tremendous control over the traditional silos of "compute, networking and storage," they can use it to set up their network exactly the way they want and set up storage exactly the way they want. But this means that administrators and security teams must make sure that developers don’t shoot themselves (or their neighbors) in the foot.</p>
<p>OPA can address these security concerns by allowing security to build policies that require all container images to be from trusted sources, prevent developers from running software as root, make sure storage is always marked with the encrypt bit and storage does not get deleted just because a pod gets restarted, that limits internet access, etc.</p>
<p>It can also allow administrators to make sure that policy changes don’t inadvertently do more damage than good. OPA integrates directly into the Kubernetes API server and it has complete authority to reject any resource that the admission policy says does not belong in a cluster—-whether it is compute-related, network-related, storage-related, etc. Moreover, policy can be run out-of-band to monitor results and OPA's policies can be exposed early in the development lifecycle (e.g. the CICD pipeline or even on developer laptops) if developers need feedback early.</p>
<h5 id="opa-for-service-mesh-authorization">OPA for service mesh authorization<a class="headerlink" href="#opa-for-service-mesh-authorization" title="Permanent link">&para;</a></h5>
<p>And finally, OPA can regulate use of service mesh architectures. Often, administrators ensure that compliance regulations are satisfied by building policies into the service mesh even when modification to source code is involved. Even if you’re not embedding OPA to implement application authorization logic (the top use case discussed above), you can control the APIs microservices by putting authorization policies into the service mesh. But if you are motivated by security, you can implement policies in the service mesh to limit lateral movement within a microservice architecture.</p>
<h3 id="limiting-resource-usage-on-a-cluster">Limiting resource usage on a cluster<a class="headerlink" href="#limiting-resource-usage-on-a-cluster" title="Permanent link">&para;</a></h3>
<p>It is important to define resource quotas for containers in Kubernetes, since all resources in a Kubernetes cluster are created with unbounded CPU limits and memory requests/limits by default. If you run resource-unbound containers, your system will be in risk of Denial of Service (DoS) or “noisy neighbor” scenarios. Fortunately, OPA can use resource quotas on a namespace, which will limit the number or capacity of resources granted to that namespace and restrict that namespace by defining its CPU capacity, memory, or persistent disk space.</p>
<p>Additionally, the OPA can limit how many pods, services, or volumes exist in each namespace, and it can restrict the maximum or minimum size of some of the resources above. The resource quotas provide default limits when none are specified and prevent users from requesting unreasonably high or low values for commonly reserved resources like memory.</p>
<p>Below is an example of defining namespace resource quota in the appropriate yaml. It limits the number of pods in the namespace to 4, limits their CPU requests between 1 and 2 and memory requests between 1GB to 2GB.</p>
<p><code>compute-resources.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ResourceQuota</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compute-resources</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hard</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pods</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="w">    </span><span class="nt">requests.cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">    </span><span class="nt">requests.memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<span class="w">    </span><span class="nt">limits.cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2&quot;</span>
<span class="w">    </span><span class="nt">limits.memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2Gi</span>
</code></pre></div>
<p>Assign a resource quota to namespace:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>./compute-resources.yaml<span class="w"> </span>--namespace<span class="o">=</span>myspace
</code></pre></div>
<p>For more information on configuring resource quotas, refer to the Kubernetes documentation at <a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/">https://kubernetes.io/docs/concepts/policy/resource-quotas/</a>.</p>
<h3 id="use-kubernetes-network-policies-to-control-traffic-between-pods-and-clusters">Use Kubernetes network policies to control traffic between pods and clusters<a class="headerlink" href="#use-kubernetes-network-policies-to-control-traffic-between-pods-and-clusters" title="Permanent link">&para;</a></h3>
<p>If your cluster runs different applications, a compromised application could attack other neighboring applications. This scenario might happen because Kubernetes allows every pod to contact every other pod by default. If ingress from an external network endpoint is allowed, the pod will be able to send its traffic to an endpoint outside the cluster.</p>
<p>It is strongly recommended that developers implement network segmentation, because it is a key security control that ensures that containers can only communicate with other approved containers and prevents attackers from pursuing lateral movement across containers. However, applying network segmentation in the cloud is challenging because of the “dynamic” nature of container network identities (IPs).</p>
<p>While users of Google Cloud Platform can benefit from automatic firewall rules, which prevent cross-cluster communication, other users can apply similar implementations by deploying on-premises using network firewalls or SDN solutions. Also, the Kubernetes Network SIG is working on methods that will greatly improve the pod-to-pod communication policies. A new network policy API should address the need to create firewall rules around pods, limiting the network access that a containerized can have.</p>
<p>The following is an example of a network policy that controls the network for “backend” pods, which only allows inbound network access from “frontend” pods:</p>
<div class="highlight"><pre><span></span><code><span class="err">POST</span><span class="w"> </span><span class="err">/apis/</span><span class="kc">net</span><span class="err">.alpha.kuber</span><span class="kc">netes</span><span class="err">.io/v</span><span class="mi">1</span><span class="err">alpha</span><span class="mi">1</span><span class="err">/</span><span class="kc">na</span><span class="err">mespaces/</span><span class="kc">tenant</span><span class="mi">-</span><span class="err">a/</span><span class="kc">net</span><span class="err">workpolicys</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NetworkPolicy&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pol1&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;allowIncoming&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">        </span><span class="nt">&quot;pods&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;segment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;frontend&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">}],</span>
<span class="w">      </span><span class="nt">&quot;toPorts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">        </span><span class="nt">&quot;port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TCP&quot;</span>
<span class="w">      </span><span class="p">}]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;podSelector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;segment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>For more information on configuring network policies, refer to the Kubernetes documentation at <a href="https://kubernetes.io/docs/concepts/services-networking/network-policies">https://kubernetes.io/docs/concepts/services-networking/network-policies</a>.</p>
<h3 id="securing-data">Securing data<a class="headerlink" href="#securing-data" title="Permanent link">&para;</a></h3>
<h4 id="keep-secrets-as-secrets">Keep secrets as secrets<a class="headerlink" href="#keep-secrets-as-secrets" title="Permanent link">&para;</a></h4>
<p>It is important to learn how sensitive data such as credentials and keys are stored and accessed in your infrastructure. Kubernetes keeps them in a "secret," which is a small object that contains sensitive data, like a password or token.</p>
<p>It is best for secrets to be mounted into read-only volumes in your containers, rather than exposing them as environment variables. Also, secrets must be kept separate from an image or pod or anyone with access to the image would have access to the secret as well, even though a pod is not able to access the secrets of another pod. Complex applications that handle multiple processes and have public access are especially vulnerable in this regard.</p>
<h4 id="encrypt-secrets-at-rest">Encrypt secrets at rest<a class="headerlink" href="#encrypt-secrets-at-rest" title="Permanent link">&para;</a></h4>
<p>Always encrypt your backups using a well reviewed backup and encryption solution and consider using full disk encryption where possible, because the etcd database contains any information accessible via the Kubernetes API. Access to this database could provide an attacker with significant visibility into the state of your cluster.</p>
<p>Kubernetes supports encryption at rest, a feature introduced in 1.7, and v1 beta since 1.13, which will encrypt Secret resources in etcd and prevent parties with access to your etcd backups from viewing the content of those secrets. While this feature is currently beta, it offers an additional level of defense when backups are not encrypted or an attacker gains read access to etcd.</p>
<h4 id="alternatives-to-kubernetes-secret-resources">Alternatives to Kubernetes Secret resources<a class="headerlink" href="#alternatives-to-kubernetes-secret-resources" title="Permanent link">&para;</a></h4>
<p>Since an external secrets manager can store and manage your secrets rather than storing them in Kubernetes Secrets, you may want to consider this security alternative. A manager provides a number of benefits over using Kubernetes Secrets, including the ability to handle secrets across multiple clusters (or clouds), and the ability to control and rotate secrets centrally.</p>
<p>For more information on Secrets and their alternatives, refer to the documentation at <a href="https://kubernetes.io/docs/concepts/configuration/secret/">https://kubernetes.io/docs/concepts/configuration/secret/</a>.</p>
<p>Also see the <a href="Secrets_Management_Cheat_Sheet.html">Secrets Management</a> cheat sheet for more details and best practices on managing secrets.</p>
<h4 id="finding-exposed-secrets">Finding exposed secrets<a class="headerlink" href="#finding-exposed-secrets" title="Permanent link">&para;</a></h4>
<p>We strongly recommend that you review the secret material present on the container against the principle of 'least privilege' and assess the risk posed by a compromise.</p>
<p>Remember that open-source tools such as <a href="https://github.com/deepfence/SecretScanner">SecretScanner</a> and <a href="https://github.com/deepfence/ThreatMapper">ThreatMapper</a> can scan container filesystems for sensitive resources, such as API tokens, passwords, and keys. Such resources would be accessible to any user who had access to the unencrypted container filesystem, whether during build, at rest in a registry or backup, or running.</p>
<hr />
<h2 id="section-5-kubernetes-security-best-practices-runtime-phase">SECTION 5: Kubernetes Security Best Practices: Runtime Phase<a class="headerlink" href="#section-5-kubernetes-security-best-practices-runtime-phase" title="Permanent link">&para;</a></h2>
<p>When the Kubernetes infrastructure enters the runtime phase, containerized applications are exposed to a slew of new security challenges. You must gain visibility into your running environment so you can detect and respond to threats as they arise.</p>
<p>If you proactively secure your containers and Kubernetes deployments at the build and deploy phases, you can greatly reduce the likelihood of security incidents at runtime and the subsequent effort needed to respond to them.</p>
<p>First, monitor the most security-relevant container activities, including:</p>
<ul>
<li>Process activity</li>
<li>Network communications among containerized services</li>
<li>Network communications between containerized services and external clients and servers</li>
</ul>
<p>Detecting anomalies by observing container behavior is generally easier in containers than in virtual machines because of the declarative nature of containers and Kubernetes. These attributes allow easier introspection into what you have deployed and its expected activity.</p>
<h3 id="use-pod-security-admission-to-prevent-risky-containerspods-from-being-deployed">Use Pod Security Admission to prevent risky containers/Pods from being deployed<a class="headerlink" href="#use-pod-security-admission-to-prevent-risky-containerspods-from-being-deployed" title="Permanent link">&para;</a></h3>
<p>The previously recommended <a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Pod Security Policy</a> is deprecated and replaced by <a href="https://kubernetes.io/docs/concepts/security/pod-security-admission/">Pod Security Admission</a>, a new feature that allows you to enforce security policies on pods in a Kubernetes cluster.</p>
<p>It is recommended to use the <code>baseline</code> level as a minimum security requirement for all pods to ensure a standard level of security across the cluster. However, clusters should strive to apply the <code>restricted</code> level which follows pod hardening best practices.</p>
<p>For more information on configuring Pod Security Admission, refer to the documentation at <a href="https://kubernetes.io/docs/tasks/configure-pod-container/enforce-standards-admission-controller/">https://kubernetes.io/docs/tasks/configure-pod-container/enforce-standards-admission-controller/</a>.</p>
<h3 id="container-runtime-security">Container Runtime Security<a class="headerlink" href="#container-runtime-security" title="Permanent link">&para;</a></h3>
<p>If containers are hardened containers at runtime, security teams have the ability to detect and respond to threats and anomalies while the containers or workloads are in a running state. Typically, this is carried out by intercepting the low-level system calls and looking for events that may indicate compromise. Some examples of events that should trigger an alert would include:</p>
<ul>
<li>A shell is run inside a container</li>
<li>A container mounts a sensitive path from the host such as /proc</li>
<li>A sensitive file is unexpectedly read in a running container such as /etc/shadow</li>
<li>An outbound network connection is established</li>
</ul>
<p>Open source tools such as Falco from Sysdig can help operators get up and running with container runtime security by providing defenders with a large number of out-of-the-box detections as well as the ability to create custom rules.</p>
<h3 id="container-sandboxing">Container Sandboxing<a class="headerlink" href="#container-sandboxing" title="Permanent link">&para;</a></h3>
<p>When container runtimes are permitted to make direct calls to the host kernel, the kernel often interacts with hardware and devices to respond to the request. Though Cgroups and namespaces give containers a certain amount of isolation, the kernel still presents a large attack surface. When defenders have to deal with multi-tenant and highly untrusted clusters, they often add additional layer of sandboxing to ensure that container breakout and kernel exploits are not present. Below, we will explore a few OSS technologies that help further isolate running containers from the host kernel:</p>
<ul>
<li>Kata Containers: Kata Containers is an OSS project that uses stripped-down VMs to keep the resource footprint minimal and maximize performance to ultimately isolate containers further.</li>
<li>gVisor : gVisor is a more lightweight kernel than a VM (even stripped down). It is its own independent kernel written in Go and sits in the middle of a container and the host kernel. It is a strong sandbox--gVisor supports ~70% of the linux system calls from the container but ONLY uses about 20 system calls to the host kernel.</li>
<li>Firecracker: It is a super lightweight VM that runs in user space. Since it is locked down by seccomp, cgroup, and namespace policies, the system calls are very limited. Firecracker is built with security in mind, however it may not support all Kubernetes or container runtime deployments.</li>
</ul>
<h3 id="preventing-containers-from-loading-unwanted-kernel-modules">Preventing containers from loading unwanted kernel modules<a class="headerlink" href="#preventing-containers-from-loading-unwanted-kernel-modules" title="Permanent link">&para;</a></h3>
<p>Because Linux kernel automatically loads kernel modules from disk if needed in certain circumstances, such as when a piece of hardware is attached or a filesystem is mounted, this can be a significant attack surface. Of particular relevance to Kubernetes, even unprivileged processes can cause certain network-protocol-related kernel modules to be loaded, just by creating a socket of the appropriate type. This situation may allow attackers to exploit a security hole in kernel modules that the administrator assumed was not in use.</p>
<p>To prevent specific modules from being automatically loaded, you can uninstall them from the node, or add rules to block them. On most Linux distributions, you can do that by creating a file such as <code>/etc/modprobe.d/kubernetes-blacklist.conf</code> with contents like:</p>
<div class="highlight"><pre><span></span><code># DCCP is unlikely to be needed, has had multiple serious
# vulnerabilities, and is not well-maintained.
blacklist dccp

# SCTP is not used in most Kubernetes clusters, and has also had
# vulnerabilities in the past.
blacklist sctp
</code></pre></div>
<p>To block module loading more generically, you can use a Linux Security Module (such as SELinux) to completely deny the module_request permission to containers, preventing the kernel from loading modules for containers under any circumstances. (Pods would still be able to use modules that had been loaded manually, or modules that were loaded by the kernel on behalf of some more-privileged process).</p>
<h3 id="compare-and-analyze-different-runtime-activity-in-pods-of-the-same-deployments">Compare and analyze different runtime activity in pods of the same deployments<a class="headerlink" href="#compare-and-analyze-different-runtime-activity-in-pods-of-the-same-deployments" title="Permanent link">&para;</a></h3>
<p>When containerized applications are replicated for high availability, fault tolerance, or scale reasons, these replicas should behave nearly identically. If a replica has significant deviations from the others, defenders would want further investigation. Your Kubernetes security tool should be integrated with other external systems (email, PagerDuty, Slack, Google Cloud Security Command Center, SIEMs [security information and event management], etc.) and leverage deployment labels or annotations to alert the team responsible for a given application when a potential threat is detected. If you chose to use a commercial Kubernetes security vendor, they should support a wide array of integrations with external tools.</p>
<h3 id="monitor-network-traffic-to-limit-unnecessary-or-insecure-communication">Monitor network traffic to limit unnecessary or insecure communication<a class="headerlink" href="#monitor-network-traffic-to-limit-unnecessary-or-insecure-communication" title="Permanent link">&para;</a></h3>
<p>Containerized applications typically make extensive use of cluster networking, so observing active networking traffic is a good way to understand how applications interact with each other and identify unexpected communication. You should observe your active network traffic and compare that traffic to what is allowed based on your Kubernetes network policies.</p>
<p>At the same time, comparing the active traffic with what’s allowed gives you valuable information about what isn’t happening but is allowed. With that information, you can further tighten your allowed network policies so that it removes superfluous connections and decreases your overall attack surface.</p>
<p>Open source projects like <a href="https://github.com/kinvolk/inspektor-gadget">https://github.com/kinvolk/inspektor-gadget</a> or <a href="https://github.com/deepfence/PacketStreamer">https://github.com/deepfence/PacketStreamer</a> may help with this, and commercial security solutions provide varying degrees of container network traffic analysis.</p>
<h3 id="if-breached-scale-suspicious-pods-to-zero">If breached, scale suspicious pods to zero<a class="headerlink" href="#if-breached-scale-suspicious-pods-to-zero" title="Permanent link">&para;</a></h3>
<p>Contain a successful breach by using Kubernetes native controls to scale suspicious pods to zero or kill then restart instances of breached applications.</p>
<h3 id="rotate-infrastructure-credentials-frequently">Rotate infrastructure credentials frequently<a class="headerlink" href="#rotate-infrastructure-credentials-frequently" title="Permanent link">&para;</a></h3>
<p>The shorter the lifetime of a secret or credential, the harder it is for an attacker to make use of that credential. Set short lifetimes on certificates and automate their rotation. Use an authentication provider that can control how long issued tokens are available and use short lifetimes where possible. If you use service account tokens in external integrations, plan to rotate those tokens frequently. For example, once the bootstrap phase is complete, a bootstrap token used for setting up nodes should be revoked or its authorization removed.</p>
<h3 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h3>
<p>Kubernetes supplies cluster-based logging, which allows you to log container activity into a central log hub. When a cluster is created, the standard output and standard error output of each container can be ingested using a Fluentd agent running on each node (into either Google Stackdriver Logging or into Elasticsearch) and viewed with Kibana.</p>
<h4 id="enable-audit-logging">Enable audit logging<a class="headerlink" href="#enable-audit-logging" title="Permanent link">&para;</a></h4>
<p>The audit logger is a beta feature that records actions taken by the API for later analysis in the event of a compromise. It is recommended to enable audit logging and archive the audit file on a secure server</p>
<p>Ensure logs that are monitoring for anomalous or unwanted API calls, especially any authorization failures (these log entries will have a status message “Forbidden”). Authorization failures could mean that an attacker is trying to abuse stolen credentials.</p>
<p>Managed Kubernetes providers, including GKE, provide access to this data in their cloud console and may allow you to set up alerts on authorization failures.</p>
<h5 id="audit-logs">Audit logs<a class="headerlink" href="#audit-logs" title="Permanent link">&para;</a></h5>
<p>Audit logs can be useful for compliance as they should help you answer the questions of what happened, who did what and when. Kubernetes provides flexible auditing of kube-apiserver requests based on policies. These help you track all activities in chronological order.</p>
<p>Here is an example of an audit log:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="s2">&quot;Event&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;apiVersion&quot;</span><span class="p">:</span><span class="s2">&quot;audit.k8s.io/v1beta1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:{</span><span class="w"> </span><span class="nt">&quot;creationTimestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2019-08-22T12:00:00Z&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;Metadata&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2019-08-22T12:00:00Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;auditID&quot;</span><span class="p">:</span><span class="s2">&quot;23bc44ds-2452-242g-fsf2-4242fe3ggfes&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;stage&quot;</span><span class="p">:</span><span class="s2">&quot;RequestReceived&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;requestURI&quot;</span><span class="p">:</span><span class="s2">&quot;/api/v1/namespaces/default/persistentvolumeclaims&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;verb&quot;</span><span class="p">:</span><span class="s2">&quot;list&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="s2">&quot;user@example.org&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;groups&quot;</span><span class="p">:[</span><span class="w"> </span><span class="s2">&quot;system:authenticated&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;sourceIPs&quot;</span><span class="p">:[</span><span class="w"> </span><span class="s2">&quot;172.12.56.1&quot;</span><span class="w"> </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;objectRef&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;resource&quot;</span><span class="p">:</span><span class="s2">&quot;persistentvolumeclaims&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;namespace&quot;</span><span class="p">:</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;apiVersion&quot;</span><span class="p">:</span><span class="s2">&quot;v1&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;requestReceivedTimestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2019-08-22T12:00:00Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;stageTimestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2019-08-22T12:00:00Z&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="define-audit-policies">Define Audit Policies<a class="headerlink" href="#define-audit-policies" title="Permanent link">&para;</a></h4>
<p>Audit policy sets rules which define what events should be recorded and what data is stored when an event includes. The audit policy object structure is defined in the audit.k8s.io API group. When an event is processed, it is compared against the list of rules in order. The first matching rule sets the "audit level" of the event.</p>
<p>The known audit levels are:</p>
<ul>
<li>None - don't log events that match this rule</li>
<li>Metadata - log request metadata (requesting user, timestamp, resource, verb, etc.) but not request or response body</li>
<li>Request - log event metadata and request body but not response body. This does not apply for non-resource requests</li>
<li>RequestResponse - log event metadata, request and response bodies. This does not apply for non-resource requests</li>
</ul>
<p>You can pass a file with the policy to kube-apiserver using the --audit-policy-file flag. If the flag is omitted, no events are logged. Note that the rules field must be provided in the audit policy file. A policy with no (0) rules is treated as illegal.</p>
<h4 id="understanding-logging">Understanding Logging<a class="headerlink" href="#understanding-logging" title="Permanent link">&para;</a></h4>
<p>One main challenge with logging Kubernetes is understanding what logs are generated and how to use them. Let’s start by examining the overall picture of Kubernetes' logging architecture.</p>
<h5 id="container-logging">Container logging<a class="headerlink" href="#container-logging" title="Permanent link">&para;</a></h5>
<p>The first layer of logs that can be collected from a Kubernetes cluster are those being generated by your containerized applications. The easiest method for logging containers is to write to the standard output (stdout) and standard error (stderr) streams.</p>
<p>Manifest is as follows.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/bin/sh</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-c</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;while</span><span class="nv"> </span><span class="s">true;</span><span class="nv"> </span><span class="s">do</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">$(date);</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">1;</span><span class="nv"> </span><span class="s">done&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>To apply the manifest, run:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>example.yaml
</code></pre></div>
<p>To take a look the logs for this container, run:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>log<span class="w"> </span>&lt;container-name&gt;<span class="w"> </span>command.
</code></pre></div>
<p>For persisting container logs, the common approach is to write logs to a log file and then use a sidecar container. As shown below in the pod configuration above, a sidecar container will run in the same pod along with the application container, mounting the same volume and processing the logs separately.</p>
<p>An example of a Pod Manifest is seen below:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/bin/sh</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-c</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">while true;</span>
<span class="w">      </span><span class="no">do</span>
<span class="w">        </span><span class="no">echo &quot;$(date)\n&quot; &gt;&gt; /var/log/example.log;</span>
<span class="w">        </span><span class="no">sleep 1;</span>
<span class="w">      </span><span class="no">done</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">varlog</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sidecar</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/bin/sh</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-c</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;tail</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">/var/log/example.log&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">varlog</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">varlog</span>
<span class="w">    </span><span class="nt">emptyDir</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
<h5 id="node-logging">Node logging<a class="headerlink" href="#node-logging" title="Permanent link">&para;</a></h5>
<p>When a container running on Kubernetes writes its logs to stdout or stderr streams, the container engine streams them to the logging driver set by the Kubernetes configuration.</p>
<p>In most cases, these logs will end up in the /var/log/containers directory on your host. Docker supports multiple logging drivers but unfortunately, driver configuration is not supported via the Kubernetes API.</p>
<p>Once a container is terminated or restarted, kubelet stores logs on the node. To prevent these files from consuming all of the host’s storage, the Kubernetes node implements a log rotation mechanism. When a container is evicted from the node, all containers with corresponding log files are evicted.</p>
<p>Depending on what operating system and additional services you’re running on your host machine, you might need to take a look at additional logs.</p>
<p>For example, systemd logs can be retrieved using the following command:</p>
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u
</code></pre></div>
<h5 id="cluster-logging">Cluster logging<a class="headerlink" href="#cluster-logging" title="Permanent link">&para;</a></h5>
<p>In the Kubernetes cluster itself, there is a long list of cluster components that can be logged as well as additional data types that can be used (events, audit logs). Together, these different types of data can give you visibility into how Kubernetes is performing as a system.</p>
<p>Some of these components run in a container, and some of them run on the operating system level (in most cases, a systemd service). The systemd services write to journald, and components running in containers write logs to the /var/log directory, unless the container engine has been configured to stream logs differently.</p>
<h4 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h4>
<p>Kubernetes events can indicate any Kubernetes resource state changes and errors, such as exceeded resource quota or pending pods, as well as any informational messages.</p>
<p>The following command returns all events within a specific namespace:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>events<span class="w"> </span>-n<span class="w"> </span>&lt;namespace&gt;

NAMESPACE<span class="w"> </span>LAST<span class="w"> </span>SEEN<span class="w"> </span>TYPE<span class="w">   </span>REASON<span class="w"> </span>OBJECT<span class="w"> </span>MESSAGE
kube-system<span class="w">  </span>8m22s<span class="w">  </span>Normal<span class="w">   </span>Scheduled<span class="w">            </span>pod/metrics-server-66dbbb67db-lh865<span class="w">                                       </span>Successfully<span class="w"> </span>assigned<span class="w"> </span>kube-system/metrics-server-66dbbb67db-lh865<span class="w"> </span>to<span class="w"> </span>aks-agentpool-42213468-1
kube-system<span class="w">     </span>8m14s<span class="w">               </span>Normal<span class="w">    </span>Pulling<span class="w">                   </span>pod/metrics-server-66dbbb67db-lh865<span class="w">                                       </span>Pulling<span class="w"> </span>image<span class="w"> </span><span class="s2">&quot;aksrepos.azurecr.io/mirror/metrics-server-amd64:v0.2.1&quot;</span>
kube-system<span class="w">     </span>7m58s<span class="w">               </span>Normal<span class="w">    </span>Pulled<span class="w">                    </span>pod/metrics-server-66dbbb67db-lh865<span class="w">                                       </span>Successfully<span class="w"> </span>pulled<span class="w"> </span>image<span class="w"> </span><span class="s2">&quot;aksrepos.azurecr.io/mirror/metrics-server-amd64:v0.2.1&quot;</span>
kube-system<span class="w">     </span>7m57s<span class="w">               </span>Normal<span class="w">     </span>Created<span class="w">                   </span>pod/metrics-server-66dbbb67db-lh865<span class="w">                                       </span>Created<span class="w"> </span>container<span class="w"> </span>metrics-server
kube-system<span class="w">     </span>7m57s<span class="w">               </span>Normal<span class="w">    </span>Started<span class="w">                   </span>pod/metrics-server-66dbbb67db-lh865<span class="w">                                       </span>Started<span class="w"> </span>container<span class="w"> </span>metrics-server
kube-system<span class="w">     </span>8m23s<span class="w">               </span>Normal<span class="w">    </span>SuccessfulCreate<span class="w">          </span>replicaset/metrics-server-66dbbb67db<span class="w">             </span>Created<span class="w"> </span>pod:<span class="w"> </span>metrics-server-66dbbb67db-lh865
</code></pre></div>
<p>The following command will show the latest events for this specific Kubernetes resource:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>describe<span class="w"> </span>pod<span class="w"> </span>&lt;pod-name&gt;

Events:
<span class="w">  </span>Type<span class="w">    </span>Reason<span class="w">     </span>Age<span class="w">   </span>From<span class="w">                               </span>Message
<span class="w">  </span>----<span class="w">    </span>------<span class="w">     </span>----<span class="w">  </span>----<span class="w">                               </span>-------
<span class="w">  </span>Normal<span class="w">  </span>Scheduled<span class="w">  </span>14m<span class="w">   </span>default-scheduler<span class="w">                  </span>Successfully<span class="w"> </span>assigned<span class="w"> </span>kube-system/coredns-7b54b5b97c-dpll7<span class="w"> </span>to<span class="w"> </span>aks-agentpool-42213468-1
<span class="w">  </span>Normal<span class="w">  </span>Pulled<span class="w">     </span>13m<span class="w">   </span>kubelet,<span class="w"> </span>aks-agentpool-42213468-1<span class="w">  </span>Container<span class="w"> </span>image<span class="w"> </span><span class="s2">&quot;aksrepos.azurecr.io/mirror/coredns:1.3.1&quot;</span><span class="w"> </span>already<span class="w"> </span>present<span class="w"> </span>on<span class="w"> </span>machine
<span class="w">  </span>Normal<span class="w">  </span>Created<span class="w">    </span>13m<span class="w">   </span>kubelet,<span class="w"> </span>aks-agentpool-42213468-1<span class="w">  </span>Created<span class="w"> </span>container<span class="w"> </span>coredns
<span class="w">  </span>Normal<span class="w">  </span>Started<span class="w">    </span>13m<span class="w">   </span>kubelet,<span class="w"> </span>aks-agentpool-42213468-1<span class="w">  </span>Started<span class="w"> </span>container<span class="w"> </span>coredns
</code></pre></div>
<h2 id="section-5-final-thoughts">SECTION 5: Final Thoughts<a class="headerlink" href="#section-5-final-thoughts" title="Permanent link">&para;</a></h2>
<h3 id="embed-security-into-the-container-lifecycle-as-early-as-possible">Embed security into the container lifecycle as early as possible<a class="headerlink" href="#embed-security-into-the-container-lifecycle-as-early-as-possible" title="Permanent link">&para;</a></h3>
<p>You must integrate security earlier into the container lifecycle and ensure alignment and shared goals between security and DevOps teams. Security can (and should) be an enabler that allows your developers and DevOps teams to confidently build and deploy applications that are production-ready for scale, stability and security.</p>
<h3 id="use-kubernetes-native-security-controls-to-reduce-operational-risk">Use Kubernetes-native security controls to reduce operational risk<a class="headerlink" href="#use-kubernetes-native-security-controls-to-reduce-operational-risk" title="Permanent link">&para;</a></h3>
<p>Leverage the native controls built into Kubernetes whenever available in order to enforce security policies so that your security controls don’t collide with the orchestrator. Instead of using a third-party proxy or shim to enforce network segmentation, you could use Kubernetes network policies to ensure secure network communication.</p>
<h3 id="leverage-the-context-that-kubernetes-provides-to-prioritize-remediation-efforts">Leverage the context that Kubernetes provides to prioritize remediation efforts<a class="headerlink" href="#leverage-the-context-that-kubernetes-provides-to-prioritize-remediation-efforts" title="Permanent link">&para;</a></h3>
<p>Note that manually triaging security incidents and policy violations is time consuming in sprawling Kubernetes environments.</p>
<p>For example, a deployment containing a vulnerability with severity score of 7 or greater should be moved up in remediation priority if that deployment contains privileged containers and is open to the Internet but moved down if it’s in a test environment and supporting a non-critical app.</p>
<hr />
<p><img alt="Kubernetes Architecture" src="../assets/Kubernetes_Architecture.png" /></p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p>Control plane documentation - <a href="https://kubernetes.io">https://kubernetes.io</a></p>
<ol>
<li>Kubernetes Security Best Practices everyone must follow - <a href="https://www.cncf.io/blog/2019/01/14/9-kubernetes-security-best-practices-everyone-must-follow">https://www.cncf.io/blog/2019/01/14/9-kubernetes-security-best-practices-everyone-must-follow</a></li>
<li>Securing a Cluster - <a href="https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster">https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster</a></li>
<li>Security Best Practices for Kubernetes Deployment - <a href="https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment">https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment</a></li>
<li>Kubernetes Security Best Practices - <a href="https://phoenixnap.com/kb/kubernetes-security-best-practices">https://phoenixnap.com/kb/kubernetes-security-best-practices</a></li>
<li>Kubernetes Security 101: Risks and 29 Best Practices - <a href="https://www.stackrox.com/post/2020/05/kubernetes-security-101">https://www.stackrox.com/post/2020/05/kubernetes-security-101</a></li>
<li>15 Kubernetes security best practice to secure your cluster - <a href="https://www.mobilise.cloud/15-kubernetes-security-best-practice-to-secure-your-cluster">https://www.mobilise.cloud/15-kubernetes-security-best-practice-to-secure-your-cluster</a></li>
<li>The Ultimate Guide to Kubernetes Security - <a href="https://neuvector.com/container-security/kubernetes-security-guide">https://neuvector.com/container-security/kubernetes-security-guide</a></li>
<li>A hacker's guide to Kubernetes security - <a href="https://techbeacon.com/enterprise-it/hackers-guide-kubernetes-security">https://techbeacon.com/enterprise-it/hackers-guide-kubernetes-security</a></li>
<li>11 Ways (Not) to Get Hacked - <a href="https://kubernetes.io/blog/2018/07/18/11-ways-not-to-get-hacked">https://kubernetes.io/blog/2018/07/18/11-ways-not-to-get-hacked</a></li>
<li>12 Kubernetes configuration best practices - <a href="https://www.stackrox.com/post/2019/09/12-kubernetes-configuration-best-practices/#6-securely-configure-the-kubernetes-api-server">https://www.stackrox.com/post/2019/09/12-kubernetes-configuration-best-practices/#6-securely-configure-the-kubernetes-api-server</a></li>
<li>A Practical Guide to Kubernetes Logging - <a href="https://logz.io/blog/a-practical-guide-to-kubernetes-logging">https://logz.io/blog/a-practical-guide-to-kubernetes-logging</a></li>
<li>Kubernetes Web UI (Dashboard) - <a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard">https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard</a></li>
<li>Tesla cloud resources are hacked to run cryptocurrency-mining malware - <a href="https://arstechnica.com/information-technology/2018/02/tesla-cloud-resources-are-hacked-to-run-cryptocurrency-mining-malware">https://arstechnica.com/information-technology/2018/02/tesla-cloud-resources-are-hacked-to-run-cryptocurrency-mining-malware</a></li>
<li>OPEN POLICY AGENT: CLOUD-NATIVE AUTHORIZATION - <a href="https://blog.styra.com/blog/open-policy-agent-authorization-for-the-cloud">https://blog.styra.com/blog/open-policy-agent-authorization-for-the-cloud</a></li>
<li>Introducing Policy As Code: The Open Policy Agent (OPA) - <a href="https://www.magalix.com/blog/introducing-policy-as-code-the-open-policy-agent-opa">https://www.magalix.com/blog/introducing-policy-as-code-the-open-policy-agent-opa</a></li>
<li>What service mesh provides - <a href="https://aspenmesh.io/wp-content/uploads/2019/10/AspenMesh_CompleteGuide.pdf">https://aspenmesh.io/wp-content/uploads/2019/10/AspenMesh_CompleteGuide.pdf</a></li>
<li>Three Technical Benefits of Service Meshes and their Operational Limitations, Part 1 - <a href="https://glasnostic.com/blog/service-mesh-istio-limits-and-benefits-part-1">https://glasnostic.com/blog/service-mesh-istio-limits-and-benefits-part-1</a></li>
<li>Open Policy Agent: What Is OPA and How It Works (Examples) - <a href="https://spacelift.io/blog/what-is-open-policy-agent-and-how-it-works">https://spacelift.io/blog/what-is-open-policy-agent-and-how-it-works</a></li>
<li>Send Kubernetes Metrics To Kibana and Elasticsearch - <a href="https://logit.io/sources/configure/kubernetes/">https://logit.io/sources/configure/kubernetes/</a></li>
<li>Kubernetes Security Checklist - <a href="https://kubernetes.io/docs/concepts/security/security-checklist/">https://kubernetes.io/docs/concepts/security/security-checklist/</a></li>
</ol>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>