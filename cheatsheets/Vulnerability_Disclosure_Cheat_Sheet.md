# Introduction

This cheatsheet is to help people report vulnerabilities they can find either randomly, either through security research.
 
**Disclaimer**: No warranty - consult lawyer!

# Prepare

- define the scope
- check if company has
    - identified security contacts: typical security@, abuse@, noc@ ([RFC2142](https://www.ietf.org/rfc/rfc2142.txt)) or [public](https://first.org/members/teams/) [CERT](https://www.trusted-introducer.org/directory/teams.html).
    - a responsible disclosure web page
    - bug bounty program. Example platforms : hackerone, bugcrowd, synack, bountyfactory.io...
    - a security.txt file on one of their websites ([website](https://securitytxt.org/), [github repo](https://github.com/securitytxt/security-txt), [ietf draft](https://www.ietf.org/id/draft-foudil-securitytxt-00.txt))

# Identify

Remember if they are rules defined by a bounty program or laws applied to your country. Document every step allowing to identify vulnerability, and if acceptable in your context, how to exploit it.

# Report

It is recommended to use responsible disclosure when dealing with vulnerabilities

- alert the company, multiple times and persons if needed.
- request [CVE Identification](http://cve.mitre.org/cve/request_id)([RedHat CVE HowTo](https://github.com/RedHatProductSecurity/CVE-HOWTO)).
- alert trusted 3rd party like National CERT, Data Privacy regulator if apply. Eventually, some security researchers like [Brian Krebs](https://krebsonsecurity.com/) or [Troy Hunt](https://www.troyhunt.com/) (non-exhaustive. check your network first) can be intermediate too or provide support.
- full/public disclosure

Depending on your context, each step may have more or less important time interval. Be flexible. ***Encourage trust, transparency and openness***. Timeline of full disclosure is always a debate especially if there is active exploitation. Be considerate of the work necessary to do the fix while balancing with public interest.

Examples of public disclosure timeline and methodology

- RFPolicy, Rain Forest Puppy, 2000: [5d](https://dl.packetstormsecurity.net/papers/general/rfpolicy-2.0.txt) for initial contact
- Google Project Zero:
    - [90d](https://googleprojectzero.blogspot.ca/2015/02/feedback-and-data-driven-updates-to.html) after initial notification and 14d grace period
    - [7d after if actively exploited Microsoft, 2016](https://www.secpod.com/blog/google-discloses-zero-day-in-windows-kernel/)
- US CERT/CC: [45d](https://www.cert.org/vulnerability-analysis/vul-disclosure.cfm) after initial report
- Internet Engineering Task Force (IETF): [Responsible Vulnerability Disclosure Process](https://tools.ietf.org/html/draft-christey-wysopal-vuln-disclosure-00). Insisted on joined work with no unique timeline
- Microsoft: [Coordinated Vulnerability Disclosure](https://technet.microsoft.com/en-us/security/dn467923) (CVD)
- ISO/IEC [29147:2014](http://www.iso.org/iso/catalogue_detail.htm?csnumber=45170): Vulnerability disclosure

Report should include all details necessary to understand vulnerability and reproduce it (exploit code for example). If you identify limiting factors, include them (Non-Admin user, use of Ms EMET, security HTTP headers...).

If possible, use encryption like PGP/GPG to encrypt your report. You can use [Encrypt.to](https://encrypt.to/) to do from a web browser if recipient has a public key. If you want to remain anonymous, it's probably better to use pseudonym and one-time use email on Tor network or similar. Intermediate party might also be available like ZeroDisclo.com but ensure target destination is relevant (In 2017, mostly FR & EU).

# Aftermath

If you think your lessons learned would be useful to community, share it (anonymously or not).

# Legal

Most western countries have an exception for interoperability and security research but...

- US: Sec. 103(f) of the DMCA (17 U.S.C. § 1201 (f)) but EULA and contract override law.
- FR: [Art.](https://fr.wikipedia.org/wiki/Rétro-ingénierie#L.C3.A9gislation) [L. 335-3-1 - article 22 du DADVSI](https://www.legifrance.gouv.fr/affichTexte.do?cidTexte=JORFTEXT000000266350&categorieLien=id) (2006), [EU Directive 2009/24](http://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX%3A32009L0024)
- CA: Ambiguous... Bill [C-32](http://www.parl.gc.ca/HousePublications/Publication.aspx?DocId=4580265&Language=e&Mode=1) (2010), Bill [C-11](http://www.parl.gc.ca/HousePublications/Publication.aspx?DocId=5465759) (2011). Criminal code provisions (Bill [C-46](http://laws-lois.justice.gc.ca/eng/acts/C-46/FullText.html)) for testing without permission: 430(1.1) ("Mischief in relation to computer data"), 342.1 ("Unauthorized use of a computer"), 342.2 ("Possession of device to obtain unauthorized use of computer system or to commit mischief").

# Definitions

- Full disclosure

*Full disclosure is the practice of publishing analysis of software vulnerabilities as early as possible, making the data accessible to everyone without restriction. The primary purpose of widely disseminating information about vulnerabilities is so that potential victims are as knowledgeable as those who attack them.*, [Wikipedia](https://en.wikipedia.org/wiki/Full_disclosure_%28computer_security%29)

- Responsible disclosure

*The issue is reported privately to the vendor and no one else until the vendor issues a patch.*, [Microsoft](https://www.microsoft.com/en-us/msrc/cvd), 2010

- Coordinated disclosure

*Coordinate public release happens, ideally, when the vendor releases the update. In the case of publicly verifiable active attacks, details may be released prior to an update being released, with emphasis on giving details to protection providers.*, [Microsoft](https://www.microsoft.com/en-us/msrc/cvd), 2010

- Private disclosure

*The vulnerability is released to a small group of people (not the vendor) or kept private.*

Other definitions : [CERT/CC](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=4718642)

# References

- [Vulnerability Disclosure](https://www.cert.org/vulnerability-analysis/vul-disclosure.cfm).
- [Debating Full Disclosure](https://www.schneier.com/blog/archives/2007/01/debating_full_d.html), Bruce Schneier, Jan2007.
- [7 Deadly Sins of Website Vulnerability Disclosure](http://blog.jeremiahgrossman.com/2007/07/7-deadly-sins-of-website-vulnerability.html), Jeremiah Grossman, Jul 2007.
- [Notification and disclosure Policy](http://blog.zoller.lu/2008/09/notification-and-disclosure-policy.html) (update), Thierry Zoller, Sep 2008.
- [Matt's Guide to Vendor Response](http://blog.talosintelligence.com/2009/12/matts-guide-to-vendor-response.html), Talos, Dec 2009.
- [The responsibility of public disclosure](https://www.troyhunt.com/the-responsibility-of-public-disclosure/), Troy Hunt, May 2013.
- [Approaches to Vulnerability Disclosure](http://blog.opensecurityresearch.com/2014/06/approaches-to-vulnerability-disclosure.html), Brad Antoniewicz, Jun 2014.
- [Reflections on Vulnerability Disclosure Case Studies & Ethical Dilemmas](https://www.ernw.de/download/ACM_SigComm_ENSR_Rey_Vulnerability_Disclosure.pdf), ERNW, ACM 2015.
- [Good Practice Guide on Vulnerability Disclosure. From challenges to recommendations](https://www.enisa.europa.eu/publications/vulnerability-disclosure), ENISA, Jan 2016.
- [Reverse Engineering legality](https://en.wikipedia.org/wiki/Reverse_engineering#Legality).
- [FireEye takes security firm to court over vulnerability disclosure](http://www.pcworld.com/article/2983144/fireeye-takes-security-firm-to-court-over-vulnerability-disclosure.html), sep 2015.
- [Google Discloses Windows Zero-Day Before Microsoft Can Issue Patch](http://www.bleepingcomputer.com/news/security/google-discloses-windows-zero-day-before-microsoft-can-issue-patch/), nov 2016.
- [Bug bounties and extortion](https://scotthelme.co.uk/bug-bounties-and-extortion/), feb 2017.

# Countries specifics

- USA
    - [Reverse Engineering FAQ](https://www.eff.org/issues/coders/reverse-engineering-faq).
    - [DMCA exemption](https://www.ftc.gov/news-events/blogs/techftc/2016/10/dmca-security-research-exemption-consumer-devices).
- CANADA
    - ['Messenger always gets shot': Hackers say the Canadian government doesn't want their help](http://www.cbc.ca/news/technology/canadian-government-hackers-1.3866336), CBC, Nov 2016.
    - [Some thoughts on Bill-C-32: An Act to Modernize Canada's copyright laws](http://www.barrysookman.com/2010/06/03/some-thoughts-on-bill-c-32-an-act-to-modernize-canada%E2%80%99s-copyright-laws/), Barry Sookman, Jun 2010.
- UNITED KINGDOM
    - [UK surveillance law raises concerns security researchers could be 'deputised' by the state](https://www.theregister.co.uk/2017/05/31/surveillance_law_compulsion/), TheRegister, May 217.
- FRANCE
    - [ANSSI: Notify a security issue](https://www.ssi.gouv.fr/en-cas-dincident/vous-souhaitez-declarer-une-faille-de-securite-ou-une-vulnerabilite/).
- NETHERLAND
    - [NCSC: Notify a security issue](https://www.ncsc.nl/english/security).
- LUXEMBURG
    - [CIRCL: Notify a security issue](http://circl.lu/report/).

*Feel free to provide other countries!*