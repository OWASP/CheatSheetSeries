
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html">
      
      
        <link rel="prev" href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html">
      
      
        <link rel="next" href="Software_Supply_Chain_Security_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Session Management - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#session-management-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Session Management
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Alphabetical
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index ASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index MASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Proactive Controls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Top 10
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Browser_Extension_Vulnerabilities_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Extension Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C-Based Toolchain Hardening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-Site Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DotNet Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Legacy_Application_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legacy Application Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodejs Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Session Management
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Session Management
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-id-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session ID Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-id-name-fingerprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Name Fingerprinting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id-entropy" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Entropy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id-length" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id-content-or-value" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Content (or Value)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-management-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Session Management Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Management Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-session-management-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Session Management Implementations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#used-vs-accepted-session-id-exchange-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      Used vs. Accepted Session ID Exchange Mechanisms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transport-layer-security" class="md-nav__link">
    <span class="md-ellipsis">
      Transport Layer Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies" class="md-nav__link">
    <span class="md-ellipsis">
      Cookies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cookies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secure-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#httponly-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      HttpOnly Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samesite-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      SameSite Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-and-path-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Domain and Path Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expire-and-max-age-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Expire and Max-Age Attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#html5-web-storage-api" class="md-nav__link">
    <span class="md-ellipsis">
      HTML5 Web Storage API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTML5 Web Storage API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-localstorage-api" class="md-nav__link">
    <span class="md-ellipsis">
      The localStorage API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The localStorage API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duration" class="md-nav__link">
    <span class="md-ellipsis">
      Duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offline-access" class="md-nav__link">
    <span class="md-ellipsis">
      Offline Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case" class="md-nav__link">
    <span class="md-ellipsis">
      Use Case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-sessionstorage-api" class="md-nav__link">
    <span class="md-ellipsis">
      The sessionStorage API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The sessionStorage API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope_1" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offline-access_1" class="md-nav__link">
    <span class="md-ellipsis">
      Offline Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case_1" class="md-nav__link">
    <span class="md-ellipsis">
      Use Case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-workers" class="md-nav__link">
    <span class="md-ellipsis">
      Web Workers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Workers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case_2" class="md-nav__link">
    <span class="md-ellipsis">
      Use Case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-id-life-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Life Cycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session ID Life Cycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-id-generation-and-verification-permissive-and-strict-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Generation and Verification: Permissive and Strict Session Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manage-session-id-as-any-other-user-input" class="md-nav__link">
    <span class="md-ellipsis">
      Manage Session ID as Any Other User Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renew-the-session-id-after-any-privilege-level-change" class="md-nav__link">
    <span class="md-ellipsis">
      Renew the Session ID After Any Privilege Level Change
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#considerations-when-using-multiple-cookies" class="md-nav__link">
    <span class="md-ellipsis">
      Considerations When Using Multiple Cookies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Session Expiration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Expiration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-session-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Session Expiration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Session Expiration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#idle-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Idle Timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#absolute-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Absolute Timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renewal-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Renewal Timeout
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-session-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Session Expiration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Session Expiration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logout-button" class="md-nav__link">
    <span class="md-ellipsis">
      Logout Button
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-content-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Web Content Caching
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-client-side-defenses-for-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Client-Side Defenses for Session Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional Client-Side Defenses for Session Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-login-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Login Timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-session-logout-on-web-browser-window-close-events" class="md-nav__link">
    <span class="md-ellipsis">
      Force Session Logout On Web Browser Window Close Events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-web-browser-cross-tab-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      Disable Web Browser Cross-Tab Sessions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-client-logout" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Client Logout
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-attacks-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Session Attacks Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Attacks Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-id-guessing-and-brute-force-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Guessing and Brute Force Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecting-session-id-anomalies" class="md-nav__link">
    <span class="md-ellipsis">
      Detecting Session ID Anomalies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binding-the-session-id-to-other-user-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Binding the Session ID to Other User Properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-sessions-life-cycle-monitoring-creation-usage-and-destruction-of-session-ids" class="md-nav__link">
    <span class="md-ellipsis">
      Logging Sessions Life Cycle: Monitoring Creation, Usage, and Destruction of Session IDs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simultaneous-session-logons" class="md-nav__link">
    <span class="md-ellipsis">
      Simultaneous Session Logons
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-management-waf-protections" class="md-nav__link">
    <span class="md-ellipsis">
      Session Management WAF Protections
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-id-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session ID Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-id-name-fingerprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Name Fingerprinting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id-entropy" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Entropy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id-length" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id-content-or-value" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Content (or Value)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-management-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Session Management Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Management Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-session-management-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Session Management Implementations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#used-vs-accepted-session-id-exchange-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      Used vs. Accepted Session ID Exchange Mechanisms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transport-layer-security" class="md-nav__link">
    <span class="md-ellipsis">
      Transport Layer Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies" class="md-nav__link">
    <span class="md-ellipsis">
      Cookies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cookies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secure-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#httponly-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      HttpOnly Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samesite-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      SameSite Attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-and-path-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Domain and Path Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expire-and-max-age-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Expire and Max-Age Attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#html5-web-storage-api" class="md-nav__link">
    <span class="md-ellipsis">
      HTML5 Web Storage API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTML5 Web Storage API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-localstorage-api" class="md-nav__link">
    <span class="md-ellipsis">
      The localStorage API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The localStorage API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duration" class="md-nav__link">
    <span class="md-ellipsis">
      Duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offline-access" class="md-nav__link">
    <span class="md-ellipsis">
      Offline Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case" class="md-nav__link">
    <span class="md-ellipsis">
      Use Case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-sessionstorage-api" class="md-nav__link">
    <span class="md-ellipsis">
      The sessionStorage API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The sessionStorage API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope_1" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offline-access_1" class="md-nav__link">
    <span class="md-ellipsis">
      Offline Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case_1" class="md-nav__link">
    <span class="md-ellipsis">
      Use Case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-workers" class="md-nav__link">
    <span class="md-ellipsis">
      Web Workers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Workers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case_2" class="md-nav__link">
    <span class="md-ellipsis">
      Use Case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-id-life-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Life Cycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session ID Life Cycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-id-generation-and-verification-permissive-and-strict-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Generation and Verification: Permissive and Strict Session Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manage-session-id-as-any-other-user-input" class="md-nav__link">
    <span class="md-ellipsis">
      Manage Session ID as Any Other User Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renew-the-session-id-after-any-privilege-level-change" class="md-nav__link">
    <span class="md-ellipsis">
      Renew the Session ID After Any Privilege Level Change
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#considerations-when-using-multiple-cookies" class="md-nav__link">
    <span class="md-ellipsis">
      Considerations When Using Multiple Cookies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Session Expiration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Expiration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-session-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Session Expiration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Session Expiration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#idle-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Idle Timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#absolute-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Absolute Timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renewal-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Renewal Timeout
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-session-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Session Expiration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Session Expiration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logout-button" class="md-nav__link">
    <span class="md-ellipsis">
      Logout Button
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-content-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Web Content Caching
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-client-side-defenses-for-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Client-Side Defenses for Session Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional Client-Side Defenses for Session Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-login-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Login Timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-session-logout-on-web-browser-window-close-events" class="md-nav__link">
    <span class="md-ellipsis">
      Force Session Logout On Web Browser Window Close Events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-web-browser-cross-tab-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      Disable Web Browser Cross-Tab Sessions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-client-logout" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Client Logout
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-attacks-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Session Attacks Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Attacks Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-id-guessing-and-brute-force-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Session ID Guessing and Brute Force Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecting-session-id-anomalies" class="md-nav__link">
    <span class="md-ellipsis">
      Detecting Session ID Anomalies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binding-the-session-id-to-other-user-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Binding the Session ID to Other User Properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-sessions-life-cycle-monitoring-creation-usage-and-destruction-of-session-ids" class="md-nav__link">
    <span class="md-ellipsis">
      Logging Sessions Life Cycle: Monitoring Creation, Usage, and Destruction of Session IDs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simultaneous-session-logons" class="md-nav__link">
    <span class="md-ellipsis">
      Simultaneous Session Logons
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-management-waf-protections" class="md-nav__link">
    <span class="md-ellipsis">
      Session Management WAF Protections
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="session-management-cheat-sheet">Session Management Cheat Sheet<a class="headerlink" href="#session-management-cheat-sheet" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><strong>Web Authentication, Session Management, and Access Control</strong>:</p>
<p>A web session is a sequence of network HTTP request and response transactions associated with the same user. Modern and complex web applications require the retaining of information or status about each user for the duration of multiple requests. Therefore, sessions provide the ability to establish variables – such as access rights and localization settings – which will apply to each and every interaction a user has with the web application for the duration of the session.</p>
<p>Web applications can create sessions to keep track of anonymous users after the very first user request. An example would be maintaining the user language preference. Additionally, web applications will make use of sessions once the user has authenticated. This ensures the ability to identify the user on any subsequent requests as well as being able to apply security access controls, authorized access to the user private data, and to increase the usability of the application. Therefore, current web applications can provide session capabilities both pre and post authentication.</p>
<p>Once an authenticated session has been established, the session ID (or token) is temporarily equivalent to the strongest authentication method used by the application, such as username and password, passphrases, one-time passwords (OTP), client-based digital certificates, smartcards, or biometrics (such as fingerprint or eye retina). See the OWASP <a href="Authentication_Cheat_Sheet.html">Authentication Cheat Sheet</a>.</p>
<p>HTTP is a stateless protocol (<a href="https://www.ietf.org/rfc/rfc2616.txt">RFC2616</a> section 5), where each request and response pair is independent of other web interactions. Therefore, in order to introduce the concept of a session, it is required to implement session management capabilities that link both the authentication and access control (or authorization) modules commonly available in web applications:</p>
<p><img alt="SessionDiagram" src="../assets/Session_Management_Cheat_Sheet_Diagram.png" /></p>
<p>The session ID or token binds the user authentication credentials (in the form of a user session) to the user HTTP traffic and the appropriate access controls enforced by the web application. The complexity of these three components (authentication, session management, and access control) in modern web applications, plus the fact that its implementation and binding resides on the web developer's hands (as web development frameworks do not provide strict relationships between these modules), makes the implementation of a secure session management module very challenging.</p>
<p>The disclosure, capture, prediction, brute force, or fixation of the session ID will lead to session hijacking (or sidejacking) attacks, where an attacker is able to fully impersonate a victim user in the web application. Attackers can perform two types of session hijacking attacks, targeted or generic. In a targeted attack, the attacker's goal is to impersonate a specific (or privileged) web application victim user. For generic attacks, the attacker's goal is to impersonate (or get access as) any valid or legitimate user in the web application.</p>
<h2 id="session-id-properties">Session ID Properties<a class="headerlink" href="#session-id-properties" title="Permanent link">&para;</a></h2>
<p>In order to keep the authenticated state and track the users progress within the web application, applications provide users with a <strong>session identifier</strong> (session ID or token) that is assigned at session creation time, and is shared and exchanged by the user and the web application for the duration of the session (it is sent on every HTTP request). The session ID is a <code>name=value</code> pair.</p>
<p>With the goal of implementing secure session IDs, the generation of identifiers (IDs or tokens) must meet the following properties.</p>
<h3 id="session-id-name-fingerprinting">Session ID Name Fingerprinting<a class="headerlink" href="#session-id-name-fingerprinting" title="Permanent link">&para;</a></h3>
<p>The name used by the session ID should not be extremely descriptive nor offer unnecessary details about the purpose and meaning of the ID.</p>
<p>The session ID names used by the most common web application development frameworks <a href="https://wiki.owasp.org/index.php/Category:OWASP_Cookies_Database">can be easily fingerprinted</a>, such as <code>PHPSESSID</code> (PHP), <code>JSESSIONID</code> (J2EE), <code>CFID</code> &amp; <code>CFTOKEN</code> (ColdFusion), <code>ASP.NET_SessionId</code> (ASP .NET), etc. Therefore, the session ID name can disclose the technologies and programming languages used by the web application.</p>
<p>It is recommended to change the default session ID name of the web development framework to a generic name, such as <code>id</code>.</p>
<h3 id="session-id-entropy">Session ID Entropy<a class="headerlink" href="#session-id-entropy" title="Permanent link">&para;</a></h3>
<p>Session identifiers must have at least <code>64 bits</code> of entropy to prevent brute-force session guessing attacks. Entropy refers to the amount of randomness or unpredictability in a value. Each “bit” of entropy doubles the number of possible outcomes, meaning a session ID with 64 bits of entropy can have <code>2^64</code> possible values.</p>
<p>A strong <a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator">CSPRNG</a> (Cryptographically Secure Pseudorandom Number Generator) must be used to generate session IDs. This ensures the generated values are evenly distributed among all possible values. Otherwise, attackers may be able to use statistisical analysis techniques to identify patterns in how the session IDs are created, effectively reducing the entropy and allowing the attacker to guess or predict valid session IDs more easily.</p>
<p><strong>NOTE</strong>:</p>
<ul>
<li>The expected time for an attacker to brute-force a valid session ID depends on factors such as the number of bits of entropy, the number of active sessions, session expiration times, and the attacker's guessing rate.</li>
<li>If a web application generates session IDs with 64 bits of entropy, an attacker can expect to spend approximately 585 years to successfully guess a valid session ID, assuming the attacker can try 10,000 guesses per second with 100,000 valid simultaneous sessions available in the application.</li>
<li>Further analysis of the expected time for an attacker to brute-force session identifiers is available <a href="https://owasp.org/www-community/vulnerabilities/Insufficient_Session-ID_Length#estimating-attack-time">here</a>.</li>
</ul>
<h3 id="session-id-length">Session ID Length<a class="headerlink" href="#session-id-length" title="Permanent link">&para;</a></h3>
<p>As mentioned in the previous <em>Session ID Entropy</em> section, a primary security requirement for session IDs is that they contain at least <code>64 bits</code> of entropy to prevent brute-force guessing attacks. Although session ID length matters, it's the entropy that ensures security. The session ID must be long enough to encode sufficient entropy, preventing brute force attacks where an attacker guesses valid session IDs.</p>
<p>Different encoding methods can result in different lengths for the same amount of entropy. Session IDs are often represented using hexadecimal encoding. When using hexadecimal encoding, a session ID must be at least 16 hexadecimal characters long to achieve the required 64 bits of entropy.  When using different encodings (e.g. Base64 or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.sessionstate.sessionidmanager?redirectedfrom=MSDN&amp;view=netframework-4.7.2">Microsoft's encoding for ASP.NET session IDs</a>) a different number of characters may be required to represent the minimum 64 bits of entropy.</p>
<p>It’s important to note that if any part of the session ID is fixed or predictable, the effective entropy is reduced, and the length may need to be increased to compensate. For example, if half of a 16-character hexadecimal session ID is fixed, only the remaining 8 characters are random, providing just 32 bits of entropy — which is insufficient for strong security. To maintain security, ensure that the entire session ID is randomly generated and unpredictable, or increase the overall length if parts of the ID are not random.</p>
<p><strong>NOTE</strong>:</p>
<ul>
<li>More information about the relationship between Session ID Length and Session ID Entropy is available <a href="https://owasp.org/www-community/vulnerabilities/Insufficient_Session-ID_Length#session-id-length-and-entropy-relationship">here</a>.</li>
</ul>
<h3 id="session-id-content-or-value">Session ID Content (or Value)<a class="headerlink" href="#session-id-content-or-value" title="Permanent link">&para;</a></h3>
<p>The session ID content (or value) must be meaningless to prevent information disclosure attacks, where an attacker is able to decode the contents of the ID and extract details of the user, the session, or the inner workings of the web application.</p>
<p>The session ID must simply be an identifier on the client side, and its value must never include sensitive information or Personally Identifiable Information (PII). To read more about PII, refer to <a href="https://en.wikipedia.org/wiki/Personally_identifiable_information">Wikipedia</a> or this <a href="https://www.idshield.com/blog/identity-theft/what-pii-and-why-should-i-care/">post</a>.</p>
<p>The meaning and business or application logic associated with the session ID must be stored on the server side, and specifically, in session objects or in a session management database or repository.</p>
<p>The stored information can include the client IP address, User-Agent, e-mail, username, user ID, role, privilege level, access rights, language preferences, account ID, current state, last login, session timeouts, and other internal session details. If the session objects and properties contain sensitive information, such as credit card numbers, it is required to duly encrypt and protect the session management repository.</p>
<p>It is recommended to use the session ID created by your language or framework. If you need to create your own sessionID, use a cryptographically secure pseudorandom number generator (CSPRNG) with a size of at least 128 bits and ensure that each sessionID is unique.</p>
<h2 id="session-management-implementation">Session Management Implementation<a class="headerlink" href="#session-management-implementation" title="Permanent link">&para;</a></h2>
<p>The session management implementation defines the exchange mechanism that will be used between the user and the web application to share and continuously exchange the session ID. There are multiple mechanisms available in HTTP to maintain session state within web applications, such as cookies (standard HTTP header), URL parameters (URL rewriting – <a href="https://www.ietf.org/rfc/rfc2396.txt">RFC2396</a>), URL arguments on GET requests, body arguments on POST requests, such as hidden form fields (HTML forms), or proprietary HTTP headers.</p>
<p>The preferred session ID exchange mechanism should allow defining advanced token properties, such as the token expiration date and time, or granular usage constraints. This is one of the reasons why cookies (RFCs <a href="https://www.ietf.org/rfc/rfc2109.txt">2109</a> &amp; <a href="https://www.ietf.org/rfc/rfc2965.txt">2965</a> &amp; <a href="https://www.ietf.org/rfc/rfc6265.txt">6265</a>) are one of the most extensively used session ID exchange mechanisms, offering advanced capabilities not available in other methods.</p>
<p>The usage of specific session ID exchange mechanisms, such as those where the ID is included in the URL, might disclose the session ID (in web links and logs, web browser history and bookmarks, the Referer header or search engines), as well as facilitate other attacks, such as the manipulation of the ID or <a href="http://www.acrossecurity.com/papers/session_fixation.pdf">session fixation attacks</a>.</p>
<h3 id="built-in-session-management-implementations">Built-in Session Management Implementations<a class="headerlink" href="#built-in-session-management-implementations" title="Permanent link">&para;</a></h3>
<p>Web development frameworks, such as J2EE, ASP .NET, PHP, and others, provide their own session management features and associated implementation. It is recommended to use these built-in frameworks versus building a home made one from scratch, as they are used worldwide on multiple web environments and have been tested by the web application security and development communities over time.</p>
<p>However, be advised that these frameworks have also presented vulnerabilities and weaknesses in the past, so it is always recommended to use the latest version available, that potentially fixes all the well-known vulnerabilities, as well as review and change the default configuration to enhance its security by following the recommendations described along this document.</p>
<p>The storage capabilities or repository used by the session management mechanism to temporarily save the session IDs must be secure, protecting the session IDs against local or remote accidental disclosure or unauthorized access.</p>
<h3 id="used-vs-accepted-session-id-exchange-mechanisms">Used vs. Accepted Session ID Exchange Mechanisms<a class="headerlink" href="#used-vs-accepted-session-id-exchange-mechanisms" title="Permanent link">&para;</a></h3>
<p>A web application should make use of cookies for session ID exchange management. If a user submits a session ID through a different exchange mechanism, such as a URL parameter, the web application should avoid accepting it as part of a defensive strategy to stop session fixation.</p>
<p><strong>NOTE</strong>:</p>
<ul>
<li>Even if a web application makes use of cookies as its default session ID exchange mechanism, it might accept other exchange mechanisms too.</li>
<li>It is therefore required to confirm via thorough testing all the different mechanisms currently accepted by the web application when processing and managing session IDs, and limit the accepted session ID tracking mechanisms to just cookies.</li>
<li>In the past, some web applications used URL parameters, or even switched from cookies to URL parameters (via automatic URL rewriting), if certain conditions are met (for example, the identification of web clients without support for cookies or not accepting cookies due to user privacy concerns).</li>
</ul>
<h3 id="transport-layer-security">Transport Layer Security<a class="headerlink" href="#transport-layer-security" title="Permanent link">&para;</a></h3>
<p>In order to protect the session ID exchange from active eavesdropping and passive disclosure in the network traffic, it is essential to use an encrypted HTTPS (TLS) connection for the entire web session, not only for the authentication process where the user credentials are exchanged. This may be mitigated by <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html">HTTP Strict Transport Security (HSTS)</a> for a client that supports it.</p>
<p>Additionally, the <code>Secure</code> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Secure_and_HttpOnly_cookies">cookie attribute</a> must be used to ensure the session ID is only exchanged through an encrypted channel. The usage of an encrypted communication channel also protects the session against some session fixation attacks where the attacker is able to intercept and manipulate the web traffic to inject (or fix) the session ID on the victim's web browser (see <a href="https://media.blackhat.com/bh-eu-11/Raul_Siles/BlackHat_EU_2011_Siles_SAP_Session-Slides.pdf">here</a> and <a href="https://media.blackhat.com/bh-eu-11/Raul_Siles/BlackHat_EU_2011_Siles_SAP_Session-WP.pdf">here</a>).</p>
<p>The following set of best practices are focused on protecting the session ID (specifically when cookies are used) and helping with the integration of HTTPS within the web application:</p>
<ul>
<li>Do not switch a given session from HTTP to HTTPS, or vice-versa, as this will disclose the session ID in the clear through the network.<ul>
<li>When redirecting to HTTPS, ensure that the cookie is set or regenerated <strong>after</strong> the redirect has occurred.</li>
</ul>
</li>
<li>Do not mix encrypted and unencrypted contents (HTML pages, images, CSS, JavaScript files, etc) in the same page, or from the same domain.</li>
<li>Where possible, avoid offering public unencrypted contents and private encrypted contents from the same host. Where insecure content is required, consider hosting this on a separate insecure domain.</li>
<li>Implement <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html">HTTP Strict Transport Security (HSTS)</a> to enforce HTTPS connections.</li>
</ul>
<p>See the OWASP <a href="Transport_Layer_Security_Cheat_Sheet.html">Transport Layer Security Cheat Sheet</a> for more general guidance on implementing TLS securely.</p>
<p>It is important to emphasize that TLS does not protect against session ID prediction, brute force, client-side tampering or fixation; however, it does provide effective protection against an attacker intercepting or stealing session IDs through a man in the middle attack.</p>
<h2 id="cookies">Cookies<a class="headerlink" href="#cookies" title="Permanent link">&para;</a></h2>
<p>The session ID exchange mechanism based on cookies provides multiple security features in the form of cookie attributes that can be used to protect the exchange of the session ID:</p>
<h3 id="secure-attribute">Secure Attribute<a class="headerlink" href="#secure-attribute" title="Permanent link">&para;</a></h3>
<p>The <code>Secure</code> cookie attribute instructs web browsers to only send the cookie through an encrypted HTTPS (SSL/TLS) connection. This session protection mechanism is mandatory to prevent the disclosure of the session ID through MitM (Man-in-the-Middle) attacks. It ensures that an attacker cannot simply capture the session ID from web browser traffic.</p>
<p>Forcing the web application to only use HTTPS for its communication (even when port TCP/80, HTTP, is closed in the web application host) does not protect against session ID disclosure if the <code>Secure</code> cookie has not been set - the web browser can be deceived to disclose the session ID over an unencrypted HTTP connection. The attacker can intercept and manipulate the victim user traffic and inject an HTTP unencrypted reference to the web application that will force the web browser to submit the session ID in the clear.</p>
<p>See also: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Secure_and_HttpOnly_cookies">SecureFlag</a></p>
<h3 id="httponly-attribute">HttpOnly Attribute<a class="headerlink" href="#httponly-attribute" title="Permanent link">&para;</a></h3>
<p>The <code>HttpOnly</code> cookie attribute instructs web browsers not to allow scripts (e.g. JavaScript or VBscript) an ability to access the cookies via the DOM document.cookie object. This session ID protection is mandatory to prevent session ID stealing through XSS attacks. However, if an XSS attack is combined with a CSRF attack, the requests sent to the web application will include the session cookie, as the browser always includes the cookies when sending requests. The <code>HttpOnly</code> cookie only protects the confidentiality of the cookie; the attacker cannot use it offline, outside of the context of an XSS attack.</p>
<p>See the OWASP <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html">XSS (Cross Site Scripting) Prevention Cheat Sheet</a>.</p>
<p>See also: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Secure_and_HttpOnly_cookies">HttpOnly</a></p>
<h3 id="samesite-attribute">SameSite Attribute<a class="headerlink" href="#samesite-attribute" title="Permanent link">&para;</a></h3>
<p>SameSite defines a cookie attribute preventing browsers from sending a SameSite flagged cookie with cross-site requests. The main goal is to mitigate the risk of cross-origin information leakage, and provides some protection against cross-site request forgery attacks.</p>
<p>See also: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#SameSite_cookies">SameSite</a></p>
<h3 id="domain-and-path-attributes">Domain and Path Attributes<a class="headerlink" href="#domain-and-path-attributes" title="Permanent link">&para;</a></h3>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Directives"><code>Domain</code> cookie attribute</a> instructs web browsers to only send the cookie to the specified domain and all subdomains. If the attribute is not set, by default the cookie will only be sent to the origin server. The <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Directives"><code>Path</code> cookie attribute</a> instructs web browsers to only send the cookie to the specified directory or subdirectories (or paths or resources) within the web application. If the attribute is not set, by default the cookie will only be sent for the directory (or path) of the resource requested and setting the cookie.</p>
<p>It is recommended to use a narrow or restricted scope for these two attributes. In this way, the <code>Domain</code> attribute should not be set (restricting the cookie just to the origin server) and the <code>Path</code> attribute should be set as restrictive as possible to the web application path that makes use of the session ID.</p>
<p>Setting the <code>Domain</code> attribute to a too permissive value, such as <code>example.com</code> allows an attacker to launch attacks on the session IDs between different hosts and web applications belonging to the same domain, known as cross-subdomain cookies. For example, vulnerabilities in <code>www.example.com</code> might allow an attacker to get access to the session IDs from <code>secure.example.com</code>.</p>
<p>Additionally, it is recommended not to mix web applications of different security levels on the same domain. Vulnerabilities in one of the web applications would allow an attacker to set the session ID for a different web application on the same domain by using a permissive <code>Domain</code> attribute (such as <code>example.com</code>) which is a technique that can be used in <a href="http://www.acrossecurity.com/papers/session_fixation.pdf">session fixation attacks</a>.</p>
<p>Although the <code>Path</code> attribute allows the isolation of session IDs between different web applications using different paths on the same host, it is highly recommended not to run different web applications (especially from different security levels or scopes) on the same host. Other methods can be used by these applications to access the session IDs, such as the <code>document.cookie</code> object. Also, any web application can set cookies for any path on that host.</p>
<p>Cookies are vulnerable to DNS spoofing/hijacking/poisoning attacks, where an attacker can manipulate the DNS resolution to force the web browser to disclose the session ID for a given host or domain.</p>
<h3 id="expire-and-max-age-attributes">Expire and Max-Age Attributes<a class="headerlink" href="#expire-and-max-age-attributes" title="Permanent link">&para;</a></h3>
<p>Session management mechanisms based on cookies can make use of two types of cookies, non-persistent (or session) cookies, and persistent cookies. If a cookie presents the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Directives"><code>Max-Age</code></a> (that has preference over <code>Expires</code>) or <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Directives"><code>Expires</code></a> attributes, it will be considered a persistent cookie and will be stored on disk by the web browser based until the expiration time.</p>
<p>Typically, session management capabilities to track users after authentication make use of non-persistent cookies. This forces the session to disappear from the client if the current web browser instance is closed. Therefore, it is highly recommended to use non-persistent cookies for session management purposes, so that the session ID does not remain on the web client cache for long periods of time, from where an attacker can obtain it.</p>
<ul>
<li>Ensure that sensitive information is not compromised by ensuring that it is not persistent, encrypting it, and storing it only for the duration of the need</li>
<li>Ensure that unauthorized activities cannot take place via cookie manipulation</li>
<li>Ensure secure flag is set to prevent accidental transmission over the wire in a non-secure manner</li>
<li>Determine if all state transitions in the application code properly check for the cookies and enforce their use</li>
<li>Ensure entire cookie should be encrypted if sensitive data is persisted in the cookie</li>
<li>Define all cookies being used by the application, their name and why they are needed</li>
</ul>
<h2 id="html5-web-storage-api">HTML5 Web Storage API<a class="headerlink" href="#html5-web-storage-api" title="Permanent link">&para;</a></h2>
<p>The Web Hypertext Application Technology Working Group (WHATWG) describes the HTML5 Web Storage APIs, <code>localStorage</code> and <code>sessionStorage</code>, as mechanisms for storing name-value pairs client-side.
Unlike HTTP cookies, the contents of <code>localStorage</code> and <code>sessionStorage</code> are not automatically shared within requests or responses by the browser and are used for storing data client-side.</p>
<h3 id="the-localstorage-api">The localStorage API<a class="headerlink" href="#the-localstorage-api" title="Permanent link">&para;</a></h3>
<h4 id="scope">Scope<a class="headerlink" href="#scope" title="Permanent link">&para;</a></h4>
<p>Data stored using the <code>localStorage</code> API is accessible by pages which are loaded from the same origin, which is defined as the scheme (<code>https://</code>), host (<code>example.com</code>), port (<code>443</code>) and domain/realm (<code>example.com</code>).
This provides similar access to this data as would be achieved by using the <code>secure</code> flag on a cookie, meaning that data stored from <code>https</code> could not be retrieved via <code>http</code>. Due to potential concurrent access from separate windows/threads, data stored using <code>localStorage</code> may be susceptible to shared access issues (such as race-conditions) and should be considered non-locking (<a href="https://html.spec.whatwg.org/multipage/webstorage.html#the-localstorage-attribute">Web Storage API Spec</a>).</p>
<h4 id="duration">Duration<a class="headerlink" href="#duration" title="Permanent link">&para;</a></h4>
<p>Data stored using the <code>localStorage</code> API is persisted across browsing sessions, extending the timeframe in which it may be accessible to other system users.</p>
<h4 id="offline-access">Offline Access<a class="headerlink" href="#offline-access" title="Permanent link">&para;</a></h4>
<p>The standards do not require <code>localStorage</code> data to be encrypted-at-rest, meaning it may be possible to directly access this data from disk.</p>
<h4 id="use-case">Use Case<a class="headerlink" href="#use-case" title="Permanent link">&para;</a></h4>
<p>WHATWG suggests the use of <code>localStorage</code> for data that needs to be accessed across windows or tabs, across multiple sessions, and where large (multi-megabyte) volumes of data may need to be stored for performance reasons.</p>
<h3 id="the-sessionstorage-api">The sessionStorage API<a class="headerlink" href="#the-sessionstorage-api" title="Permanent link">&para;</a></h3>
<h4 id="scope_1">Scope<a class="headerlink" href="#scope_1" title="Permanent link">&para;</a></h4>
<p>The <code>sessionStorage</code> API stores data within the window context from which it was called, meaning that Tab 1 cannot access data which was stored from Tab 2.
Also, like the <code>localStorage</code> API, data stored using the <code>sessionStorage</code> API is accessible by pages which are loaded from the same origin, which is defined as the scheme (<code>https://</code>), host (<code>example.com</code>), port (<code>443</code>) and domain/realm (<code>example.com</code>).
This provides similar access to this data as would be achieved by using the <code>secure</code> flag on a cookie, meaning that data stored from <code>https</code> could not be retrieved via <code>http</code>.</p>
<h4 id="duration_1">Duration<a class="headerlink" href="#duration_1" title="Permanent link">&para;</a></h4>
<p>The <code>sessionStorage</code> API only stores data for the duration of the current browsing session. Once the tab is closed, that data is no longer retrievable. This does not necessarily prevent access, should a browser tab be reused or left open. Data may also persist in memory until a garbage collection event.</p>
<h4 id="offline-access_1">Offline Access<a class="headerlink" href="#offline-access_1" title="Permanent link">&para;</a></h4>
<p>The standards do not require <code>sessionStorage</code> data to be encrypted-at-rest, meaning it may be possible to directly access this data from disk.</p>
<h4 id="use-case_1">Use Case<a class="headerlink" href="#use-case_1" title="Permanent link">&para;</a></h4>
<p>WHATWG suggests the use of <code>sessionStorage</code> for data that is relevant for one-instance of a workflow, such as details for a ticket booking, but where multiple workflows could be performed in other tabs concurrently. The window/tab bound nature will keep the data from leaking between workflows in separate tabs.</p>
<h3 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API">Web Storage APIs</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">LocalStorage API</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage">SessionStorage API</a></li>
<li><a href="https://html.spec.whatwg.org/multipage/webstorage.html#webstorage">WHATWG Web Storage Spec</a></li>
</ul>
<h2 id="web-workers">Web Workers<a class="headerlink" href="#web-workers" title="Permanent link">&para;</a></h2>
<p>Web Workers run JavaScript code in a global context separate from the one of the current window. A communication channel with the main execution window exists, which is called <code>MessageChannel</code>.</p>
<h3 id="use-case_2">Use Case<a class="headerlink" href="#use-case_2" title="Permanent link">&para;</a></h3>
<p>Web Workers are an alternative for browser storage of (session) secrets when storage persistence across page refresh is not a requirement. For Web Workers to provide secure browser storage, any code that requires the secret should exist within the Web Worker and the secret should never be transmitted to the main window context.</p>
<p>Storing secrets within the memory of a Web Worker offers the same security guarantees as an HttpOnly cookie: the confidentiality of the secret is protected. Still, an XSS attack can be used to send messages to the Web Worker to perform an operation that requires the secret. The Web Worker will return the result of the operation to the main execution thread.</p>
<p>The advantage of a Web Worker implementation compared to an HttpOnly cookie is that a Web Worker allows for some isolated JavaScript code to access the secret; an HttpOnly cookie is not accessible to any JavaScript. If the frontend JavaScript code requires access to the secret, the Web Worker implementation is the only browser storage option that preserves the secret confidentiality.</p>
<h2 id="session-id-life-cycle">Session ID Life Cycle<a class="headerlink" href="#session-id-life-cycle" title="Permanent link">&para;</a></h2>
<h3 id="session-id-generation-and-verification-permissive-and-strict-session-management">Session ID Generation and Verification: Permissive and Strict Session Management<a class="headerlink" href="#session-id-generation-and-verification-permissive-and-strict-session-management" title="Permanent link">&para;</a></h3>
<p>There are two types of session management mechanisms for web applications, permissive and strict, related to session fixation vulnerabilities. The permissive mechanism allows the web application to initially accept any session ID value set by the user as valid, creating a new session for it, while the strict mechanism enforces that the web application will only accept session ID values that have been previously generated by the web application.</p>
<p>The session tokens should be handled by the web server if possible or generated via a cryptographically secure random number generator.</p>
<p>Although the most common mechanism in use today is the strict one (more secure), <a href="https://wiki.php.net/rfc/session-use-strict-mode">PHP defaults to permissive</a>. Developers must ensure that the web application does not use a permissive mechanism under certain circumstances. Web applications should never accept a session ID they have never generated, and in case of receiving one, they should generate and offer the user a new valid session ID. Additionally, this scenario should be detected as a suspicious activity and an alert should be generated.</p>
<h3 id="manage-session-id-as-any-other-user-input">Manage Session ID as Any Other User Input<a class="headerlink" href="#manage-session-id-as-any-other-user-input" title="Permanent link">&para;</a></h3>
<p>Session IDs must be considered untrusted, as any other user input processed by the web application, and they must be thoroughly validated and verified. Depending on the session management mechanism used, the session ID will be received in a GET or POST parameter, in the URL or in an HTTP header (e.g. cookies). If web applications do not validate and filter out invalid session ID values before processing them, they can potentially be used to exploit other web vulnerabilities, such as SQL injection if the session IDs are stored on a relational database, or persistent XSS if the session IDs are stored and reflected back afterwards by the web application.</p>
<h3 id="renew-the-session-id-after-any-privilege-level-change">Renew the Session ID After Any Privilege Level Change<a class="headerlink" href="#renew-the-session-id-after-any-privilege-level-change" title="Permanent link">&para;</a></h3>
<p>The session ID must be renewed or regenerated by the web application after any privilege level change within the associated user session. The most common scenario where the session ID regeneration is mandatory is during the authentication process, as the privilege level of the user changes from the unauthenticated (or anonymous) state to the authenticated state though in some cases still not yet the authorized state. Common scenarios to consider include; password changes, permission changes, or switching from a regular user role to an administrator role within the web application. For all sensitive pages of the web application, any previous session IDs must be ignored, only the current session ID must be assigned to every new request received for the protected resource, and the old or previous session ID must be destroyed.</p>
<p>The most common web development frameworks provide session functions and methods to renew the session ID, such as <code>request.getSession(true)</code> &amp; <code>HttpSession.invalidate()</code> (J2EE), <code>Session.Abandon()</code> &amp; <code>Response.Cookies.Add(new...)</code> (ASP .NET), or <code>session_start()</code> &amp; <code>session_regenerate_id(true)</code> (PHP).</p>
<p>The session ID regeneration is mandatory to prevent <a href="http://www.acrossecurity.com/papers/session_fixation.pdf">session fixation attacks</a>, where an attacker sets the session ID on the victim user's web browser instead of gathering the victim's session ID, as in most of the other session-based attacks, and independently of using HTTP or HTTPS. This protection mitigates the impact of other web-based vulnerabilities that can also be used to launch session fixation attacks, such as HTTP response splitting or XSS (see <a href="https://media.blackhat.com/bh-eu-11/Raul_Siles/BlackHat_EU_2011_Siles_SAP_Session-Slides.pdf">here</a> and <a href="https://media.blackhat.com/bh-eu-11/Raul_Siles/BlackHat_EU_2011_Siles_SAP_Session-WP.pdf">here</a>).</p>
<p>A complementary recommendation is to use a different session ID or token name (or set of session IDs) pre and post authentication, so that the web application can keep track of anonymous users and authenticated users without the risk of exposing or binding the user session between both states.</p>
<h3 id="considerations-when-using-multiple-cookies">Considerations When Using Multiple Cookies<a class="headerlink" href="#considerations-when-using-multiple-cookies" title="Permanent link">&para;</a></h3>
<p>If the web application uses cookies as the session ID exchange mechanism, and multiple cookies are set for a given session, the web application must verify all cookies (and enforce relationships between them) before allowing access to the user session.</p>
<p>It is very common for web applications to set a user cookie pre-authentication over HTTP to keep track of unauthenticated (or anonymous) users. Once the user authenticates in the web application, a new post-authentication secure cookie is set over HTTPS, and a binding between both cookies and the user session is established. If the web application does not verify both cookies for authenticated sessions, an attacker can make use of the pre-authentication unprotected cookie to get access to the authenticated user session (see <a href="https://media.blackhat.com/bh-eu-11/Raul_Siles/BlackHat_EU_2011_Siles_SAP_Session-Slides.pdf">here</a> and <a href="https://media.blackhat.com/bh-eu-11/Raul_Siles/BlackHat_EU_2011_Siles_SAP_Session-WP.pdf">here</a>).</p>
<p>Web applications should try to avoid the same cookie name for different paths or domain scopes within the same web application, as this increases the complexity of the solution and potentially introduces scoping issues.</p>
<h2 id="session-expiration">Session Expiration<a class="headerlink" href="#session-expiration" title="Permanent link">&para;</a></h2>
<p>In order to minimize the time period an attacker can launch attacks over active sessions and hijack them, it is mandatory to set expiration timeouts for every session, establishing the amount of time a session will remain active. Insufficient session expiration by the web application increases the exposure of other session-based attacks, as for the attacker to be able to reuse a valid session ID and hijack the associated session, it must still be active.</p>
<p>The shorter the session interval is, the lesser the time an attacker has to use the valid session ID. The session expiration timeout values must be set accordingly with the purpose and nature of the web application, and balance security and usability, so that the user can comfortably complete the operations within the web application without the session frequently expiring.</p>
<p>Both the idle and absolute timeout values are highly dependent on how critical the web application and its data are. Common idle timeouts ranges are 2-5 minutes for high-value applications and 15-30 minutes for low risk applications. Absolute timeouts depend on how long a user usually uses the application. If the application is intended to be used by an office worker for a full day, an appropriate absolute timeout range could be between 4 and 8 hours.</p>
<p>When a session expires, the web application must take active actions to invalidate the session on both sides, client and server. The latter is the most relevant and mandatory from a security perspective.</p>
<p>For most session exchange mechanisms, client side actions to invalidate the session ID are based on clearing out the token value. For example, to invalidate a cookie it is recommended to provide an empty (or invalid) value for the session ID, and set the <code>Expires</code> (or <code>Max-Age</code>) attribute to a date from the past (in case a persistent cookie is being used): <code>Set-Cookie: id=; Expires=Friday, 17-May-03 18:45:00 GMT</code></p>
<p>In order to close and invalidate the session on the server side, it is mandatory for the web application to take active actions when the session expires, or the user actively logs out, by using the functions and methods offered by the session management mechanisms, such as <code>HttpSession.invalidate()</code> (J2EE), <code>Session.Abandon()</code> (ASP .NET) or <code>session_destroy()/unset()</code> (PHP).</p>
<h3 id="automatic-session-expiration">Automatic Session Expiration<a class="headerlink" href="#automatic-session-expiration" title="Permanent link">&para;</a></h3>
<h4 id="idle-timeout">Idle Timeout<a class="headerlink" href="#idle-timeout" title="Permanent link">&para;</a></h4>
<p>All sessions should implement an idle or inactivity timeout. This timeout defines the amount of time a session will remain active in case there is no activity in the session, closing and invalidating the session upon the defined idle period since the last HTTP request received by the web application for a given session ID.</p>
<p>The idle timeout limits the chances an attacker has to guess and use a valid session ID from another user. However, if the attacker is able to hijack a given session, the idle timeout does not limit the attacker's actions, as they can generate activity on the session periodically to keep the session active for longer periods of time.</p>
<p>Session timeout management and expiration must be enforced server-side. If the client is used to enforce the session timeout, for example using the session token or other client parameters to track time references (e.g. number of minutes since login time), an attacker could manipulate these to extend the session duration.</p>
<h4 id="absolute-timeout">Absolute Timeout<a class="headerlink" href="#absolute-timeout" title="Permanent link">&para;</a></h4>
<p>All sessions should implement an absolute timeout, regardless of session activity. This timeout defines the maximum amount of time a session can be active, closing and invalidating the session upon the defined absolute period since the given session was initially created by the web application. After invalidating the session, the user is forced to (re)authenticate again in the web application and establish a new session.</p>
<p>The absolute session limits the amount of time an attacker can use a hijacked session and impersonate the victim user.</p>
<h4 id="renewal-timeout">Renewal Timeout<a class="headerlink" href="#renewal-timeout" title="Permanent link">&para;</a></h4>
<p>Alternatively, the web application can implement an additional renewal timeout after which the session ID is automatically renewed, in the middle of the user session, and independently of the session activity and, therefore, of the idle timeout.</p>
<p>After a specific amount of time since the session was initially created, the web application can regenerate a new ID for the user session and try to set it, or renew it, on the client. The previous session ID value would still be valid for some time, accommodating a safety interval, before the client is aware of the new ID and starts using it. At that time, when the client switches to the new ID inside the current session, the application invalidates the previous ID.</p>
<p>This scenario minimizes the amount of time a given session ID value, potentially obtained by an attacker, can be reused to hijack the user session, even when the victim user session is still active. The user session remains alive and open on the legitimate client, although its associated session ID value is transparently renewed periodically during the session duration, every time the renewal timeout expires. Therefore, the renewal timeout complements the idle and absolute timeouts, specially when the absolute timeout value extends significantly over time (e.g. it is an application requirement to keep the user sessions open for long periods of time).</p>
<p>Depending on the implementation, potentially there could be a race condition where the attacker with a still valid previous session ID sends a request before the victim user, right after the renewal timeout has just expired, and obtains first the value for the renewed session ID. At least in this scenario, the victim user might be aware of the attack as the session will be suddenly terminated because the associated session ID is not valid anymore.</p>
<h3 id="manual-session-expiration">Manual Session Expiration<a class="headerlink" href="#manual-session-expiration" title="Permanent link">&para;</a></h3>
<p>Web applications should provide mechanisms that allow security aware users to actively close their session once they have finished using the web application.</p>
<h4 id="logout-button">Logout Button<a class="headerlink" href="#logout-button" title="Permanent link">&para;</a></h4>
<p>Web applications must provide a visible and easily accessible logout (logoff, exit, or close session) button that is available on the web application header or menu and reachable from every web application resource and page, so that the user can manually close the session at any time. As described in <em>Session_Expiration</em> section, the web application must invalidate the session at least on server side.</p>
<p><strong>NOTE</strong>: Unfortunately, not all web applications facilitate users to close their current session. Thus, client-side enhancements allow conscientious users to protect their sessions by helping to close them diligently.</p>
<h3 id="web-content-caching">Web Content Caching<a class="headerlink" href="#web-content-caching" title="Permanent link">&para;</a></h3>
<p>Even after the session has been closed, it might be possible to access the private or sensitive data exchanged within the session through the web browser cache. Therefore, web applications must use restrictive cache directives for all the web traffic exchanged through HTTP and HTTPS, such as the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control"><code>Cache-Control</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Pragma"><code>Pragma</code></a> HTTP headers, and/or equivalent META tags on all or (at least) sensitive web pages.</p>
<p>Independently of the cache policy defined by the web application, if caching web application contents is allowed, the session IDs must never be cached, so it is highly recommended to use the <code>Cache-Control: no-cache="Set-Cookie, Set-Cookie2"</code> directive, to allow web clients to cache everything except the session ID (see <a href="https://stackoverflow.com/a/41352418">here</a>).</p>
<h2 id="additional-client-side-defenses-for-session-management">Additional Client-Side Defenses for Session Management<a class="headerlink" href="#additional-client-side-defenses-for-session-management" title="Permanent link">&para;</a></h2>
<p>Web applications can complement the previously described session management defenses with additional countermeasures on the client side. Client-side protections, typically in the form of JavaScript checks and verifications, are not bullet proof and can easily be defeated by a skilled attacker, but can introduce another layer of defense that has to be bypassed by intruders.</p>
<h3 id="initial-login-timeout">Initial Login Timeout<a class="headerlink" href="#initial-login-timeout" title="Permanent link">&para;</a></h3>
<p>Web applications can use JavaScript code in the login page to evaluate and measure the amount of time since the page was loaded and a session ID was granted. If a login attempt is tried after a specific amount of time, the client code can notify the user that the maximum amount of time to log in has passed and reload the login page, hence retrieving a new session ID.</p>
<p>This extra protection mechanism tries to force the renewal of the session ID pre-authentication, avoiding scenarios where a previously used (or manually set) session ID is reused by the next victim using the same computer, for example, in session fixation attacks.</p>
<h3 id="force-session-logout-on-web-browser-window-close-events">Force Session Logout On Web Browser Window Close Events<a class="headerlink" href="#force-session-logout-on-web-browser-window-close-events" title="Permanent link">&para;</a></h3>
<p>Web applications can use JavaScript code to capture all the web browser tab or window close (or even back) events and take the appropriate actions to close the current session before closing the web browser, emulating that the user has manually closed the session via the logout button.</p>
<h3 id="disable-web-browser-cross-tab-sessions">Disable Web Browser Cross-Tab Sessions<a class="headerlink" href="#disable-web-browser-cross-tab-sessions" title="Permanent link">&para;</a></h3>
<p>Web applications can use JavaScript code once the user has logged in and a session has been established to force the user to re-authenticate if a new web browser tab or window is opened against the same web application. The web application does not want to allow multiple web browser tabs or windows to share the same session. Therefore, the application tries to force the web browser to not share the same session ID simultaneously between them.</p>
<p><strong>NOTE</strong>: This mechanism cannot be implemented if the session ID is exchanged through cookies, as cookies are shared by all web browser tabs/windows.</p>
<h3 id="automatic-client-logout">Automatic Client Logout<a class="headerlink" href="#automatic-client-logout" title="Permanent link">&para;</a></h3>
<p>JavaScript code can be used by the web application in all (or critical) pages to automatically logout client sessions after the idle timeout expires, for example, by redirecting the user to the logout page (the same resource used by the logout button mentioned previously).</p>
<p>The benefit of enhancing the server-side idle timeout functionality with client-side code is that the user can see that the session has finished due to inactivity, or even can be notified in advance that the session is about to expire through a count down timer and warning messages. This user-friendly approach helps to avoid loss of work in web pages that require extensive input data due to server-side silently expired sessions.</p>
<h2 id="session-attacks-detection">Session Attacks Detection<a class="headerlink" href="#session-attacks-detection" title="Permanent link">&para;</a></h2>
<h3 id="session-id-guessing-and-brute-force-detection">Session ID Guessing and Brute Force Detection<a class="headerlink" href="#session-id-guessing-and-brute-force-detection" title="Permanent link">&para;</a></h3>
<p>If an attacker tries to guess or brute force a valid session ID, they need to launch multiple sequential requests against the target web application using different session IDs from a single (or set of) IP address(es). Additionally, if an attacker tries to analyze the predictability of the session ID (e.g. using statistical analysis), they need to launch multiple sequential requests from a single (or set of) IP address(es) against the target web application to gather new valid session IDs.</p>
<p>Web applications must be able to detect both scenarios based on the number of attempts to gather (or use) different session IDs and alert and/or block the offending IP address(es).</p>
<h3 id="detecting-session-id-anomalies">Detecting Session ID Anomalies<a class="headerlink" href="#detecting-session-id-anomalies" title="Permanent link">&para;</a></h3>
<p>Web applications should focus on detecting anomalies associated to the session ID, such as its manipulation. The OWASP <a href="https://owasp.org/www-project-appsensor/">AppSensor Project</a> provides a framework and methodology to implement built-in intrusion detection capabilities within web applications focused on the detection of anomalies and unexpected behaviors, in the form of detection points and response actions. Instead of using external protection layers, sometimes the business logic details and advanced intelligence are only available from inside the web application, where it is possible to establish multiple session related detection points, such as when an existing cookie is modified or deleted, a new cookie is added, the session ID from another user is reused, or when the user location or User-Agent changes in the middle of a session.</p>
<h3 id="binding-the-session-id-to-other-user-properties">Binding the Session ID to Other User Properties<a class="headerlink" href="#binding-the-session-id-to-other-user-properties" title="Permanent link">&para;</a></h3>
<p>With the goal of detecting (and, in some scenarios, protecting against) user misbehaviors and session hijacking, it is highly recommended to bind the session ID to other user or client properties, such as the client IP address, User-Agent, or client-based digital certificate. If the web application detects any change or anomaly between these different properties in the middle of an established session, this is a very good indicator of session manipulation and hijacking attempts, and this simple fact can be used to alert and/or terminate the suspicious session.</p>
<p>Although these properties cannot be used by web applications to trustingly defend against session attacks, they significantly increase the web application detection (and protection) capabilities. However, a skilled attacker can bypass these controls by reusing the same IP address assigned to the victim user by sharing the same network (very common in NAT environments, like Wi-Fi hotspots) or by using the same outbound web proxy (very common in corporate environments), or by manually modifying the User-Agent to look exactly like the victim user's.</p>
<h3 id="logging-sessions-life-cycle-monitoring-creation-usage-and-destruction-of-session-ids">Logging Sessions Life Cycle: Monitoring Creation, Usage, and Destruction of Session IDs<a class="headerlink" href="#logging-sessions-life-cycle-monitoring-creation-usage-and-destruction-of-session-ids" title="Permanent link">&para;</a></h3>
<p>Web applications should increase their logging capabilities by including information regarding the full life cycle of sessions. In particular, it is recommended to record session related events, such as the creation, renewal, and destruction of session IDs, as well as details about its usage within login and logout operations, privilege level changes within the session, timeout expiration, invalid session activities (when detected), and critical business operations during the session.</p>
<p>The log details might include a timestamp, source IP address, web target resource requested (and involved in a session operation), HTTP headers (including the User-Agent and Referer), GET and POST parameters, error codes and messages, username (or user ID), plus the session ID (cookies, URL, GET, POST…).</p>
<p>Sensitive data like the session ID should not be included in the logs in order to protect the session logs against session ID local or remote disclosure or unauthorized access. However, some kind of session-specific information must be logged in order to correlate log entries to specific sessions. It is recommended to log a salted-hash of the session ID instead of the session ID itself in order to allow for session-specific log correlation without exposing the session ID.</p>
<p>In particular, web applications must thoroughly protect administrative interfaces that allow to manage all the current active sessions. Frequently these are used by support personnel to solve session related issues, or even general issues, by impersonating the user and looking at the web application as the user does.</p>
<p>The session logs become one of the main web application intrusion detection data sources, and can also be used by intrusion protection systems to automatically terminate sessions and/or disable user accounts when (one or many) attacks are detected. If active protections are implemented, these defensive actions must be logged too.</p>
<h3 id="simultaneous-session-logons">Simultaneous Session Logons<a class="headerlink" href="#simultaneous-session-logons" title="Permanent link">&para;</a></h3>
<p>It is the web application design decision to determine if multiple simultaneous logons from the same user are allowed from the same or from different client IP addresses. If the web application does not want to allow simultaneous session logons, it must take effective actions after each new authentication event, implicitly terminating the previously available session, or asking the user (through the old, new or both sessions) about the session that must remain active.</p>
<p>It is recommended for web applications to add user capabilities that allow checking the details of active sessions at any time, monitor and alert the user about concurrent logons, provide user features to remotely terminate sessions manually, and track account activity history (logbook) by recording multiple client details such as IP address, User-Agent, login date and time, idle time, etc.</p>
<h2 id="session-management-waf-protections">Session Management WAF Protections<a class="headerlink" href="#session-management-waf-protections" title="Permanent link">&para;</a></h2>
<p>There are situations where the web application source code is not available or cannot be modified, or when the changes required to implement the multiple security recommendations and best practices detailed above imply a full redesign of the web application architecture, and therefore, cannot be easily implemented in the short term.</p>
<p>In these scenarios, or to complement the web application defenses, and with the goal of keeping the web application as secure as possible, it is recommended to use external protections such as Web Application Firewalls (WAFs) that can mitigate the session management threats already described.</p>
<p>Web Application Firewalls offer detection and protection capabilities against session based attacks. On the one hand, it is trivial for WAFs to enforce the usage of security attributes on cookies, such as the <code>Secure</code> and <code>HttpOnly</code> flags, applying basic rewriting rules on the <code>Set-Cookie</code> header for all the web application responses that set a new cookie.</p>
<p>On the other hand, more advanced capabilities can be implemented to allow the WAF to keep track of sessions, and the corresponding session IDs, and apply all kind of protections against session fixation (by renewing the session ID on the client-side when privilege changes are detected), enforcing sticky sessions (by verifying the relationship between the session ID and other client properties, like the IP address or User-Agent), or managing session expiration (by forcing both the client and the web application to finalize the session).</p>
<p>The open-source ModSecurity WAF, plus the OWASP <a href="https://owasp.org/www-project-modsecurity-core-rule-set/">Core Rule Set</a>, provide capabilities to detect and apply security cookie attributes, countermeasures against session fixation attacks, and session tracking features to enforce sticky sessions.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>